<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Banana - Ecological analyses of bacterial dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Banana</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-processing-of-miseq-reads" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Processing of MiSeq reads</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-processing-of-miseq-reads">    
        <li>
    <a class="dropdown-item" href="./Bacteria_reads_processing.html">
 <span class="dropdown-text">16S rRNA reads</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Fungi_reads_processing.html">
 <span class="dropdown-text">ITS2 reads</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ecological-analyses" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Ecological analyses</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ecological-analyses">    
        <li>
    <a class="dropdown-item" href="./Bacteria_data_analysis.html">
 <span class="dropdown-text">Bacterial dataset</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Fungi_data_analysis.html">
 <span class="dropdown-text">Fungal dataset</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/anitalasa"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-3783-7157"> 
<span class="menu-text"><img src="images/orcid.png" title="ORCID" alt="ORCID" style="height:20px;"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://grupos.eez.csic.es/mae/"> 
<span class="menu-text"><img src="images/internet.png" title="web research group" alt="web research group" style="height:20px;"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#create-a-phyloseq-object" id="toc-create-a-phyloseq-object" class="nav-link active" data-scroll-target="#create-a-phyloseq-object">1. Create a phyloseq object</a></li>
  <li><a href="#data-curation" id="toc-data-curation" class="nav-link" data-scroll-target="#data-curation">2. Data curation</a></li>
  <li><a href="#rarefaction-curves" id="toc-rarefaction-curves" class="nav-link" data-scroll-target="#rarefaction-curves">3. Rarefaction curves</a></li>
  <li><a href="#alpha-diversity-analysis" id="toc-alpha-diversity-analysis" class="nav-link" data-scroll-target="#alpha-diversity-analysis">4. Alpha diversity analysis</a>
  <ul class="collapse">
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis">4.1 Statistical analysis</a></li>
  </ul></li>
  <li><a href="#beta-diversity-analyses" id="toc-beta-diversity-analyses" class="nav-link" data-scroll-target="#beta-diversity-analyses">5. Beta diversity analyses</a>
  <ul class="collapse">
  <li><a href="#tmm-normalization" id="toc-tmm-normalization" class="nav-link" data-scroll-target="#tmm-normalization">5.1 TMM Normalization</a></li>
  <li><a href="#multivariate-statistical-tests" id="toc-multivariate-statistical-tests" class="nav-link" data-scroll-target="#multivariate-statistical-tests">5.2 Multivariate statistical tests</a></li>
  <li><a href="#ordination-plots" id="toc-ordination-plots" class="nav-link" data-scroll-target="#ordination-plots">5.3 Ordination plots</a></li>
  </ul></li>
  <li><a href="#taxonomical-profiles" id="toc-taxonomical-profiles" class="nav-link" data-scroll-target="#taxonomical-profiles">6. Taxonomical profiles</a>
  <ul class="collapse">
  <li><a href="#phylum-level" id="toc-phylum-level" class="nav-link" data-scroll-target="#phylum-level">6.1 Phylum level</a>
  <ul class="collapse">
  <li><a href="#obtaining-tables-with-the-relative-abundance-and-standard-deviation-values" id="toc-obtaining-tables-with-the-relative-abundance-and-standard-deviation-values" class="nav-link" data-scroll-target="#obtaining-tables-with-the-relative-abundance-and-standard-deviation-values">6.1.1. Obtaining tables with the relative abundance and standard deviation values</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">6.1.2. Plotting</a></li>
  </ul></li>
  <li><a href="#genus-level" id="toc-genus-level" class="nav-link" data-scroll-target="#genus-level">6.2. Genus level</a>
  <ul class="collapse">
  <li><a href="#obtain-tables-with-the-relative-abundance-and-standard-deviation-values" id="toc-obtain-tables-with-the-relative-abundance-and-standard-deviation-values" class="nav-link" data-scroll-target="#obtain-tables-with-the-relative-abundance-and-standard-deviation-values">6.2.1. Obtain tables with the relative abundance and standard deviation values</a></li>
  <li><a href="#plotting-1" id="toc-plotting-1" class="nav-link" data-scroll-target="#plotting-1">6.2.2. Plotting</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#inheritance-analyses" id="toc-inheritance-analyses" class="nav-link" data-scroll-target="#inheritance-analyses">7. Inheritance analyses</a>
  <ul class="collapse">
  <li><a href="#prepare-the-data" id="toc-prepare-the-data" class="nav-link" data-scroll-target="#prepare-the-data">7.1 Prepare the data</a></li>
  <li><a href="#compare-asvs-between-mother-and-sucker-plants" id="toc-compare-asvs-between-mother-and-sucker-plants" class="nav-link" data-scroll-target="#compare-asvs-between-mother-and-sucker-plants">7.2 Compare ASVs between mother and sucker plants</a></li>
  <li><a href="#plotting-2" id="toc-plotting-2" class="nav-link" data-scroll-target="#plotting-2">7.3 Plotting</a></li>
  </ul></li>
  <li><a href="#differentially-abundant-taxa" id="toc-differentially-abundant-taxa" class="nav-link" data-scroll-target="#differentially-abundant-taxa">8. Differentially abundant taxa</a>
  <ul class="collapse">
  <li><a href="#phylum" id="toc-phylum" class="nav-link" data-scroll-target="#phylum">8.1 Phylum</a></li>
  <li><a href="#genus" id="toc-genus" class="nav-link" data-scroll-target="#genus">8.2 Genus</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Ecological analyses of bacterial dataset</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Firstly, we have to install and load many packages needed to analyze our bacterial data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"ANCOMBC"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"microbiome"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"GUniFrac"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"phangorn"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vegan"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"gdata"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"purrr"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rstatix"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggstasplot"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DescTools"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"WRS2"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ARTool"</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"edgeR"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"wilkelab/ggtext"</span>) </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"pmartinezarbizu/pairwiseAdonis/pairwiseAdonis"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"nuriamw/micro4all"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ANCOMBC)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbiome)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GUniFrac)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gdata)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgeR)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pairwiseAdonis)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(micro4all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our analyses will based on phyloseq objects. That is to say, we are going to use <a href="http://dx.plos.org/10.1371/journal.pone.0061217" title="Paper describing phyloseq package">phyloseq</a> package</p>
<section id="create-a-phyloseq-object" class="level1">
<h1>1. Create a phyloseq object</h1>
<p>phyloseq object are very useful since they harbor several elements of interest: an ASV (or OTU) table in which the absolute abundance of each ASV is registered, the taxonomy of each ASV (from Domain or Kingdom to ASV level), a metadata table in which a full description of each sample is given, and finally, a phylogenetic tree at ASV level. Thus, lets load all the input files and create the phyloseq object. So, all the above mentioned files should be in our working directory:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"ASV_Bacterias_final.txt"</span>, <span class="at">header =</span> T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)<span class="co">#load the ASV table </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>colnames_data<span class="ot">=</span><span class="fu">colnames</span>(data)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"metadata_bacteria.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T)<span class="co">#load the metadata table</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">"2022"</span>, <span class="st">"A"</span>, mt<span class="sc">$</span>Year)<span class="co">#we replaced the number of the years by a character</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">"2023"</span>, <span class="st">"B"</span>, mt<span class="sc">$</span>Year)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Replicate<span class="ot">=</span><span class="fu">as.character</span>(mt<span class="sc">$</span>Replicate)<span class="co">#convert into characters</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Fusion<span class="ot">=</span><span class="fu">paste0</span>(mt<span class="sc">$</span>Year, <span class="at">sep=</span><span class="st">"_"</span>,mt<span class="sc">$</span>Plot, <span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Condition,<span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Compartment)<span class="co">#here we create a joined artificial variable in order to plot better our samples</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">paste0</span>(mt<span class="sc">$</span>Condition,<span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Year)<span class="co">#the same strategy</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(mt)<span class="ot">=</span>mt<span class="sc">$</span>Sample <span class="co">#the rownames of the metadata table should be identical to the name of the samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="collout-important">
<p>The order of the sample is very important! In particular, the order of the samples in the metadata file must be the same as the order of the samples in the ASV table. So, check (and correct it) previously</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tax <span class="ot">=</span>data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>]<span class="co">#indicate the taxonomy of each ASV: from Domain/Kingdom to ASV level</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ASV<span class="ot">=</span>data[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)]<span class="co">#indicate the ASV counts</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>dna<span class="ot">=</span>Biostrings<span class="sc">::</span><span class="fu">DNAStringSet</span>(data<span class="sc">$</span>ASV_seqs) <span class="co">#save the sequence of each ASV into a variable</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dna)<span class="ot">=</span> data<span class="sc">$</span>ASV_names</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(tax)<span class="ot">=</span>data<span class="sc">$</span>ASV_names<span class="co">#the name of each row should be the name of each ASV (i.e., "ASV02156")</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(ASV)<span class="ot">=</span>data<span class="sc">$</span>ASV_names</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(ASV), <span class="fu">rownames</span>(tax))<span class="co">#this is very important and should give "TRUE". Otherwise, review the lines above because there is a mistaker elsewhere</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>phy_tree<span class="ot">=</span>phyloseq<span class="sc">::</span><span class="fu">read_tree</span>(<span class="st">"tree"</span>)<span class="co">#read the phylogenetic tree. In our case is named "tree"</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>unrooted_tree <span class="ot">=</span> phy_tree</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">is.rooted</span>(unrooted_tree)<span class="co">#if your phylogenetic tree is unrooted, it will give you "FALSE", and in that case, we have uproopt it as following</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>tree_root <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">root</span>(unrooted_tree, <span class="dv">1</span>, <span class="at">resolve.root =</span> T)<span class="co">#calculate the root</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>tree_root<span class="co">#it gives you the number of tips and nodes</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">is.rooted</span>(tree_root)<span class="co">#check that the tree now is uprooted</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert each element into suitable objects for the construction of a phyloseq object</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>phy_OTUtable<span class="ot">=</span><span class="fu">otu_table</span>(ASV, <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>phy_taxonomy<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(tax))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>phy_metadata<span class="ot">=</span><span class="fu">sample_data</span>(mt) </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">#the tree is already in the proper format</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>phy_data_total<span class="ot">=</span><span class="fu">phyloseq</span>(phy_OTUtable,phy_taxonomy,phy_metadata,tree_root)<span class="co">#bind all the elements into the phyloseq object</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">nsamples</span>(phy_OTUtable); <span class="fu">sum</span>(<span class="fu">sample_names</span>(phy_metadata) <span class="sc">%in%</span> <span class="fu">sample_names</span>(phy_OTUtable)); <span class="fu">nsamples</span>(phy_metadata)<span class="co">#check all the elements have the same number of samples</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-curation" class="level1">
<h1>2. Data curation</h1>
<p>The phyloseq object is already created, however, we still have to check the quality of the data. For instance, we have to check if all the samples are comprised by enough sequences, and if the sampling and sequencing efforts are enough. For that purpose, we have to check the number of total sequences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>numsec<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_data_total)))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(numsec) <span class="co">#order the table in ascending order to check the lowest library size (the sample with the lowest number of sequences)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We found that sample <strong>A2M05R</strong> had low number of sequences (8730), so let’s remove it from further analyses:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>phy_data_total<span class="ot">=</span><span class="fu">subset_samples</span>(phy_data_total,Sample <span class="sc">!=</span> <span class="st">"A1S04E"</span>) <span class="co">#!= indicates "not equal to", so it means "select all the Samples different to the one we want to remove"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, it would be interesting to check the quality of the sterilization process. We want to visualize in an ordination plot if rhizosphere and root endosphere samples are separated in the multivariate space. As indicated in the <strong>step 5</strong>, we have to normalize the ASV counts and then, calculate the ordination of the samples and plot them into a multivariate ordination plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>todas_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(phy_data_total,<span class="at">taxa_are_rows =</span> T))<span class="co">#obtain the ASV table from the phyloseq object</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>todas_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_data_total))<span class="co">#obtain the metadata table from the phyloseq object</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>todas_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(phy_data_total))<span class="co">#obtain the taxonomy table from the phyloseq object</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>todas_tree<span class="ot">=</span><span class="fu">phy_tree</span>(phy_data_total)<span class="co">#obtain the phylogenetic tree from the phyloseq object</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#all the previous steps are required to create a new object suitable for edgeR functions</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>todas_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> todas_ASV, <span class="at">samples =</span> todas_mt, <span class="at">genes =</span> todas_tax)<span class="co">#Create a DGEList object need for the TMM normalization</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>todas_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(todas_edgeR)<span class="co">#calculate all the normalization factor so that we can correct potential biases associated to the different librazy sizes (different number of sequences per sample)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>todas_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(todas_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)<span class="co">#extracting the normalized abundance</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>todas_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(todas_ASV_norm,<span class="at">row.names=</span>F),<span class="at">taxa_are_rows =</span> T)<span class="co">#create the normalized phyloseq elements</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>todas_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(todas_tax))</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>todas_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(todas_mt)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(todas_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(todas_phy_taxonomy_norm)<span class="co">#add the name of the taxa</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(todas_ASV_norm), <span class="fu">rownames</span>(todas_tax))<span class="co">#if everything is well calculated, it should give "TRUE"</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>todas_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(todas_phy_OTU_norm,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>                                    todas_phy_taxonomy_norm,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                                    todas_phy_metadata_norm,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>                                    todas_tree)<span class="co">#Create the new phyloseq object, in which the abundance of all the taxa is normalized</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One the normalization is done, the plot is made as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>PCOA_wuni<span class="ot">=</span> <span class="fu">ordinate</span>(todas_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)<span class="co">#here we create the ordination plot (PCoA) based on Weighted UniFrac distances</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>peso<span class="ot">=</span>PCOA_wuni<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="co">#save the percentage of the variance explained by each axis into a new variable</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>peso<span class="co">#check the variance explained</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span> <span class="fu">plot_ordination</span>(todas_normalized_phyloseq, PCOA_wuni,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Fusion"</span>,<span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span><span class="co">#indicate the variable of interest (i.e., if you want to color by "Plot", indicate "color=Plot")</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">4.5</span>)<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Sample, <span class="at">fontface=</span><span class="st">"bold"</span>), <span class="at">hjust=</span><span class="fl">0.15</span>, <span class="at">vjust=</span><span class="fl">0.15</span>, <span class="at">nudge_y =</span> <span class="fl">0.0075</span>,<span class="at">size=</span><span class="dv">4</span>, <span class="at">show.legend =</span>F) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"2022"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"2023"</span><span class="ot">=</span><span class="dv">17</span>))<span class="sc">+</span><span class="co">#the codes of the specific shapes</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"All the samples</span><span class="sc">\n</span><span class="st">PCoA on Weighted UniFrac dissimilarities"</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/PCoA_todas.jpg" class="img-fluid figure-img"></p>
<figcaption>Figure1. PCoA based on Weighted UniFrac including all the rhizosphere and root endosphere samples</figcaption>
</figure>
</div>
<p>As shown in Figure 1, there are some root endosphere samples that are closer than rhizosphere samples than other root endosphere samples. Thus, we consider that these roots were not properly sterilized. We should remove them because we are not aware of their origin</p>
<p>This, we have to curate our dataset, and remove all these samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>phy_total<span class="ot">=</span><span class="fu">subset_samples</span>(phy_data_total, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                         Sample <span class="sc">!=</span> <span class="st">"A1S04E"</span>  <span class="sc">&amp;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                           Sample<span class="sc">!=</span> <span class="st">"A1M01E"</span><span class="sc">&amp;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span> <span class="st">"A2S09E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"A2S12E"</span><span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"A2S08E"</span> <span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"A2S01E"</span><span class="sc">&amp;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B1S03E"</span><span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"B1S06E"</span><span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"B1S09E"</span><span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"B1S10E"</span><span class="sc">&amp;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B1M12E"</span><span class="sc">&amp;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span> <span class="st">"B2S06E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S11E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S07E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S02E"</span> <span class="sc">&amp;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B2M08E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2M03E"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>numsec_pruned<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total)))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>numASV_pruned<span class="ot">=</span><span class="fu">as.data.frame</span>((<span class="fu">otu_table</span>(phy_total)))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(numsec_pruned),numsec_pruned),<span class="at">file=</span><span class="st">"Numero_secuencias_deTrabajo.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#save the table with the number of total sequences per sample</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(numASV_pruned),numASV_pruned),<span class="at">file=</span><span class="st">"Numero_ASVs_deTrabajo.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#save the table with the number of total ASVs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rarefaction-curves" class="level1">
<h1>3. Rarefaction curves</h1>
<p>We still have to check whether the sequencing effort has been enough, so let’s have a look at rarefaction curves. They are the best way to visualize the quality of the sequencing and sampling.</p>
<p>In our case, we should visualize the rarefaction curves by plant compartment, to check whether the data curation was made well</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(phy_total))<span class="co">#calculate the smallest library size</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total)))]<span class="co">#check which is the sample with the smallest library size </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_total))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_total)))),<span class="at">decreasing=</span>F),]<span class="co">#obtain the metadata table</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(phy_total)))<span class="co">#obtain the ASV table and traspose it</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Compartment)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)<span class="co">#we are creating a new column so that then we can plot based on the plant compartment (or based on other variable)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) <span class="co">#calculate the rarefaction</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">=</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>})<span class="co">#this function is to create a table from the rarefaction variable</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">=</span> sample_names</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">=</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Compartment<span class="ot">=</span>rare<span class="sc">$</span>Sample <span class="co">#these lines aimed at creating a new column in which the information needed for the plotting is included. You should include here the factor that determines the color of the curves</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Compartment<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Compartment)<span class="co">#replace all the text before "/"</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>p_endo_rizo<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Compartment, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Compartment), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Compartment),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(phy_total))), </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Endosphere"</span><span class="ot">=</span><span class="st">"black"</span>,<span class="st">"Rhizosphere"</span><span class="ot">=</span><span class="st">"#66CC33"</span>))<span class="sc">+</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Endosphere"</span><span class="ot">=</span><span class="st">"black"</span>, <span class="st">"Rhizosphere"</span><span class="ot">=</span><span class="st">"#66CC33"</span>),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Compartment"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Endosphere"</span>, <span class="st">"Rhizosphere"</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Endosphere"</span>, <span class="st">"Rhizosphere"</span>))<span class="sc">+</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"All the samples"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>p_endo_rizo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now yes, we will create rarefaction curves. But we have to split the data according to the orchards, otherwise it will be really difficult to understand the graphs. So, let’s subset the data according to our experimental design. We will create new phyloseq objects: two per plant compartment, corresponding to each orchard or plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rizo1<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Rhizosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span><span class="st">"Plot1"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>rizo1<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(rizo1)<span class="sc">&gt;</span><span class="fl">0.0</span>, rizo1)<span class="co">#</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>rizo2<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Rhizosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span> <span class="st">"Plot2"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>rizo2<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(rizo2)<span class="sc">&gt;</span><span class="fl">0.0</span>, rizo2)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>endo1<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span><span class="st">"Plot1"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>endo1<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo1)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo1)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>endo2<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span> <span class="st">"Plot2"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>endo2<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo2)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, calculate and plot the rarefaction curves:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo1)))] </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(rizo1)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt) </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)<span class="co">#we want to color in different colors mothers and suckers, and also the samples taken in each year</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>p_rizo1<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1))), </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>))<span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Rhizosphere; Plot 1"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>p_rizo1</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot2</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2)) </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo2)))] </span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(rizo2)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){ </span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>p_rizo2<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2))), </span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>),</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Rhizosphere; Plot 2"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>p_rizo2</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a><span class="co">#ENDOSPHERE SAMPLES:</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1)) </span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo1)))] </span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(endo1)</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>p_endo1<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1))), </span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>))<span class="sc">+</span></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>),</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Endosphere; Plot 1"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>p_endo1</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot2</span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2))</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo2)))] </span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(endo2)</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>p_endo2<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2))), </span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>),</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Endosphere; Plot 2"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>p_endo2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As shown in Figures 2-5, at the same rarefaction levels, most of the samples reached to the asymptote, so the sequencing effort can be considered enough. Furthermore, no clear patterns of richnes can be deduced from the rarefaction curves</p>
<p><img src="images/Rarefacc_rizo1.jpeg" class="img-fluid quarto-figure quarto-figure-center" width="700" alt="Figure 2. Rarefaction curves corresponding to rhizosphere samples of the south plot (also named “Plot 1”)."> <img src="images/Rarefacc_rizo2.jpeg" class="img-fluid quarto-figure quarto-figure-center" width="700" alt="Figure 3. Rarefaction curves corresponding to rhizosphere samples of the north plot (also named “Plot 2”)."> <img src="images/Rarefacc_endo1.jpeg" class="img-fluid quarto-figure quarto-figure-center" width="700" alt="Figure 4. Rarefaction curves corresponding to root endosphere samples of the south plot (also named “Plot 1”)."> <img src="images/Rarefacc_endo2.jpeg" class="img-fluid quarto-figure quarto-figure-center" width="700" alt="Figure 5. Rarefaction curves corresponding to root endosphere samples of the north plot (also named “Plot 2”)."></p>
</section>
<section id="alpha-diversity-analysis" class="level1">
<h1>4. Alpha diversity analysis</h1>
<p>We are going to estimate the richness, diversity and evenness of each sample by calculating the number of observed ASVs, and Shannon’s and Inverse of Simpson and Pielou’s indices, respectively.</p>
<p>Some alpha diversity indices are sensitive to different library sizes, so first, we will rarefy all the samples to the smallest library size to avoid potential biases associated to different number of sequences.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It should be made a rarefaction per groups of samples to be compared. For instance, if we want to compare the diversity of rhizosphere bacterial communitites of Mother and Suckers plants located in the south plot, we should calculate the rarefaction level corresponding to the subgroup of Rhizosphere samples of the south plot (namely, object <em>rizo1</em>). And then, rarefy to the smallest library size of the samples included in the object <em>rizo1</em>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) Endosphere samples</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>rarefac_endo1<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(endo1, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1)),<span class="at">rngseed=</span>T)<span class="co">#rarefaction. You can indicate manually the minimum sample size or by using the function "min"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_endo1) <span class="co">#check that now all the samples have the same number of sequences</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo1)))]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_endo1, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))<span class="co">#calculate the indices</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Pielou<span class="ot">=</span>indices_endo1<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_endo1<span class="sc">$</span>Observed)<span class="co">#calculated manually the Pielou index</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_endo1))<span class="sc">==</span><span class="fu">row.names</span>(indices_endo1)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>mt_indices_endo1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_endo1))<span class="co">#extract the metadata</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="ot">=</span><span class="fu">add_column</span>(indices_endo1, mt_indices_endo1[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_endo1)], <span class="at">.before =</span> <span class="st">"Observed"</span>)<span class="co">#add the metadata to the indices table, before the column named "Observed"</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_endo1),indices_endo1),<span class="at">file=</span><span class="st">"Indices_Endo_Plot1_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#We have already calculated the indices per replicates but we are interested in the mean and standard values per groups of samples, so let's calculate them:</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>media_endo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo1<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)<span class="co">#be careful. Here you have to indicate the position of the columns where the values of the indices are placed</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>sd_endo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo1<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ <span class="co">#be careful with the position of the numeric values (alpha indices)</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_endo1[,i], <span class="st">" +/- "</span>, sd_endo1[,i]))}<span class="co">#then in Excel you can replace "+/-" by the corresponding symbol</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_endo1 <span class="ot">=</span> <span class="fu">cbind</span>(media_endo1<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_endo1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_endo1)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_endo1,<span class="at">file=</span><span class="st">"Indices_media_sd_Endo_Plot1.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#this table shows the mean +/- sd of the indices for each group of samples. Ready for publication</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>rarefac_endo2<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(endo2, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2)),<span class="at">rngseed=</span>T)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_endo2)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo2)))]</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_endo2, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Pielou<span class="ot">=</span>indices_endo2<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_endo2<span class="sc">$</span>Observed)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_endo2))<span class="sc">==</span><span class="fu">row.names</span>(indices_endo2)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>mt_indices_endo2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_endo2))</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="ot">=</span><span class="fu">add_column</span>(indices_endo2, mt_indices_endo2[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_endo2)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_endo2),indices_endo2),<span class="at">file=</span><span class="st">"Indices_Endo_Plot2_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>media_endo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo2<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>sd_endo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo2<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_endo2[,i], <span class="st">" +/- "</span>, sd_endo2[,i]))}</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_endo2 <span class="ot">=</span> <span class="fu">cbind</span>(media_endo2<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_endo2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_endo2)</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_endo2,<span class="at">file=</span><span class="st">"Indices_media_sd_Endo_Plot2.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="co">#b) Rhizosphere</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>rarefac_rizo1<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(rizo1, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1)),<span class="at">rngseed=</span>T)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_rizo1) </span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo1)))]</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_rizo1, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Pielou<span class="ot">=</span>indices_rizo1<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_rizo1<span class="sc">$</span>Observed)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_rizo1))<span class="sc">==</span><span class="fu">row.names</span>(indices_rizo1)</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>mt_indices_rizo1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_rizo1))</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="ot">=</span><span class="fu">add_column</span>(indices_rizo1, mt_indices_rizo1[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_rizo1)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_rizo1),indices_rizo1),<span class="at">file=</span><span class="st">"Indices_rizo_Plot1_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>media_rizo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo1<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>sd_rizo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo1<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ <span class="co">#OJO aqui con el numero de las columnas numericas</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_rizo1[,i], <span class="st">" +/- "</span>, sd_rizo1[,i]))}</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_rizo1 <span class="ot">=</span> <span class="fu">cbind</span>(media_rizo1<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_rizo1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_rizo1)</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_rizo1,<span class="at">file=</span><span class="st">"Indices_media_sd_rizo_Plot1.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>rarefac_rizo2<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(rizo2, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2)),<span class="at">rngseed=</span>T)</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_rizo2) </span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo2)))]</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_rizo2, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Pielou<span class="ot">=</span>indices_rizo2<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_rizo2<span class="sc">$</span>Observed)</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_rizo2))<span class="sc">==</span><span class="fu">row.names</span>(indices_rizo2)</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>mt_indices_rizo2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_rizo2))</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="ot">=</span><span class="fu">add_column</span>(indices_rizo2, mt_indices_rizo2[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_rizo2)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_rizo2),indices_rizo2),<span class="at">file=</span><span class="st">"Indices_rizo_Plot2_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>media_rizo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo2<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>sd_rizo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo2<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ </span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_rizo2[,i], <span class="st">" +/- "</span>, sd_rizo2[,i]))}</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_rizo2 <span class="ot">=</span> <span class="fu">cbind</span>(media_rizo2<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_rizo2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_rizo2)</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_rizo2,<span class="at">file=</span><span class="st">"Indices_media_sd_rizo_Plot2.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="statistical-analysis" class="level2">
<h2 class="anchored" data-anchor-id="statistical-analysis">4.1 Statistical analysis</h2>
<p>We have just calculated the alpha indices per sample and per group of samples, but we have to compare them among group of samples. For that purpose, we will apply univariate statistic test. We will go into different steps, which briefly consist of:</p>
<ol type="1">
<li><p><strong>Check the normality of the data</strong>: we have to confirm whether our variables follow a normal distribution. If they are not normally distributed, we will also check if they are very far from the normal distribution.</p></li>
<li><p><strong>Check the homoscedasticity of the data</strong>: confirm if dispersion of the variable is the same in all the groups of samples to compare. If the distribution of the variables is normal (or almost normal) and there is homogeneity of variances, we will apply parametric tests. Otherwise, we will use non-parametric tests.</p></li>
<li><p><strong>Check the presence of the outliers</strong>. Outliers are not a problem, but we have to check if they are extreme outliers. In that case, we will apply robust tests</p></li>
<li><p><strong>Apply the proper statistical test.</strong> Depending on the characteristics of the variables and the experimental design (one factor to be studied: one-way statistics; two factors: two-way statistical tests).</p></li>
<li><p><strong>Calculate the size of the effect</strong>. In case we find statistical differences among groups of samples in the studied variables, we have to measure the magnitude of the effect.</p></li>
</ol>
<p>We have to study separately each individual variable (in this case, each alpha diversity index).</p>
<p>In this example, we are interested in two factors: the effect of the sampling year, and the effect of the plants’ developmental stage, also named <em>Condition</em> in this web</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) ENDOSPHERE</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="co">#</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)<span class="co">#data are not normally distributed</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()<span class="co">#let's see how far are our data from the normal distribution into a qq-plot.</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As shown in Figure 6, just one point is far from the normal distribution, so we can still applied parametric data is homoscedasticity hypothesis is met.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/graficoQQ_InvSimpson_endo1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Figure 6. QQplot showing distribution of the InvSimpson corresponding to root endosphere samples f plants located in the south plot</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span>  <span class="fu">identify_outliers</span>(Observed);<span class="fu">View</span>(a)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Hypothesis contrasting tests</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Condition <span class="sc">*</span> Year)<span class="co">#two-way ANOVA because our data are homoscedatic</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Condition)<span class="co">#robust test because Invesrse of Simpson have extreme outliers</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Year)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_endo1)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#We did not find the interaction between Year and plant developmental Condition significant in any of the variables studied, but the effect of Year or Condition (or both) was statistaclly significant on some of the indices. In that case, we have to study the effect of each factor individually:</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc tests</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Observed<span class="sc">~</span>Year)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Shannon<span class="sc">~</span>Year)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Condition)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Year)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Condition)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Year)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mcp2atm</span>(InvSimpson<span class="sc">~</span>Year<span class="sc">*</span>Condition, <span class="at">data=</span>indices_endo1) <span class="co">#the robust post-hoc test</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a><span class="co">#outliers</span></span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a><span class="co">#two-way tests </span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Condition <span class="sc">*</span> Year)<span class="co">#two way ANOVA</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Condition)</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Year)</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_endo2)<span class="co">#robust test</span></span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a><span class="co">#The dispersion of the Pielou index for both groups of samples is not homogeneous, so we cannot compute parametric tests. However, there are not suitable options for non-parametric two-way tests. Let's make a data transformation according to this tutorial.http://depts.washington.edu/acelab/proj/art/index.html</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Condition)</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Year)</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">art</span>(Observed <span class="sc">~</span> Year <span class="sc">*</span> Condition, <span class="at">data=</span>indices_endo2) <span class="co"># linear model syntax; see lm()</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>mm<span class="ot">=</span><span class="fu">anova</span>(m)</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a><span class="fu">eta_squared</span>(mm)</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a><span class="co">#B) RHIZOSPHERE</span></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="co">#normality</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Pielou"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a><span class="co">#Homocesdasticity</span></span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon); <span class="fu">View</span>(b)</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a><span class="co">#we found that Observed and InvSimpson have extremo outliers. We should check wether applying robust methods we maintain the homoscedasticity of the data</span></span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  <span class="co">#remove the 10% of the data (in one tail)</span></span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span><span class="co">#remove the 10% of the data (in the other tail)</span></span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Year<span class="sc">*</span>Plot)<span class="co">#still homoscedastic</span></span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>), </span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Year<span class="sc">*</span>Plot)<span class="co">#still homoscedastic</span></span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a><span class="co">#two-way tests</span></span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Condition)</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Year)</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc:</span></span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Year)</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a><span class="fu">mcp2atm</span>(Observed<span class="sc">~</span>Year<span class="sc">*</span>Condition, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-145"><a href="#cb14-145" aria-hidden="true" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb14-146"><a href="#cb14-146" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">lm</span>(Observed<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)</span>
<span id="cb14-147"><a href="#cb14-147" aria-hidden="true" tabindex="-1"></a><span class="fu">eta_squared</span>(x) </span>
<span id="cb14-148"><a href="#cb14-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-149"><a href="#cb14-149" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb14-150"><a href="#cb14-150" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb14-151"><a href="#cb14-151" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb14-152"><a href="#cb14-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-153"><a href="#cb14-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb14-154"><a href="#cb14-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-155"><a href="#cb14-155" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb14-156"><a href="#cb14-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-157"><a href="#cb14-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb14-158"><a href="#cb14-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-159"><a href="#cb14-159" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb14-160"><a href="#cb14-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-161"><a href="#cb14-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb14-162"><a href="#cb14-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-163"><a href="#cb14-163" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb14-164"><a href="#cb14-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb14-165"><a href="#cb14-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb14-166"><a href="#cb14-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-167"><a href="#cb14-167" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb14-168"><a href="#cb14-168" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb14-169"><a href="#cb14-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb14-170"><a href="#cb14-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-171"><a href="#cb14-171" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb14-172"><a href="#cb14-172" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-173"><a href="#cb14-173" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-174"><a href="#cb14-174" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-175"><a href="#cb14-175" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb14-176"><a href="#cb14-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-177"><a href="#cb14-177" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb14-178"><a href="#cb14-178" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb14-179"><a href="#cb14-179" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b) </span>
<span id="cb14-180"><a href="#cb14-180" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb14-181"><a href="#cb14-181" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb14-182"><a href="#cb14-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-183"><a href="#cb14-183" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the possibility to apply robust tests</span></span>
<span id="cb14-184"><a href="#cb14-184" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> </span>
<span id="cb14-185"><a href="#cb14-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb14-186"><a href="#cb14-186" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  </span>
<span id="cb14-187"><a href="#cb14-187" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb14-188"><a href="#cb14-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Year<span class="sc">*</span>Condition)</span>
<span id="cb14-189"><a href="#cb14-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-190"><a href="#cb14-190" aria-hidden="true" tabindex="-1"></a><span class="co">#tests</span></span>
<span id="cb14-191"><a href="#cb14-191" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo2<span class="sc">$</span>Condition)</span>
<span id="cb14-192"><a href="#cb14-192" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo2<span class="sc">$</span>Year)</span>
<span id="cb14-193"><a href="#cb14-193" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo2)</span>
<span id="cb14-194"><a href="#cb14-194" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-195"><a href="#cb14-195" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(InvSimpson <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-196"><a href="#cb14-196" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb14-197"><a href="#cb14-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-198"><a href="#cb14-198" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc</span></span>
<span id="cb14-199"><a href="#cb14-199" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Condition)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also compare if the alpha diversity indices of bacterial communities associated to mothers, first and second suckers are different each other. In the <a href="./index.html" title="Click if you want more information">index of this website</a>, you can find more details about the concepts of <em>Mothers</em>, <em>first suckers</em> and <em>second suckers</em>. These concepts are very similar to the concept of “Generation” in sexually reproducing plants, and that’s exactly the name of the factor employed here. So, we will compare the indices of these groups, by the factor <em>Generation</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a.1) South plot</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Pielou"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon); <span class="fu">View</span>(b)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether the variables "Observed" and "InvSimpson" are still homocedastic in case we apply robust tests</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(Observed<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo1)<span class="co">#one-way robust test</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)<span class="co">#one-way ANOVA</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo1)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> </span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo2)</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon) ;<span class="fu">View</span>(b)</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> </span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo1)</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc test: "Observed" resulted statistically significant, so let's apply Student's t-test</span></span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> <span class="fu">pairwise_t_test</span>(Observed<span class="sc">~</span>Generation)</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon) ;<span class="fu">View</span>(b)</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span> </span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Pielou,</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Pielou,<span class="fl">0.1</span>),  </span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Pielou, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a><span class="co">#tests</span></span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo2)</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(Pielou<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="beta-diversity-analyses" class="level1">
<h1>5. Beta diversity analyses</h1>
<p>It’s time to analyze the differences in the diversity of the bacterial communities between samples. For that purpose, we will navigate into the multivariate statistics.</p>
<p>Firstly, we have to normalize the data to avoid potential biases due to different library sizes (different number of sequences in the samples). We prefer the edgeR method, which is based on the TMM (<em>Trimmed Mean of the M-values</em>). This normalization is needed when we are working also with compositional data; that is to say, with data that expressed in percentages, such as microbiota counts. More information can be found <a href="https://doi.org/10.1186/gb-2010-11-3-r25">here</a>.</p>
<section id="tmm-normalization" class="level2">
<h2 class="anchored" data-anchor-id="tmm-normalization">5.1 TMM Normalization</h2>
<p>We are going to use this normalization for both multivariate plots and for multivariate statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>rizo1_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(rizo1,<span class="at">taxa_are_rows =</span> T))<span class="co">#extract the ASV table from the phyloseq object</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>rizo1_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1))<span class="co">#extract the metadata table from the phyloseq object</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>rizo1_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(rizo1))<span class="co">#extract the taxonomy table from the phyloseq object</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>rizo1_tree<span class="ot">=</span><span class="fu">phy_tree</span>(rizo1)<span class="co">#extract the phylogenetic tree from the phyloseq object</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a new object suitbale for the normalization by the package edgeR</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>rizo1_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> rizo1_ASV, <span class="at">samples =</span> rizo1_mt, <span class="at">genes =</span> rizo1_tax)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the normalization factors to correct the differences in sequencing depth</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>rizo1_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(rizo1_edgeR)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the normalized abundance</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>rizo1_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(rizo1_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the phyloseq elements with the ASV counts normalized</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>rizo1_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(rizo1_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>rizo1_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(rizo1_tax))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>rizo1_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(rizo1_mt)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(rizo1_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(rizo1_phy_taxonomy_norm)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(rizo1_ASV_norm), <span class="fu">rownames</span>(rizo1_tax))<span class="co">#it should give "TRUE"</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Join all the elements into a new phyloseq object</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>rizo1_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(rizo1_phy_OTU_norm, rizo1_phy_taxonomy_norm,rizo1_phy_metadata_norm,rizo1_tree)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>rizo2_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(rizo2,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>rizo2_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>rizo2_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(rizo2))</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>rizo2_tree<span class="ot">=</span><span class="fu">phy_tree</span>(rizo2)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>rizo2_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> rizo2_ASV, <span class="at">samples =</span> rizo2_mt, <span class="at">genes =</span> rizo2_tax)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>rizo2_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(rizo2_edgeR)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>rizo2_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(rizo2_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>rizo2_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(rizo2_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>rizo2_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(rizo2_tax))</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>rizo2_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(rizo2_mt)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(rizo2_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(rizo2_phy_taxonomy_norm)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(rizo2_ASV_norm), <span class="fu">rownames</span>(rizo2_tax))</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>rizo2_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(rizo2_phy_OTU_norm,rizo2_phy_taxonomy_norm,rizo2_phy_metadata_norm,rizo2_tree)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="co">#b)ENDOSPHERE</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>endo1_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(endo1,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>endo1_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1))</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>endo1_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(endo1))</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>endo1_tree<span class="ot">=</span><span class="fu">phy_tree</span>(endo1)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>endo1_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> endo1_ASV, <span class="at">samples =</span> endo1_mt, <span class="at">genes =</span> endo1_tax)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>endo1_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(endo1_edgeR)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>endo1_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(endo1_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>endo1_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(endo1_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>endo1_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(endo1_tax))</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>endo1_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(endo1_mt)</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(endo1_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(endo1_phy_taxonomy_norm)</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(endo1_ASV_norm), <span class="fu">rownames</span>(endo1_tax))</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>endo1_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(endo1_phy_OTU_norm,endo1_phy_taxonomy_norm,endo1_phy_metadata_norm,endo1_tree)</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>endo2_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(endo2,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>endo2_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2))</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>endo2_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(endo2))</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>endo2_tree<span class="ot">=</span><span class="fu">phy_tree</span>(endo2)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>endo2_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> endo2_ASV, <span class="at">samples =</span> endo2_mt, <span class="at">genes =</span> endo2_tax)</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>endo2_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(endo2_edgeR)</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>endo2_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(endo2_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>endo2_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(endo2_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>endo2_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(endo2_tax))</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>endo2_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(endo2_mt)</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(endo2_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(endo2_phy_taxonomy_norm)</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(endo2_ASV_norm), <span class="fu">rownames</span>(endo2_tax))</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>endo2_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(endo2_phy_OTU_norm,endo2_phy_taxonomy_norm,endo2_phy_metadata_norm,endo2_tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="multivariate-statistical-tests" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-statistical-tests">5.2 Multivariate statistical tests</h2>
<p>The best options to test whether the groups of samples have the same dispersion is to apply the test PERMDISP2, while PERMANOVA (Permutational Multivariate Analysis of Variance Using Distance Matrices) is a test suitable to check whether the centroid (concept similar to the mean of groups of samples) of all the groups of samples to be compared is homogenus. Thus, these tests are the multivariate version of Levene’s and ANOVA tests. However, both of them are based on distance matrices. That is to say, we have to calculate the distance between all sample pairs. There are many different distance or dissimilarity measures, but here we are going to use Weighted UniFrac distance, because it is based on both the phylogenetic proximity among ASVs and on their abundance.</p>
<p>Null hypotheses of both tests: PERMANOVA H<sub>0</sub>: no significant differences in the centroids (mean values) of the groups of samples PERMDISPD2 H<sub>0</sub>: no significant differences in the dispersion of the groups of samples</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be careful with unbalanced experiments. As stated <a href="https://doi.org/10.1890/12-2010.1">Anderson and Walsh (2013)</a>, when the groups of samples to be compared have different number of replicates (unbalanced design), heterocedasticity becomes a problem. In that cases, PERMANOVA cannot distinguish between the differences between groups of samples are due to the different dispersion or due to differences in the centroids. So, in case of unbalances designs, it is superimportant to check the dispersion of the data.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_r1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rizo1_normalized_phyloseq))<span class="co">#extract the metadata table from the phyloseq object (NORMALIZED phyloseq!)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>wuni_r1<span class="ot">=</span><span class="fu">UniFrac</span>(rizo1_normalized_phyloseq, <span class="at">weighted=</span>T)<span class="co">#calculate Weighted UniFrac distances</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>adonis_rizo1<span class="ot">=</span><span class="fu">adonis</span>(wuni_r1<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_r1, <span class="at">permutations =</span> <span class="dv">9999</span>)<span class="co">#apply the PERMANOVA test. Here we test the model Community structure~Plant type*Sampling year</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>adonis_rizo1<span class="co">#check the results</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>betadisper_r1condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Condition)<span class="co">#check the betadispersion of each factor separately</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r1condition)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>betadisper_r1year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Year)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r1year)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#North plot</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>df_r2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rizo2_normalized_phyloseq))</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>wuni_r2<span class="ot">=</span><span class="fu">UniFrac</span>(rizo2_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>adonis_rizo2<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r2<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_r2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>adonis_rizo2</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>betadisper_r2condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Condition)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r2condition)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>betadisper_r2year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Year)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r2year)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>df_e1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(endo1_normalized_phyloseq))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>wuni_e1<span class="ot">=</span><span class="fu">UniFrac</span>(endo1_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>adonis_endo1<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e1<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_e1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>adonis_endo1</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>betadisper_e1condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Condition)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e1condition)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>betadisper_e1year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Year)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e1year)</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>df_e2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(endo2_normalized_phyloseq))</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>wuni_e2<span class="ot">=</span><span class="fu">UniFrac</span>(endo2_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>adonis_endo2<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e2<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_e2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>adonis_endo2</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>betadisper_e2condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Condition)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e2condition)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>betadisper_e2year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Year)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e2year)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="co">#Let's calculate the size of the effects:</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>adonis_OmegaSq <span class="ot">&lt;-</span> <span class="cf">function</span>(adonisOutput, <span class="at">partial =</span> <span class="cn">TRUE</span>){</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>(<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>) <span class="sc">||</span> <span class="fu">is</span>(adonisOutput, <span class="st">"anova.cca"</span>)))</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Input should be an adonis object"</span>)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"anova.cca"</span>)) {</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    aov_tab <span class="ot">&lt;-</span> adonisOutput</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>MeanSqs <span class="ot">&lt;-</span> aov_tab<span class="sc">$</span>SumOfSqs <span class="sc">/</span> aov_tab<span class="sc">$</span>Df</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>MeanSqs[<span class="fu">length</span>(aov_tab<span class="sc">$</span>Df)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    aov_tab <span class="ot">&lt;-</span> adonisOutput<span class="sc">$</span>aov.tab</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>  heading <span class="ot">&lt;-</span> <span class="fu">attr</span>(aov_tab, <span class="st">"heading"</span>)</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>  MS_res <span class="ot">&lt;-</span> aov_tab[<span class="fu">pmatch</span>(<span class="st">"Residual"</span>, <span class="fu">rownames</span>(aov_tab)), <span class="st">"MeanSqs"</span>]</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>  SS_tot <span class="ot">&lt;-</span> aov_tab[<span class="fu">rownames</span>(aov_tab) <span class="sc">==</span> <span class="st">"Total"</span>, <span class="st">"SumsOfSqs"</span>]</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> aov_tab[<span class="fu">rownames</span>(aov_tab) <span class="sc">==</span> <span class="st">"Total"</span>, <span class="st">"Df"</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(partial){</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    omega <span class="ot">&lt;-</span> <span class="fu">apply</span>(aov_tab, <span class="dv">1</span>, <span class="cf">function</span>(x) (x[<span class="st">"Df"</span>]<span class="sc">*</span>(x[<span class="st">"MeanSqs"</span>]<span class="sc">-</span>MS_res))<span class="sc">/</span>(x[<span class="st">"Df"</span>]<span class="sc">*</span>x[<span class="st">"MeanSqs"</span>]<span class="sc">+</span>(N<span class="sc">-</span>x[<span class="st">"Df"</span>])<span class="sc">*</span>MS_res))</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>parOmegaSq <span class="ot">&lt;-</span> <span class="fu">c</span>(omega[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(omega)<span class="sc">-</span><span class="dv">2</span>)], <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    omega <span class="ot">&lt;-</span> <span class="fu">apply</span>(aov_tab, <span class="dv">1</span>, <span class="cf">function</span>(x) (x[<span class="st">"SumsOfSqs"</span>]<span class="sc">-</span>x[<span class="st">"Df"</span>]<span class="sc">*</span>MS_res)<span class="sc">/</span>(SS_tot<span class="sc">+</span>MS_res))</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>OmegaSq <span class="ot">&lt;-</span> <span class="fu">c</span>(omega[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(omega)<span class="sc">-</span><span class="dv">2</span>)], <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>))</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    cn_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Df"</span>, <span class="st">"SumsOfSqs"</span>, <span class="st">"MeanSqs"</span>, <span class="st">"F.Model"</span>, <span class="st">"R2"</span>,</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">if</span> (partial) <span class="st">"parOmegaSq"</span> <span class="cf">else</span> <span class="st">"OmegaSq"</span>, <span class="st">"Pr(&gt;F)"</span>)</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    cn_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Df"</span>, <span class="st">"SumOfSqs"</span>, <span class="st">"F"</span>, <span class="cf">if</span> (partial) <span class="st">"parOmegaSq"</span> <span class="cf">else</span> <span class="st">"OmegaSq"</span>,</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Pr(&gt;F)"</span>)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>  aov_tab <span class="ot">&lt;-</span> aov_tab[, cn_order]</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(aov_tab, <span class="st">"names"</span>) <span class="ot">&lt;-</span> cn_order</span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(aov_tab, <span class="st">"heading"</span>) <span class="ot">&lt;-</span> heading</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>))</span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    adonisOutput<span class="sc">$</span>aov.tab <span class="ot">&lt;-</span> aov_tab</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>    adonisOutput <span class="ot">&lt;-</span> aov_tab</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adonisOutput)</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_rizo1)<span class="co">#apply just in that cases in which PERMANOVA gives significant results</span></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo1)</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s compare the structure of bacterial communities of mothers, first and second suckers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>adonis_rizo1_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r1<span class="sc">~</span>Generation, <span class="at">data=</span>df_r1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>adonis_rizo1_generation</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>betadisper_rizo1_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Generation)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_rizo1_generation)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>adonis_rizo2_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r2<span class="sc">~</span>Generation, <span class="at">data=</span>df_r2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>adonis_rizo2_generation</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>betadisper_rizo2_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Generation)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_rizo2_generation)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>adonis_endo1_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e1<span class="sc">~</span>Generation, <span class="at">data=</span>df_e1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>adonis_endo1_generation</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>betadisper_endo1_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Generation)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_endo1_generation)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>adonis_endo2_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e2<span class="sc">~</span>Generation, <span class="at">data=</span>df_e2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>adonis_endo2_generation</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo2)<span class="co">#pass this function since significant differences were found</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>betadisper_endo2_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Generation)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_endo2_generation)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the following function as post-hoc test. The following code will perform PERMANOVA between two groups of samples (A vs. B; A vs C; B vs C). It is just a wrapping-around function</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.adonis</span>(wuni_e2, phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(endo2)<span class="sc">$</span>Generation, <span class="at">p.adjust.m =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ordination-plots" class="level2">
<h2 class="anchored" data-anchor-id="ordination-plots">5.3 Ordination plots</h2>
<p>There are several options to visualize the results of PERMANOVA tests, for instance, by ordination plots such as PCoA (Principal Coordinate Analysis), NMDS (Non-metric MultiDimenstional Scaling), PCA (Principal Component Analysis), among others. Theses graphs are very useful because help us to detect the differences in the structure of the microbiota among groups of samples. Both PCoA and NMDS are based on non-euclidean distances or dissimilarity measures, so we consider that they are the best options for microbiota analyses.</p>
<p>One the one hand, PCoA plots represent in two dimensions the arrangement of the samples in the multivariate space, although the percentage of the total variance is commonly explained by many dimensions. On the other hand, NMDS approach “forces” the samples to be ordinated in just two dimensions, although this forced arrangement has an associated <em>stress</em>. We tolerate stress values lower than 0.2.</p>
<p>We recommend calculating both ordination plots with the aim of selecting the option that best represents the results of PERMANOVA analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_rizo1<span class="ot">=</span> <span class="fu">ordinate</span>(rizo1_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)<span class="co">#indicate the ordination plot and the distance</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_rizo1<span class="sc">$</span>stress))<span class="co">#this shows the stress of the NMDS</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_rizo1 <span class="ot">=</span> <span class="fu">ordinate</span>(rizo1_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>peso_r1w<span class="ot">=</span>PCOA_wuni_rizo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>peso_r1w <span class="co">#This shows the percentage of the total variance explained by just the first and second axes</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_rizo2<span class="ot">=</span> <span class="fu">ordinate</span>(rizo2_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)<span class="co">#indicate the ordination plot and the distance</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_rizo2<span class="sc">$</span>stress))<span class="co">#this shows the stress of the NMDS</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_rizo2 <span class="ot">=</span> <span class="fu">ordinate</span>(rizo2_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>peso_r2w<span class="ot">=</span>PCOA_wuni_rizo2<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>peso_r2w <span class="co">#This shows the percentage of the total variance explained by just the first and second axes</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_endo1<span class="ot">=</span> <span class="fu">ordinate</span>(endo1_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_endo1<span class="sc">$</span>stress))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_endo1 <span class="ot">=</span> <span class="fu">ordinate</span>(endo1_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>peso_e1w<span class="ot">=</span>PCOA_wuni_endo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>peso_e1w</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_endo2<span class="ot">=</span> <span class="fu">ordinate</span>(endo2_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_endo2<span class="sc">$</span>stress))</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_endo2 <span class="ot">=</span> <span class="fu">ordinate</span>(endo2_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>peso_e2w<span class="ot">=</span>PCOA_wuni_endo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>peso_e2w</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once these values of stress and the weight of the axes are obtained, we should choose which option is the most suitable for our dataset. Although you can also use both method in your research paper. In this case, we selected PCoA plots because we obtained relatively high values of NMDS stress (&gt;0.13). It is easy to understand: our data are probably multidimensional are complex due to the high diversity and richness of the data, so it is easy to have high stress when forcing the data to fit just into two dimensions.</p>
<p>Let’s obtain the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a)RHIZOSPHERE</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>p_rizo1_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(rizo1_normalized_phyloseq, PCOA_wuni_rizo1,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span><span class="co">#to color by "Condition" and shape by "Year"</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_r1w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), <span class="co">#write the weight of each axis with two decimals</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_r1w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"cornflowerblue"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"darkgreen"</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"South Plot"</span>)<span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.15</span>, <span class="fl">0.1</span>))</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>p_rizo1_pcoa</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>p_rizo2_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(rizo2_normalized_phyloseq, PCOA_wuni_rizo2,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_r2w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_r2w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"magenta"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"darkolivegreen2"</span>),</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"North Plot"</span>)<span class="sc">+</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.15</span>))</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>p_rizo2_pcoa</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>p_endo1_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(endo1_normalized_phyloseq, PCOA_wuni_endo1,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_e1w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_e1w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"green"</span>),</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"South Plot"</span>)<span class="sc">+</span></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>p_endo1_pcoa</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>p_endo2_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(endo2_normalized_phyloseq, PCOA_wuni_endo2,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_e2w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_e2w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"blueviolet"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"aquamarine"</span>),</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"North Plot"</span>)<span class="sc">+</span></span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>p_endo2_pcoa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="taxonomical-profiles" class="level1">
<h1>6. Taxonomical profiles</h1>
<p>We already know that there are differences in the structure of bacterial communities in some case, however, we still do not know which taxa are the responsible of that differences. So, let’s analyze the taxonomical profiles. Fistly, we have to obtain the relative abundance of each ASV:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>phy_data_relabun<span class="ot">=</span><span class="fu">transform_sample_counts</span>(phy_total, <span class="cf">function</span>(x){x<span class="sc">/</span><span class="fu">sum</span>(x)}<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_data_relabun))<span class="co">#check that all sum 100%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="phylum-level" class="level2">
<h2 class="anchored" data-anchor-id="phylum-level">6.1 Phylum level</h2>
<section id="obtaining-tables-with-the-relative-abundance-and-standard-deviation-values" class="level3">
<h3 class="anchored" data-anchor-id="obtaining-tables-with-the-relative-abundance-and-standard-deviation-values">6.1.1. Obtaining tables with the relative abundance and standard deviation values</h3>
<p>We are going to obtain the relative abundance of each phylum detected in our samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>phylum_relabun<span class="ot">=</span><span class="fu">tax_glom</span>(phy_data_relabun, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>)<span class="co">#aglomerate at Phylum level</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phylum_relabun)) <span class="co">#check that the relative abundance sums 100% in all cases</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we are going to create a table with the relative abundance of each taxa in each replicate so that we can work on it, for instance, in Excel</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(phylum_relabun))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>aa<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">tax_table</span>(phylum_relabun),a)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(a),<span class="fu">rownames</span>(aa))<span class="co">#it should give "TRUE"</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(aa),aa),<span class="at">file=</span><span class="st">"abundrel_phylum_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Another table, with the mean and standard deviation of the relative abundance of each phylum:</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>table_phylum <span class="ot">=</span> a[,] <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>tax_phylum<span class="ot">=</span><span class="fu">tax_table</span>(phylum_relabun)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>phylum_media<span class="ot">=</span><span class="fu">aggregate</span>(table_phylum, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phylum_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>mean)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>) <span class="sc">%&gt;%</span> <span class="fu">t</span>()<span class="co">#calculate the mean values of the relative abundance of each phylum in each group of samples </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>phylum_sd <span class="ot">=</span><span class="fu">aggregate</span>(table_phylum, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phylum_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>sd)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">t</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="at">.fn=</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(phylum_media), <span class="st">"_SD"</span>))<span class="co">#calculate the standard deviation of the relative abundance of each phylum in each group of samples </span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>phylum_media_sd<span class="ot">=</span><span class="fu">merge</span>(tax_phylum, phylum_media, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span><span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(phylum_sd, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>)<span class="co">#bind mean and sd values into one table</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(phylum_media_sd),phylum_media_sd), <span class="at">file=</span><span class="st">"abundrel_media_sd_phylum.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting" class="level3">
<h3 class="anchored" data-anchor-id="plotting">6.1.2. Plotting</h3>
<p>We are going to make a stacked bars plot, just indicating the most abundant phyla</p>
<p>Firstly, we have to prepare the data and modify the table so that we can obtain tables suitable for the plotting with the package ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_melt_phylum <span class="ot">=</span> <span class="fu">psmelt</span>(<span class="at">physeq =</span> phylum_relabun) <span class="co">#transform the phyloseq object into a dataframe in which the abundance of each phylum is in rows</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_phylum) <span class="co"># check the content of the dataframe</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Here we aggregate the data by the factor we indicate in the argument "by".</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg1 <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_phylum<span class="sc">$</span>Abundance, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_phylum<span class="sc">$</span>Fusion, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sample=</span>df_melt_phylum<span class="sc">$</span>Sample,<span class="at">Phylum=</span>df_melt_phylum<span class="sc">$</span>Phylum,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">Compartment=</span>df_melt_phylum<span class="sc">$</span>Compartment,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Plot=</span>df_melt_phylum<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_phylum<span class="sc">$</span>Year, <span class="at">Condition=</span>df_melt_phylum<span class="sc">$</span>Condition), <span class="at">FUN=</span>sum)<span class="co">#it sums the abundance of each phylum in all the replicates corresponding to the same group of samples</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Sample"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)<span class="co">#rename the columns</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg1)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_aggreg1<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg1<span class="sc">$</span>Group, </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Phylum=</span>df_melt_aggreg1<span class="sc">$</span>Phylum,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Compartment=</span>df_melt_aggreg1<span class="sc">$</span>Compartment,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Plot=</span>df_melt_aggreg1<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg1<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg1<span class="sc">$</span>Condition), <span class="at">FUN=</span>mean)<span class="co">#now, it makes the mean relative abundance of each phylum in each group of samples</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>, <span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co">#repeat the same with the standard deviation</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_sd<span class="ot">=</span><span class="fu">aggregate</span>(df_melt_aggreg1<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg1<span class="sc">$</span>Group, </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Phylum=</span>df_melt_aggreg1<span class="sc">$</span>Phylum,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Compartment=</span>df_melt_aggreg1<span class="sc">$</span>Compartment,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Plot=</span>df_melt_aggreg1<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg1<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg1<span class="sc">$</span>Condition), <span class="at">FUN=</span>sd)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_sd)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"sd"</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether the groups of samples and the name of the phyla is the same in both mean and sd table</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Group<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Group)<span class="co">#it should give "TRUE"</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Phylum<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Phylum)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, add the sd values in the table of mean values</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean<span class="sc">$</span>sd<span class="ot">=</span>df_melt_aggreg_sd<span class="sc">$</span>sd </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_todos<span class="ot">=</span>df_melt_aggreg_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are ready to plot the mean relative abundances. We want to order the phyla by ascending relative abundance, keeping the unclassified and minor phyla in the upper part of the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]<span class="co">#subset the dataset</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo[media_sd_phylum_Rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate all the phyla that were not classified</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>unclassified_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] <span class="co">#save them into a new variable</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] <span class="co">#remove the unclassified phyla from the original dataset</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate all the phyla that account less than 1% into an artificial group named "Other phyla &lt;1%"</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum[media_sd_phylum_Rizo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>others_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]<span class="co">#save the "other phyla" into a new variable</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]<span class="co">#remove them from the original dataset</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, the minor and unclassified phyla are not included in the original dataset, so let's order by abundance the remaining phyla</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[<span class="fu">order</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] <span class="co">#order by relative abundance</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_rizo1,others_rizo1,unclassified_rizo1)<span class="co">#now add the minor phyla and the unclassified</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>group_label_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mature"</span>,<span class="st">"Immature"</span>, <span class="st">"Mature"</span>,<span class="st">"Immature"</span>)<span class="co">#set the labels</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>levels_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,<span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)<span class="co">#set the levels of the graph</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>limits_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,<span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)<span class="co">#set the limits of the graph</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_rizo1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>nombres_unicos_rizo1<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_rizo1)<span class="co">#get the levels (=the names of the phyla )of the factor "Phylum", and show them just once regardless of their abundance and prevalence)</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_rizo1<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_rizo1))<span class="co">#order the name of the phyla</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>lab_unicos_rizo1<span class="ot">=</span>nombres_unicos_rizo1 </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_rizo1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_rizo1,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                                    {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co">#this function helps us to write the name of the phyla (and genera) in italics and the name of the minor phyla and unclassified without italics</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>colores_rizo1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>, <span class="st">"#9933FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"red"</span>, <span class="st">"brown"</span>,<span class="st">"#FF00FF"</span>,<span class="st">"darkolivegreen"</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#FFFF00"</span>,<span class="st">"grey"</span>, <span class="st">"black"</span>)<span class="co">#choose the colors of specific phyla</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo1)<span class="sc">==</span><span class="fu">length</span>(colores_rizo1)  <span class="co">#in case of "FALSE", check the number of phyla and the number of colors. Establish as many colors as number of phyla (including the groups of minor and unclassified phyla)</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo1)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_rizo1)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>titulo_plot_rizo1<span class="ot">=</span><span class="st">"Plot 1"</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>p_rizo_1_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_rizo1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_rizo1,</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_rizo1,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_rizo1)<span class="sc">+</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_rizo1)<span class="sc">+</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_rizo1,<span class="at">labels=</span>group_label_rizo1,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span>levels_rizo1)<span class="sc">+</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>p_rizo_1_phylum</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo[media_sd_phylum_Rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>unclassified_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum[media_sd_phylum_Rizo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>others_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[<span class="fu">order</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_rizo2,others_rizo2,unclassified_rizo2)</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>group_label_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mature"</span>,<span class="st">"Immature"</span>, <span class="st">"Mature"</span>,<span class="st">"Immature"</span>)</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>levels_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,<span class="st">"B_Plot2_Mature_Rhizosphere"</span>,</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>               <span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>limits_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,<span class="st">"B_Plot2_Mature_Rhizosphere"</span>,</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>               <span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_rizo2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>nombres_unicos_rizo2<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_rizo2)</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_rizo2<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_rizo2))</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>lab_unicos_rizo2<span class="ot">=</span>nombres_unicos_rizo2</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_rizo2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_rizo2,</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>                                     {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>colores_rizo2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>, <span class="st">"#00CC00"</span>, <span class="st">"#9933FF"</span>,<span class="st">"red"</span>,<span class="st">"#FF00FF"</span>,</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"brown"</span>,<span class="st">"#FFFF00"</span>,<span class="st">"blue"</span>,<span class="st">"grey"</span>, <span class="st">"black"</span>)</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo2)<span class="sc">==</span><span class="fu">length</span>(colores_rizo2) </span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo2)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_rizo2)</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>titulo_plot_rizo2<span class="ot">=</span><span class="st">"Plot 2"</span></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>p_rizo_2_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_rizo2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_rizo2,</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_rizo2,</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_rizo2)<span class="sc">+</span></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_rizo2)<span class="sc">+</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_rizo2,<span class="at">labels=</span>group_label_rizo2,</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_rizo2)<span class="sc">+</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>p_rizo_2_phylum</span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Endosphere"</span>,]</span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo[media_sd_phylum_Endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Endo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a>unclassified_endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum[media_sd_phylum_Endo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb24-154"><a href="#cb24-154" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Endo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-155"><a href="#cb24-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a>others_endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="ot">=</span>media_sd_phylum_Endo1[<span class="fu">order</span>(media_sd_phylum_Endo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_endo1,others_endo1,unclassified_endo1)</span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>group_label_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>)</span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a>levels_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,<span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a>limits_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,<span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_endo1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_endo1<span class="sc">$</span>Phylum)</span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>nombres_unicos_endo1<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_endo1)</span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_endo1<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_endo1))</span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a>lab_unicos_endo1<span class="ot">=</span>nombres_unicos_endo1 </span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_endo1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_endo1,</span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a>                                    {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a>colores_endo1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"brown"</span>,<span class="st">"yellow"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"red"</span>, <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo1)<span class="sc">==</span><span class="fu">length</span>(colores_endo1) </span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo1)</span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_endo1)</span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a>titulo_plot_endo1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>p_endo1_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_endo1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_endo1,</span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_endo1,</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_endo1)<span class="sc">+</span></span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_endo1)<span class="sc">+</span></span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_endo1,<span class="at">labels=</span>group_label_endo1,</span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_endo1)<span class="sc">+</span></span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>p_endo1_phylum</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo[media_sd_phylum_Endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Endo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a>unclassified_endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum[media_sd_phylum_Endo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Endo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a>others_endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-222"><a href="#cb24-222" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb24-223"><a href="#cb24-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="ot">=</span>media_sd_phylum_Endo2[<span class="fu">order</span>(media_sd_phylum_Endo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),]</span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_endo2,others_endo2,unclassified_endo2)</span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a>group_label_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>)</span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>levels_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,<span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a>limits_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,<span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_endo2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_endo2<span class="sc">$</span>Phylum)</span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a>nombres_unicos_endo2<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_endo2)</span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_endo2<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_endo2))</span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a>lab_unicos_endo2<span class="ot">=</span>nombres_unicos_endo2 </span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_endo2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_endo2,</span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a>                                     {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a>colores_endo2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"brown"</span>,<span class="st">"#9933FF"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"yellow"</span>,<span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo2)<span class="sc">==</span><span class="fu">length</span>(colores_endo2) </span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo2)</span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_endo2)</span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a>titulo_plot_endo2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-249"><a href="#cb24-249" aria-hidden="true" tabindex="-1"></a>p_endo2_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_endo2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb24-250"><a href="#cb24-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_endo2,</span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_endo2,</span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_endo2)<span class="sc">+</span></span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_endo2)<span class="sc">+</span></span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span><span class="co">#sirve para cambiar el orden de la leyenda</span></span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_endo2,<span class="at">labels=</span>group_label_endo2,</span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_endo2)<span class="sc">+</span></span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a>p_endo2_phylum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="genus-level" class="level2">
<h2 class="anchored" data-anchor-id="genus-level">6.2. Genus level</h2>
<section id="obtain-tables-with-the-relative-abundance-and-standard-deviation-values" class="level3">
<h3 class="anchored" data-anchor-id="obtain-tables-with-the-relative-abundance-and-standard-deviation-values">6.2.1. Obtain tables with the relative abundance and standard deviation values</h3>
<p>We are going to obtain the relative abundance of each phylum detected in our samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>genus_relabun<span class="ot">=</span><span class="fu">tax_glom</span>(phy_data_relabun, <span class="at">taxrank =</span> <span class="st">"Genus"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(genus_relabun))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(genus_relabun))</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>bb<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">tax_table</span>(genus_relabun),b)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(b),<span class="fu">rownames</span>(bb))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(bb),bb),<span class="at">file=</span><span class="st">"abundrel_Genero_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>table_genus <span class="ot">=</span> <span class="fu">otu_table</span>(genus_relabun)[,] <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>tax_genus<span class="ot">=</span><span class="fu">tax_table</span>(genus_relabun)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>genus_media<span class="ot">=</span><span class="fu">aggregate</span>(table_genus, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(genus_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>mean)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>) <span class="sc">%&gt;%</span> <span class="fu">t</span>() </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>genus_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(table_genus, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(genus_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>sd)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">t</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="at">.fn=</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(genus_media), <span class="st">"_SD"</span>))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>genus_media_sd<span class="ot">=</span><span class="fu">merge</span>(tax_genus, genus_media, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span><span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(genus_sd, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(genus_media_sd[,<span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(genus_media_sd)])</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>genus_media_sd<span class="sc">$</span>ASV_names<span class="ot">=</span><span class="fu">row.names</span>(genus_media_sd)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(genus_media_sd),genus_media_sd), <span class="at">file=</span><span class="st">"abundrel_media_sd_genus.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-1" class="level3">
<h3 class="anchored" data-anchor-id="plotting-1">6.2.2. Plotting</h3>
<p>We are going to make a stacked bars plot, just indicating the most abundant genera</p>
<p>Firstly, we have to prepare the data and modify the table so that we can obtain tables suitable for the plotting with the package ggplot2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_melt_genus <span class="ot">=</span> <span class="fu">psmelt</span>(<span class="at">physeq =</span> genus_relabun) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_genus) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg2 <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_genus<span class="sc">$</span>Abundance, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_genus<span class="sc">$</span>Fusion, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sample=</span>df_melt_genus<span class="sc">$</span>Sample,<span class="at">Genus=</span>df_melt_genus<span class="sc">$</span>Genus,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Compartment=</span>df_melt_genus<span class="sc">$</span>Compartment,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Plot=</span>df_melt_genus<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_genus<span class="sc">$</span>Year, <span class="at">Condition=</span>df_melt_genus<span class="sc">$</span>Condition), <span class="at">FUN=</span>sum)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Sample"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg2) </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_aggreg2<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg2<span class="sc">$</span>Group, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Genus=</span>df_melt_aggreg2<span class="sc">$</span>Genus,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Compartment=</span>df_melt_aggreg2<span class="sc">$</span>Compartment,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Plot=</span>df_melt_aggreg2<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg2<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg2<span class="sc">$</span>Condition), <span class="at">FUN=</span>mean)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>, <span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_sd<span class="ot">=</span><span class="fu">aggregate</span>(df_melt_aggreg2<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg2<span class="sc">$</span>Group, </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Genus=</span>df_melt_aggreg2<span class="sc">$</span>Genus,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Compartment=</span>df_melt_aggreg2<span class="sc">$</span>Compartment,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Plot=</span>df_melt_aggreg2<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg2<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg2<span class="sc">$</span>Condition), <span class="at">FUN=</span>sd)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_sd)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"sd"</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Group<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Group)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Genus<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Genus)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean<span class="sc">$</span>sd<span class="ot">=</span>df_melt_aggreg_sd<span class="sc">$</span>sd </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>media_sd_genus_todos<span class="ot">=</span>df_melt_aggreg_mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are ready to plot the mean relative abundances. We want to order the genera by ascending relative abundance, keeping the unclassified and minor genera in the upper part of the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo<span class="ot">=</span>media_sd_genus_todos[media_sd_genus_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo[media_sd_genus_rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_rizo1<span class="sc">$</span>Genus)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>unclassified_r1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus[media_sd_genus_rizo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_rizo1<span class="sc">$</span>Genus)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>others_r1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="ot">=</span>media_sd_genus_rizo1[<span class="fu">order</span>(media_sd_genus_rizo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_r1,others_r1,unclassified_r1)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>group_label_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>levels_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>           <span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>limits_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_r1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_r1<span class="sc">$</span>Genus)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>nombres_unicos_r1<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_r1)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_r1<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_r1))</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>lab_unicos_r1<span class="ot">=</span>nombres_unicos_r1 </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_r1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_r1,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>colores_r1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"brown"</span>,<span class="st">"yellow"</span>,<span class="st">"orange"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"red"</span>, </span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>               <span class="st">"pink"</span>, <span class="st">"magenta"</span>,<span class="st">"blue"</span>,<span class="st">"khaki2"</span>, </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r1)<span class="sc">==</span><span class="fu">length</span>(colores_r1) </span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r1)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_r1)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>titulo_plot_r1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>pgenus_r1<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_r1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_r1,</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_r1,</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_r1)<span class="sc">+</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_r1)<span class="sc">+</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_r1,<span class="at">labels=</span>group_label_r1,</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_r1)<span class="sc">+</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>pgenus_r1</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo[media_sd_genus_rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_rizo2<span class="sc">$</span>Genus)</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>unclassified_r2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus[media_sd_genus_rizo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_rizo2<span class="sc">$</span>Genus)</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>others_r2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="ot">=</span>media_sd_genus_rizo2[<span class="fu">order</span>(media_sd_genus_rizo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_r2,others_r2,unclassified_r2)</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>group_label_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>levels_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Rhizosphere"</span>,<span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>limits_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Rhizosphere"</span>,<span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_r2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_r2<span class="sc">$</span>Genus)</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>nombres_unicos_r2<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_r2)</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_r2<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_r2))</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>lab_unicos_r2<span class="ot">=</span>nombres_unicos_r2</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_r2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_r2,</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>colores_r2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"yellow"</span>,<span class="st">"green4"</span>,<span class="st">"steelblue4"</span>,<span class="st">"brown"</span>,<span class="st">"maroon"</span>,<span class="st">"gold1"</span>,</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r2)<span class="sc">==</span><span class="fu">length</span>(colores_r2)</span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r2)</span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_r2)</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>titulo_plot_r2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>pgenus_r2<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_r2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_r2,</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_r2,</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_r2)<span class="sc">+</span></span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_r2)<span class="sc">+</span></span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_r2,<span class="at">labels=</span>group_label_r2,</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_r2)<span class="sc">+</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a>pgenus_r2</span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo<span class="ot">=</span>media_sd_genus_todos[media_sd_genus_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Endosphere"</span>,]</span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb27-150"><a href="#cb27-150" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo[media_sd_genus_endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb27-151"><a href="#cb27-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_endo1<span class="sc">$</span>Genus)</span>
<span id="cb27-153"><a href="#cb27-153" aria-hidden="true" tabindex="-1"></a>unclassified_e1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb27-154"><a href="#cb27-154" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-156"><a href="#cb27-156" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus[media_sd_genus_endo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb27-157"><a href="#cb27-157" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_endo1<span class="sc">$</span>Genus)</span>
<span id="cb27-158"><a href="#cb27-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-159"><a href="#cb27-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-160"><a href="#cb27-160" aria-hidden="true" tabindex="-1"></a>others_e1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-161"><a href="#cb27-161" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-162"><a href="#cb27-162" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="ot">=</span>media_sd_genus_endo1[<span class="fu">order</span>(media_sd_genus_endo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb27-163"><a href="#cb27-163" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_e1,others_e1,unclassified_e1)</span>
<span id="cb27-164"><a href="#cb27-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-165"><a href="#cb27-165" aria-hidden="true" tabindex="-1"></a>group_label_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb27-166"><a href="#cb27-166" aria-hidden="true" tabindex="-1"></a>levels_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,</span>
<span id="cb27-167"><a href="#cb27-167" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb27-168"><a href="#cb27-168" aria-hidden="true" tabindex="-1"></a>limits_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,</span>
<span id="cb27-169"><a href="#cb27-169" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb27-170"><a href="#cb27-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-171"><a href="#cb27-171" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_e1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_e1<span class="sc">$</span>Genus)</span>
<span id="cb27-172"><a href="#cb27-172" aria-hidden="true" tabindex="-1"></a>nombres_unicos_e1<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_e1)</span>
<span id="cb27-173"><a href="#cb27-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-174"><a href="#cb27-174" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_e1<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_e1))</span>
<span id="cb27-175"><a href="#cb27-175" aria-hidden="true" tabindex="-1"></a>lab_unicos_e1<span class="ot">=</span>nombres_unicos_e1 </span>
<span id="cb27-176"><a href="#cb27-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-177"><a href="#cb27-177" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_e1<span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_e1,</span>
<span id="cb27-178"><a href="#cb27-178" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb27-179"><a href="#cb27-179" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb27-180"><a href="#cb27-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-181"><a href="#cb27-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-182"><a href="#cb27-182" aria-hidden="true" tabindex="-1"></a>colores_e1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"purple"</span>,<span class="st">"violet"</span>,<span class="st">"firebrick"</span>,<span class="st">"#CAB2D6"</span>,<span class="st">"powderblue"</span>,<span class="st">"yellow4"</span>,<span class="st">"#FB9A99"</span>,</span>
<span id="cb27-183"><a href="#cb27-183" aria-hidden="true" tabindex="-1"></a>               <span class="st">"#FDBF6F"</span>, <span class="st">"coral2"</span>,<span class="st">"springgreen3"</span>,<span class="st">"lightgoldenrod2"</span>,<span class="st">"mediumorchid2"</span>,<span class="st">"gold1"</span>,</span>
<span id="cb27-184"><a href="#cb27-184" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb27-185"><a href="#cb27-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-186"><a href="#cb27-186" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e1)<span class="sc">==</span><span class="fu">length</span>(colores_e1)</span>
<span id="cb27-187"><a href="#cb27-187" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e1)</span>
<span id="cb27-188"><a href="#cb27-188" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_e1)</span>
<span id="cb27-189"><a href="#cb27-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-190"><a href="#cb27-190" aria-hidden="true" tabindex="-1"></a>titulo_plot_e1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb27-191"><a href="#cb27-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-192"><a href="#cb27-192" aria-hidden="true" tabindex="-1"></a>pgenus_e1<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_e1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb27-193"><a href="#cb27-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_e1,</span>
<span id="cb27-194"><a href="#cb27-194" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_e1,</span>
<span id="cb27-195"><a href="#cb27-195" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_e1)<span class="sc">+</span></span>
<span id="cb27-196"><a href="#cb27-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_e1)<span class="sc">+</span></span>
<span id="cb27-197"><a href="#cb27-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb27-198"><a href="#cb27-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_e1,<span class="at">labels=</span>group_label_e1,</span>
<span id="cb27-199"><a href="#cb27-199" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_e1)<span class="sc">+</span></span>
<span id="cb27-200"><a href="#cb27-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb27-201"><a href="#cb27-201" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb27-202"><a href="#cb27-202" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb27-203"><a href="#cb27-203" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb27-204"><a href="#cb27-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb27-205"><a href="#cb27-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb27-206"><a href="#cb27-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb27-207"><a href="#cb27-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-208"><a href="#cb27-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-209"><a href="#cb27-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-210"><a href="#cb27-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-211"><a href="#cb27-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb27-212"><a href="#cb27-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb27-213"><a href="#cb27-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb27-214"><a href="#cb27-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb27-215"><a href="#cb27-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb27-216"><a href="#cb27-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb27-217"><a href="#cb27-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-218"><a href="#cb27-218" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb27-219"><a href="#cb27-219" aria-hidden="true" tabindex="-1"></a>pgenus_e1</span>
<span id="cb27-220"><a href="#cb27-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-221"><a href="#cb27-221" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb27-222"><a href="#cb27-222" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo[media_sd_genus_endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb27-223"><a href="#cb27-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-224"><a href="#cb27-224" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_endo2<span class="sc">$</span>Genus)</span>
<span id="cb27-225"><a href="#cb27-225" aria-hidden="true" tabindex="-1"></a>unclassified_e2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb27-226"><a href="#cb27-226" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb27-227"><a href="#cb27-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-228"><a href="#cb27-228" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus[media_sd_genus_endo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb27-229"><a href="#cb27-229" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_endo2<span class="sc">$</span>Genus)</span>
<span id="cb27-230"><a href="#cb27-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-231"><a href="#cb27-231" aria-hidden="true" tabindex="-1"></a>others_e2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-232"><a href="#cb27-232" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb27-233"><a href="#cb27-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-234"><a href="#cb27-234" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="ot">=</span>media_sd_genus_endo2[<span class="fu">order</span>(media_sd_genus_endo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb27-235"><a href="#cb27-235" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_e2,others_e2,unclassified_e2)</span>
<span id="cb27-236"><a href="#cb27-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-237"><a href="#cb27-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-238"><a href="#cb27-238" aria-hidden="true" tabindex="-1"></a>group_label_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb27-239"><a href="#cb27-239" aria-hidden="true" tabindex="-1"></a>levels_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,</span>
<span id="cb27-240"><a href="#cb27-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb27-241"><a href="#cb27-241" aria-hidden="true" tabindex="-1"></a>limits_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,</span>
<span id="cb27-242"><a href="#cb27-242" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb27-243"><a href="#cb27-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-244"><a href="#cb27-244" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_e2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_e2<span class="sc">$</span>Genus)</span>
<span id="cb27-245"><a href="#cb27-245" aria-hidden="true" tabindex="-1"></a>nombres_unicos_e2<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_e2)</span>
<span id="cb27-246"><a href="#cb27-246" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_e2<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_e2))</span>
<span id="cb27-247"><a href="#cb27-247" aria-hidden="true" tabindex="-1"></a>lab_unicos_e2<span class="ot">=</span>nombres_unicos_e2 </span>
<span id="cb27-248"><a href="#cb27-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-249"><a href="#cb27-249" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_e2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_e2,</span>
<span id="cb27-250"><a href="#cb27-250" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb27-251"><a href="#cb27-251" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb27-252"><a href="#cb27-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-253"><a href="#cb27-253" aria-hidden="true" tabindex="-1"></a>colores_e2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"purple"</span>, <span class="st">"violet"</span>,<span class="st">"burlywood"</span>,<span class="st">"gold1"</span>,<span class="st">"darkseagreen2"</span>,<span class="st">"darkmagenta"</span>,<span class="st">"sienna2"</span>,<span class="st">"grey90"</span>,<span class="st">"mediumslateblue"</span>,</span>
<span id="cb27-254"><a href="#cb27-254" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lightgoldenrod2"</span>,<span class="st">"springgreen3"</span>,<span class="st">"#00CC00"</span>,<span class="st">"saddlebrown"</span>,<span class="st">"orangered2"</span>,<span class="st">"powderblue"</span>,<span class="st">"#CAB2D6"</span>,<span class="st">"peachpuff"</span>,</span>
<span id="cb27-255"><a href="#cb27-255" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb27-256"><a href="#cb27-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-257"><a href="#cb27-257" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e2)<span class="sc">==</span><span class="fu">length</span>(colores_e2) </span>
<span id="cb27-258"><a href="#cb27-258" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e2)</span>
<span id="cb27-259"><a href="#cb27-259" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_e2)</span>
<span id="cb27-260"><a href="#cb27-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-261"><a href="#cb27-261" aria-hidden="true" tabindex="-1"></a>titulo_plot_e2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb27-262"><a href="#cb27-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-263"><a href="#cb27-263" aria-hidden="true" tabindex="-1"></a>pgenus_e2<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_e2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb27-264"><a href="#cb27-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_e2,</span>
<span id="cb27-265"><a href="#cb27-265" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_e2,</span>
<span id="cb27-266"><a href="#cb27-266" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_e2)<span class="sc">+</span></span>
<span id="cb27-267"><a href="#cb27-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_e2)<span class="sc">+</span></span>
<span id="cb27-268"><a href="#cb27-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb27-269"><a href="#cb27-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_e2,<span class="at">labels=</span>group_label_e2,</span>
<span id="cb27-270"><a href="#cb27-270" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_e2)<span class="sc">+</span></span>
<span id="cb27-271"><a href="#cb27-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb27-272"><a href="#cb27-272" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb27-273"><a href="#cb27-273" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb27-274"><a href="#cb27-274" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb27-275"><a href="#cb27-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb27-276"><a href="#cb27-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb27-277"><a href="#cb27-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb27-278"><a href="#cb27-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-279"><a href="#cb27-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-280"><a href="#cb27-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-281"><a href="#cb27-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb27-282"><a href="#cb27-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb27-283"><a href="#cb27-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb27-284"><a href="#cb27-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb27-285"><a href="#cb27-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb27-286"><a href="#cb27-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb27-287"><a href="#cb27-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb27-288"><a href="#cb27-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-289"><a href="#cb27-289" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb27-290"><a href="#cb27-290" aria-hidden="true" tabindex="-1"></a>pgenus_e2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In Figure 7 you can observe an example of the stacked bar plot for the main genera. This kind of plot can be calculated at the taxonomical rank you prefer. Please, try to open the plot in a new window if you want to view it at full size.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Genera_endo2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Figure 7. Distribution of the main classified genera in the root endosphere of mother and sucker plants in 2022 (left) and 2023 (right)</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="inheritance-analyses" class="level1">
<h1>7. Inheritance analyses</h1>
<p>Our experimental design allows us to study the potential transmission of microorganisms from mothers to first and second suckers. For that purpose, we firstly compared the root microbiota of mothers and first suckers, and then, these shared microorganisms were further compared against the microbiota of rhizosphere of sucker plants. It is expected that the microorganisms that are found in the root endosphere of suckers (and not found in the rhizosphere) and also in the root endosphere of mother plants, are transferred from mothers to suckers through the root system (corm), but not acquired from the surrounding soil of from the environment.</p>
<p>We will perform this analysis just at ASV level</p>
<section id="prepare-the-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-the-data">7.1 Prepare the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mt1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_data_relabun))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">=</span> <span class="fu">unique</span>(mt1<span class="sc">$</span>Fusion) <span class="co">#get the name of each level of the variable "Fusion", which in this example corresponds to each individual group of samples. For instance, the first level of the variable "Fusion" is "A_Plot1_Mature_Rhizosphere" (all rhizosphere samples of mother plants sampled in 2022 located in the south plot)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#in the following for loop we are creating a list in which we are saving one each phyloseq object per group of samples. That is to say, in the first element of the list, the phyloseq object corresponding to the samples of the rhizosphere of mother plants sampled in 2022 located in the south plot is stored.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>pruned_data <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(names)){</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  samples_group <span class="ot">=</span> mt1[<span class="fu">which</span>(mt1<span class="sc">$</span>Fusion<span class="sc">==</span>names[i]),]<span class="sc">$</span>Sample</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  pruned_data[[i]] <span class="ot">=</span> <span class="fu">prune_samples</span>(samples_group, phy_data_relabun)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#this loop stored the taxonony and ASV table of each phyloseq element of the previously created list</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>otu_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>tax_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pruned_data)){</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  otu_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(pruned_data[[i]]))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  tax_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(pruned_data[[i]]))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>}<span class="co">#it gives the list "otu_tables", whose element [[1]] corresponds to the ASV table of the group of sample "A_Plot1_Mature_Rhizosphere". While "tax_tables" list stores the taxonomy tables</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#this list merges each ASV table with each tax table by rownames (by=0)</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>whole_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pruned_data)){</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  whole_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">merge</span>(tax_tables[[i]],otu_tables[[i]], <span class="at">by=</span><span class="dv">0</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(whole_tables)){</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  whole_tables[[i]]<span class="sc">$</span>ASV_names<span class="ot">=</span>whole_tables[[i]]<span class="sc">$</span>Row.names</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>}<span class="co">#it creates a new column in the list "wholes_tables" that corresponds to the rownames</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(whole_tables)){ <span class="co">#create one dataframe per element from the list "whole_tables"</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(names[i],<span class="st">"_df"</span>),<span class="fu">as.data.frame</span>(whole_tables[[i]]))</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co">#the previous loop returns complex dataframe names, so let's rename them and calculate the total number of sequences registered for each ASV in all the corresponding dataset </span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>A_r1_M<span class="ot">=</span>A_Plot1_Mature_Rhizosphere_df; A_r1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r1_M)]); A_r1_M_def<span class="ot">=</span>A_r1_M[<span class="fu">which</span>(A_r1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))<span class="co">#we remove those ASV that account for 0 sequences in sum in each dataset</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>A_e1_M<span class="ot">=</span>A_Plot1_Mature_Endosphere_df; A_e1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e1_M)]); A_e1_M_def<span class="ot">=</span>A_e1_M[<span class="fu">which</span>(A_e1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>A_e1_I<span class="ot">=</span>A_Plot1_Immature_Endosphere_df; A_e1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e1_I)]); A_e1_I_def<span class="ot">=</span>A_e1_I[<span class="fu">which</span>(A_e1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>A_r1_I<span class="ot">=</span>A_Plot1_Immature_Rhizosphere_df; A_r1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r1_I)]); A_r1_I_def<span class="ot">=</span>A_r1_I[<span class="fu">which</span>(A_r1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>A_e2_M<span class="ot">=</span>A_Plot2_Mature_Endosphere_df; A_e2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e2_M)]); A_e2_M_def<span class="ot">=</span>A_e2_M[<span class="fu">which</span>(A_e2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>A_r2_M<span class="ot">=</span>A_Plot2_Mature_Rhizosphere_df; A_r2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r2_M)]); A_r2_M_def<span class="ot">=</span>A_r2_M[<span class="fu">which</span>(A_r2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>A_r2_I<span class="ot">=</span>A_Plot2_Immature_Rhizosphere_df; A_r2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r2_I)]); A_r2_I_def<span class="ot">=</span>A_r2_I[<span class="fu">which</span>(A_r2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>A_e2_I<span class="ot">=</span>A_Plot2_Immature_Endosphere_df; A_e2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e2_I)]);A_e2_I_def<span class="ot">=</span>A_e2_I[<span class="fu">which</span>(A_e2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>B_r1_M<span class="ot">=</span>B_Plot1_Mature_Rhizosphere_df; B_r1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r1_M)]); B_r1_M_def<span class="ot">=</span>B_r1_M[<span class="fu">which</span>(B_r1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>B_r1_I<span class="ot">=</span>B_Plot1_Immature_Rhizosphere_df; B_r1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r1_I)]); B_r1_I_def<span class="ot">=</span>B_r1_I[<span class="fu">which</span>(B_r1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>B_r2_M<span class="ot">=</span>B_Plot2_Mature_Rhizosphere_df; B_r2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r2_M)]); B_r2_M_def<span class="ot">=</span>B_r2_M[<span class="fu">which</span>(B_r2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>B_r2_I<span class="ot">=</span>B_Plot2_Immature_Rhizosphere_df; B_r2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r2_I)]); B_r2_I_def<span class="ot">=</span>B_r2_I[<span class="fu">which</span>(B_r2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>B_e1_I<span class="ot">=</span>B_Plot1_Immature_Endosphere_df; B_e1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e1_I)]); B_e1_I_def<span class="ot">=</span>B_e1_I[<span class="fu">which</span>(B_e1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>B_e1_M<span class="ot">=</span>B_Plot1_Mature_Endosphere_df; B_e1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e1_M)]); B_e1_M_def<span class="ot">=</span>B_e1_M[<span class="fu">which</span>(B_e1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>B_e2_M<span class="ot">=</span>B_Plot2_Mature_Endosphere_df; B_e2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e2_M)]); B_e2_M_def<span class="ot">=</span>B_e2_M[<span class="fu">which</span>(B_e2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>B_e2_I<span class="ot">=</span>B_Plot2_Immature_Endosphere_df; B_e2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e2_I)]); B_e2_I_def<span class="ot">=</span>B_e2_I[<span class="fu">which</span>(B_e2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compare-asvs-between-mother-and-sucker-plants" class="level2">
<h2 class="anchored" data-anchor-id="compare-asvs-between-mother-and-sucker-plants">7.2 Compare ASVs between mother and sucker plants</h2>
<p>Remember that we want to retain the ASVs that are shared between mother and sucker plants (just in the root endosphere). They could be both inherited or acquired from the rhizosphere soil.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>compartidos_A_e1<span class="ot">=</span><span class="fu">cbind</span>(A_e1_M_def2[A_e1_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e1_I_def2<span class="sc">$</span>ASV_names,], A_e1_I_def2[A_e1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e1_M_def2<span class="sc">$</span>ASV_names,])<span class="co">#retain those ASVs that are in the dataframe of mothers and suckers (root endosphere)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>compartidos_A_e1<span class="ot">=</span>compartidos_A_e1[,<span class="sc">-</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)]<span class="co">#removing extra information</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A_e1),compartidos_A_e1),<span class="at">file=</span><span class="st">"Core_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>compartidos_B_e1<span class="ot">=</span><span class="fu">cbind</span>(B_e1_M_def2[B_e1_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e1_I_def2<span class="sc">$</span>ASV_names,], B_e1_I_def2[B_e1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e1_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>compartidos_B_e1<span class="ot">=</span>compartidos_B_e1[,<span class="sc">-</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">27</span>)]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B_e1),compartidos_B_e1),<span class="at">file=</span><span class="st">"Core_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>compartidos_A_e2<span class="ot">=</span><span class="fu">cbind</span>(A_e2_M_def2[A_e2_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e2_I_def2<span class="sc">$</span>ASV_names,], A_e2_I_def2[A_e2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e2_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>compartidos_A_e2<span class="ot">=</span>compartidos_A_e2[,<span class="sc">-</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A_e2),compartidos_A_e2),<span class="at">file=</span><span class="st">"Core_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>compartidos_B_e2<span class="ot">=</span><span class="fu">cbind</span>(B_e2_M_def2[B_e2_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e2_I_def2<span class="sc">$</span>ASV_names,], B_e2_I_def2[B_e2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e2_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>compartidos_B_e2<span class="ot">=</span>compartidos_B_e2[,<span class="sc">-</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">26</span>)]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B_e2),compartidos_B_e2),<span class="at">file=</span><span class="st">"Core_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are going to compare the shared bacterial communities against the bacterial communities dwelling in the rhizosphere soil of the suckers. We will retain bacterial members that are in the root endosphere but <strong>NO</strong> in the rhizosphere soil</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>compartidos_A1_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_A_e1[compartidos_A_e1<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_r1_I_def2<span class="sc">$</span>ASV_names,], A_r1_I_def2[A_r1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_A_e1<span class="sc">$</span>ASV_names,])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>compartidos_A1_endo_rizo<span class="ot">=</span>compartidos_A1_endo_rizo[,<span class="sc">-</span>(<span class="dv">33</span><span class="sc">:</span><span class="dv">40</span>)]<span class="co">#remove extra information from the data (additional columns indicating, again, the taxonomy of the ASVs)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A1_endo_rizo),compartidos_A1_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_A1_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>compartidos_B1_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_B_e1[compartidos_B_e1<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_r1_I_def2<span class="sc">$</span>ASV_names,], B_r1_I_def2[B_r1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_B_e1<span class="sc">$</span>ASV_names,])</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>compartidos_B1_endo_rizo<span class="ot">=</span>compartidos_B1_endo_rizo[,<span class="sc">-</span>(<span class="dv">28</span><span class="sc">:</span><span class="dv">35</span>)]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B1_endo_rizo),compartidos_B1_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_B1_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>compartidos_A2_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_A_e2[compartidos_A_e2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_r2_I_def2<span class="sc">$</span>ASV_names,], A_r2_I_def2[A_r2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_A_e2<span class="sc">$</span>ASV_names,])</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>compartidos_A2_endo_rizo<span class="ot">=</span>compartidos_A2_endo_rizo[,<span class="sc">-</span>(<span class="dv">29</span><span class="sc">:</span><span class="dv">36</span>)]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A2_endo_rizo),compartidos_A2_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_A2_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>compartidos_B2_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_B_e2[compartidos_B_e2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_r2_I_def2<span class="sc">$</span>ASV_names,], B_r2_I_def2[B_r2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_B_e2<span class="sc">$</span>ASV_names,])</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>compartidos_B2_endo_rizo<span class="ot">=</span>compartidos_B2_endo_rizo[,<span class="sc">-</span>(<span class="dv">27</span><span class="sc">:</span><span class="dv">34</span>)]</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B2_endo_rizo),compartidos_B2_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_B2_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove those ASV detected both in the rhizosphere and in the root endosphere</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_A_e1, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_A1_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A1_endo),especif_A1_endo),<span class="at">file=</span><span class="st">"A1_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_B_e1, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_B1_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B1_endo),especif_B1_endo),<span class="at">file=</span><span class="st">"B1_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_A_e2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_A2_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A2_endo),especif_A2_endo),<span class="at">file=</span><span class="st">"A2_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_B_e2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_B2_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B2_endo),especif_B2_endo),<span class="at">file=</span><span class="st">"B2_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this work, we analyzed carefully the number and proportions of the transferred ASVs in Excel</p>
</section>
<section id="plotting-2" class="level2">
<h2 class="anchored" data-anchor-id="plotting-2">7.3 Plotting</h2>
<p>In this section, we are going to make different graph representing the inheritance process. We will use barplots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>totales_M_A_e1<span class="ot">=</span><span class="fu">nrow</span>(A_e1_M_def2)<span class="co">#get the total number of ASV in mothers</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>transferidos_A_e1<span class="ot">=</span><span class="fu">nrow</span>(especif_A1_endo)<span class="co">#get the number of shared ASVs between mothers and suckers</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_A_e1<span class="ot">=</span>(transferidos_A_e1 <span class="sc">/</span> totales_M_A_e1) <span class="sc">*</span><span class="dv">100</span> <span class="co">#calculate the proportion of transferred ASVs</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_A_e1<span class="ot">=</span>((totales_M_A_e1<span class="sc">-</span>transferidos_A_e1) <span class="sc">/</span> totales_M_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#calculate the proportion of ASVs lost by the mothers</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>totales_I_A_e1<span class="ot">=</span><span class="fu">nrow</span>(A_e1_I_def2)<span class="co">#get the total number of ASVs in suckers</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_A_e1<span class="ot">=</span>(transferidos_A_e1 <span class="sc">/</span> totales_I_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#get the number of shared ASVs between mothers and suckers</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_A_e1<span class="ot">=</span>((totales_I_A_e1<span class="sc">-</span>transferidos_A_e1) <span class="sc">/</span> totales_I_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#calculate the proportion of ASVs acquired by the suckers</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_A_e1,prop_perdidos_M_A_e1,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>                              prop_transferidos_I_A_e1,prop_adquiridos_I_A_e1))<span class="co">#create a dataframe with all the values in order to plot them </span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"A"</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_A_e1)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>totales_M_B_e1<span class="ot">=</span><span class="fu">nrow</span>(B_e1_M_def2)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>transferidos_B_e1<span class="ot">=</span><span class="fu">nrow</span>(especif_B1_endo)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_B_e1<span class="ot">=</span>(transferidos_B_e1 <span class="sc">/</span> totales_M_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_B_e1<span class="ot">=</span>((totales_M_B_e1<span class="sc">-</span>transferidos_B_e1) <span class="sc">/</span> totales_M_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>totales_I_B_e1<span class="ot">=</span><span class="fu">nrow</span>(B_e1_I_def2)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_B_e1<span class="ot">=</span>(transferidos_B_e1 <span class="sc">/</span> totales_I_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_B_e1<span class="ot">=</span>((totales_I_B_e1<span class="sc">-</span>transferidos_B_e1) <span class="sc">/</span> totales_I_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_B_e1,prop_perdidos_M_B_e1,</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_B_e1,prop_adquiridos_I_B_e1))</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"B"</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_B_e1)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>A_e1<span class="ot">=</span><span class="fu">ggplot</span>(barras_A_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"South plot (2022)"</span>)<span class="sc">+</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>A_e1</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>B_e1<span class="ot">=</span><span class="fu">ggplot</span>(barras_B_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"South plot (2023)"</span>)<span class="sc">+</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>B_e1</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>p_Plot1<span class="ot">=</span><span class="fu">grid.arrange</span>(A_e1,B_e1,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 1"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>totales_M_A_e2<span class="ot">=</span><span class="fu">nrow</span>(A_e2_M_def2)</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>transferidos_A_e2<span class="ot">=</span><span class="fu">nrow</span>(especif_A2_endo)</span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_A_e2<span class="ot">=</span>(transferidos_A_e2 <span class="sc">/</span> totales_M_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_A_e2<span class="ot">=</span>((totales_M_A_e2<span class="sc">-</span>transferidos_A_e2) <span class="sc">/</span> totales_M_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>totales_I_A_e2<span class="ot">=</span><span class="fu">nrow</span>(A_e2_I_def2)</span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_A_e2<span class="ot">=</span>(transferidos_A_e2 <span class="sc">/</span> totales_I_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_A_e2<span class="ot">=</span>((totales_I_A_e2<span class="sc">-</span>transferidos_A_e2) <span class="sc">/</span> totales_I_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_A_e2,prop_perdidos_M_A_e2,</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_A_e2,prop_adquiridos_I_A_e2))</span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"A"</span></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_A_e2)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>totales_M_B_e2<span class="ot">=</span><span class="fu">nrow</span>(B_e2_M_def2)</span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>transferidos_B_e2<span class="ot">=</span><span class="fu">nrow</span>(especif_B2_endo)</span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_B_e2<span class="ot">=</span>(transferidos_B_e2 <span class="sc">/</span> totales_M_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_B_e2<span class="ot">=</span>((totales_M_B_e2<span class="sc">-</span>transferidos_B_e2) <span class="sc">/</span> totales_M_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>totales_I_B_e2<span class="ot">=</span><span class="fu">nrow</span>(B_e2_I_def2)</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_B_e2<span class="ot">=</span>(transferidos_B_e2 <span class="sc">/</span> totales_I_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_B_e2<span class="ot">=</span>((totales_I_B_e2<span class="sc">-</span>transferidos_B_e2) <span class="sc">/</span> totales_I_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_B_e2,prop_perdidos_M_B_e2,</span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_B_e2,prop_adquiridos_I_B_e2))</span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"B"</span></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_B_e2)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>A_e2<span class="ot">=</span><span class="fu">ggplot</span>(barras_A_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"North plot (2022)"</span>)<span class="sc">+</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb31-150"><a href="#cb31-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb31-151"><a href="#cb31-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a>A_e2</span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a>B_e2<span class="ot">=</span><span class="fu">ggplot</span>(barras_B_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"North plot (2023)"</span>)<span class="sc">+</span></span>
<span id="cb31-160"><a href="#cb31-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb31-161"><a href="#cb31-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb31-162"><a href="#cb31-162" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb31-163"><a href="#cb31-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb31-164"><a href="#cb31-164" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb31-165"><a href="#cb31-165" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb31-166"><a href="#cb31-166" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb31-167"><a href="#cb31-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-168"><a href="#cb31-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb31-169"><a href="#cb31-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb31-170"><a href="#cb31-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-171"><a href="#cb31-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb31-172"><a href="#cb31-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-173"><a href="#cb31-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb31-174"><a href="#cb31-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb31-175"><a href="#cb31-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb31-176"><a href="#cb31-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb31-177"><a href="#cb31-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb31-178"><a href="#cb31-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb31-179"><a href="#cb31-179" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-180"><a href="#cb31-180" aria-hidden="true" tabindex="-1"></a>B_e1</span>
<span id="cb31-181"><a href="#cb31-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-182"><a href="#cb31-182" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb31-183"><a href="#cb31-183" aria-hidden="true" tabindex="-1"></a>p_Plot2<span class="ot">=</span><span class="fu">grid.arrange</span>(A_e2,B_e2,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 2"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With this code a bar plot is created (see Figure 8)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Inheritance.jpg" class="img-fluid figure-img"></p>
<figcaption>Figure 8. Bar plot indicating the transferred ASV, ASVs lost by the mothers, and ASVs acquired from the environment by the suckers</figcaption>
</figure>
</div>
<p>We are going to obtain the same plots but instead of plotting the proportion of ASVs lost, acquired and transferred, the relative abundance of each of them will be visualized</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1<span class="ot">=</span><span class="fu">subset</span>(A_e1_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A1_endo<span class="sc">$</span>ASV_names))<span class="co">#these are the ASVs that mothers lost</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_A_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_A_e1))))<span class="co">#mean relative abundance of each of them</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_A_e1<span class="sc">$</span>Promedio)<span class="co">#sum the relative abundance of all the ASVs lost by the mothers</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1<span class="ot">=</span><span class="fu">subset</span>(A_e1_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A1_endo<span class="sc">$</span>ASV_names))<span class="co">#these are the ASVs that suckers retain from the environment</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_A_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_A_e1))))<span class="co">#mean</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_A_e1<span class="sc">$</span>Promedio)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">19</span>)))<span class="co">#mean relative abundance of transferred ASVs (in mothers samples)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>especif_A1_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A1_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">30</span>)))<span class="co">#mean relative abundance of acquired ASV from mothers (in suckers samples)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>especif_A1_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A1_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>Abund_A1_endo<span class="ot">=</span><span class="fu">c</span>(especif_A1_endo_M_sum,perdidos_M_A_e1_sum,especif_A1_endo_I_sum,adquiridos_I_A_e1_sum)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>barras_abund_A_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_A_e1,Abund_A1_endo))<span class="co">#create a new dataframe with all the data</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_A_e1)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_A_e1),perdidos_M_A_e1),<span class="st">"AbunRel_perdidos_Madre_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_A_e1),adquiridos_I_A_e1),<span class="st">"AbunRel_AdquiridosAmbiente_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A1_endo),especif_A1_endo),<span class="st">"AbunRel_TransferidosMadreHija_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1<span class="ot">=</span><span class="fu">subset</span>(B_e1_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B1_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_B_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_B_e1))))</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_B_e1<span class="sc">$</span>Promedio)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1<span class="ot">=</span><span class="fu">subset</span>(B_e1_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B1_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_B_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_B_e1))))</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_B_e1<span class="sc">$</span>Promedio)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">19</span>)))</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>especif_B1_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B1_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">27</span>)))</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>especif_B1_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B1_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>Abund_B1_endo<span class="ot">=</span><span class="fu">c</span>(especif_B1_endo_M_sum,perdidos_M_B_e1_sum,especif_B1_endo_I_sum,adquiridos_I_B_e1_sum)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>barras_abund_B_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_B_e1,Abund_B1_endo))</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_B_e1)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_B_e1),perdidos_M_B_e1),<span class="st">"AbunRel_perdidos_Madre_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_B_e1),adquiridos_I_B_e1),<span class="st">"AbunRel_AdquiridosAmbiente_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B1_endo),especif_B1_endo),<span class="st">"AbunRel_TransferidosMadreHija_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2022</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2<span class="ot">=</span><span class="fu">subset</span>(A_e2_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_A_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_A_e2))))</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_A_e2<span class="sc">$</span>Promedio)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2<span class="ot">=</span><span class="fu">subset</span>(A_e2_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_A_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_A_e2))))</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_A_e2<span class="sc">$</span>Promedio)</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">20</span>)))</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>especif_A2_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A2_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)))</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>especif_A2_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A2_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>Abund_A2_endo<span class="ot">=</span><span class="fu">c</span>(especif_A2_endo_M_sum,perdidos_M_A_e2_sum,especif_A2_endo_I_sum,adquiridos_I_A_e2_sum)</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>barras_abund_A_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_A_e2,Abund_A2_endo))</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_A_e2)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_A_e2),perdidos_M_A_e2),<span class="st">"AbunRel_perdidos_Madre_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_A_e2),adquiridos_I_A_e2),<span class="st">"AbunRel_AdquiridosAmbiente_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A2_endo),especif_A2_endo),<span class="st">"AbunRel_TransferidosMadreHija_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2<span class="ot">=</span><span class="fu">subset</span>(B_e2_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_B_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_B_e2))))</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_B_e2<span class="sc">$</span>Promedio)</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2<span class="ot">=</span><span class="fu">subset</span>(B_e2_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_B_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_B_e2))))</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_B_e2<span class="sc">$</span>Promedio)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">18</span>)))</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>especif_B2_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B2_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">26</span>)))</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>especif_B2_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B2_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>Abund_B2_endo<span class="ot">=</span><span class="fu">c</span>(especif_B2_endo_M_sum,perdidos_M_B_e2_sum,especif_B2_endo_I_sum,adquiridos_I_B_e2_sum)</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>barras_abund_B_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_B_e2,Abund_B2_endo))</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_B_e2)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_B_e2),perdidos_M_B_e2),<span class="st">"AbunRel_perdidos_Madre_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_B_e2),adquiridos_I_B_e2),<span class="st">"AbunRel_AdquiridosAmbiente_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B2_endo),especif_B2_endo),<span class="st">"AbunRel_TransferidosMadreHija_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>A1_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_A_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 1 (2022)"</span>)<span class="sc">+</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a>A1_abun</span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a>B1_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_B_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 1 (2023)"</span>)<span class="sc">+</span></span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb32-121"><a href="#cb32-121" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb32-122"><a href="#cb32-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>B1_abun</span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a>A2_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_A_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 2 (2022)"</span>)<span class="sc">+</span></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a>A2_abun</span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a>B2_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_B_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 2 (2023)"</span>)<span class="sc">+</span></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-186"><a href="#cb32-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb32-187"><a href="#cb32-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a>B2_abun</span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a>p_abund_p1<span class="ot">=</span><span class="fu">grid.arrange</span>(A1_abun,B1_abun,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 1"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a>p_abund_p2<span class="ot">=</span><span class="fu">grid.arrange</span>(A2_abun,B2_abun,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 2"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="differentially-abundant-taxa" class="level1">
<h1>8. Differentially abundant taxa</h1>
<p>It is interesting to decipher which taxa show statistically significant differences between two groups of samples (i.e., differences in the abundance between mother and suckers plants). For that purpose, we will apply <a href="https://www.nature.com/articles/s41467-020-17041-7" title="ANCOM-BC describing paper">ANCOM-BC approach</a>, especially designed for compositional data. Furthermore, we will use the function <em>ancomloop</em> of the package <em>micro4all</em> in order to compare all groups of samples among them (ANCOM-BC just compares the first group of samples in the dataset with all other groups)</p>
<p>We will apply this statistical test at both phylum and genus levels.</p>
<div class="collout-important">
<p>ANCOM-BC makes a data transformation and applies logarithms, so in this case, we shouldn’t use the normalized abundance. We should use raw phyloseq objects (in which the ASV counts is expressed in absolute abundance)</p>
</div>
<section id="phylum" class="level2">
<h2 class="anchored" data-anchor-id="phylum">8.1 Phylum</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ANCOM_phylum_rizo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> rizo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Phylum"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">###options:</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#grouping: indicate your grouping variable</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#n_cl: the number of cores</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#global: apply the global test (for more information, read this paper: https://www.nature.com/articles/s41467-020-17041-7 and documentation of the function ancombc)</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#struc_zero: remove "structural zeros" (not real zeros but zeros resulting from a wrong sampling procedure)</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#out.unclassified: apply or not the test to unclassified taxa</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#tax.level: indicate the taxonomical level that you want to analyze</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">1</span>]]),ANCOM_phylum_rizo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F) <span class="co">#save the first element of the list, which corresponds to the results obtained from the comparison of the first group of samples with the other groups</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">2</span>]]),ANCOM_phylum_rizo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">3</span>]]),ANCOM_phylum_rizo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">4</span>]]),ANCOM_phylum_rizo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">5</span>]]),ANCOM_phylum_rizo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">6</span>]]),ANCOM_phylum_rizo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">7</span>]]),ANCOM_phylum_rizo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">8</span>]]),ANCOM_phylum_rizo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>ANCOM_phylum_endo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> endo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Phylum"</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">1</span>]]),ANCOM_phylum_endo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">2</span>]]),ANCOM_phylum_endo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">3</span>]]),ANCOM_phylum_endo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">4</span>]]),ANCOM_phylum_endo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">5</span>]]),ANCOM_phylum_endo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">6</span>]]),ANCOM_phylum_endo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">7</span>]]),ANCOM_phylum_endo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">8</span>]]),ANCOM_phylum_endo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this work, we analyzed exhaustively the results in Excel. Pay attention to the column entitled “diff_abbn”, which shows the phyla that were differentially abundant.</p>
</section>
<section id="genus" class="level2">
<h2 class="anchored" data-anchor-id="genus">8.2 Genus</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>ANCOM_genus_rizo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> rizo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Genus"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">1</span>]]),ANCOM_genus_rizo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">2</span>]]),ANCOM_genus_rizo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">3</span>]]),ANCOM_genus_rizo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">4</span>]]),ANCOM_genus_rizo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">5</span>]]),ANCOM_genus_rizo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">6</span>]]),ANCOM_genus_rizo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">7</span>]]),ANCOM_genus_rizo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">8</span>]]),ANCOM_genus_rizo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>endo<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>endo<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>ANCOM_genus_endo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> endo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Genus"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">1</span>]]),ANCOM_genus_endo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">2</span>]]),ANCOM_genus_endo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">3</span>]]),ANCOM_genus_endo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">4</span>]]),ANCOM_genus_endo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">5</span>]]),ANCOM_genus_endo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">6</span>]]),ANCOM_genus_endo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">7</span>]]),ANCOM_genus_endo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">8</span>]]),ANCOM_genus_endo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this work, we analyzed exhaustively the results in Excel. Pay attention to the column entitled “diff_abbn”, which shows the genera that were differentially abundant.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Ecological analyses of bacterial dataset"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">  eval: false</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>Firstly, we have to install and load many packages needed to analyze our bacterial data:</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"ANCOMBC"</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"phyloseq"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"microbiome"</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"GUniFrac"</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"phangorn"</span>)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vegan"</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"gdata"</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"purrr"</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rstatix"</span>)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggstasplot"</span>)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DescTools"</span>)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"WRS2"</span>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ARTool"</span>)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"edgeR"</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"wilkelab/ggtext"</span>) </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"pmartinezarbizu/pairwiseAdonis/pairwiseAdonis"</span>)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"nuriamw/micro4all"</span>)</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ANCOMBC)</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbiome)</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GUniFrac)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gdata)</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ARTool)</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgeR)</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pairwiseAdonis)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(micro4all)</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>Our analyses will based on phyloseq objects. That is to say, we are going to use <span class="co">[</span><span class="ot">phyloseq</span><span class="co">](http://dx.plos.org/10.1371/journal.pone.0061217 "Paper describing phyloseq package")</span> package</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Create a phyloseq object</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>phyloseq object are very useful since they harbor several elements of interest: an ASV (or OTU) table in which the absolute abundance of each ASV is registered, the taxonomy of each ASV (from Domain or Kingdom to ASV level), a metadata table in which a full description of each sample is given, and finally, a phylogenetic tree at ASV level. Thus, lets load all the input files and create the phyloseq object. So, all the above mentioned files should be in our working directory:</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>data<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"ASV_Bacterias_final.txt"</span>, <span class="at">header =</span> T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)<span class="co">#load the ASV table </span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>colnames_data<span class="ot">=</span><span class="fu">colnames</span>(data)</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">"metadata_bacteria.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">header=</span>T)<span class="co">#load the metadata table</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">"2022"</span>, <span class="st">"A"</span>, mt<span class="sc">$</span>Year)<span class="co">#we replaced the number of the years by a character</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">"2023"</span>, <span class="st">"B"</span>, mt<span class="sc">$</span>Year)</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Replicate<span class="ot">=</span><span class="fu">as.character</span>(mt<span class="sc">$</span>Replicate)<span class="co">#convert into characters</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Fusion<span class="ot">=</span><span class="fu">paste0</span>(mt<span class="sc">$</span>Year, <span class="at">sep=</span><span class="st">"_"</span>,mt<span class="sc">$</span>Plot, <span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Condition,<span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Compartment)<span class="co">#here we create a joined artificial variable in order to plot better our samples</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>mt<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">paste0</span>(mt<span class="sc">$</span>Condition,<span class="at">sep=</span><span class="st">"_"</span>, mt<span class="sc">$</span>Year)<span class="co">#the same strategy</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(mt)<span class="ot">=</span>mt<span class="sc">$</span>Sample <span class="co">#the rownames of the metadata table should be identical to the name of the samples</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>::: collout-important</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>The order of the sample is very important! In particular, the order of the samples in the metadata file must be the same as the order of the samples in the ASV table. So, check (and correct it) previously</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>tax <span class="ot">=</span>data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>]<span class="co">#indicate the taxonomy of each ASV: from Domain/Kingdom to ASV level</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>ASV<span class="ot">=</span>data[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(data)]<span class="co">#indicate the ASV counts</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>dna<span class="ot">=</span>Biostrings<span class="sc">::</span><span class="fu">DNAStringSet</span>(data<span class="sc">$</span>ASV_seqs) <span class="co">#save the sequence of each ASV into a variable</span></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dna)<span class="ot">=</span> data<span class="sc">$</span>ASV_names</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(tax)<span class="ot">=</span>data<span class="sc">$</span>ASV_names<span class="co">#the name of each row should be the name of each ASV (i.e., "ASV02156")</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(ASV)<span class="ot">=</span>data<span class="sc">$</span>ASV_names</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(ASV), <span class="fu">rownames</span>(tax))<span class="co">#this is very important and should give "TRUE". Otherwise, review the lines above because there is a mistaker elsewhere</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a>phy_tree<span class="ot">=</span>phyloseq<span class="sc">::</span><span class="fu">read_tree</span>(<span class="st">"tree"</span>)<span class="co">#read the phylogenetic tree. In our case is named "tree"</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>unrooted_tree <span class="ot">=</span> phy_tree</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">is.rooted</span>(unrooted_tree)<span class="co">#if your phylogenetic tree is unrooted, it will give you "FALSE", and in that case, we have uproopt it as following</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>tree_root <span class="ot">=</span> ape<span class="sc">::</span><span class="fu">root</span>(unrooted_tree, <span class="dv">1</span>, <span class="at">resolve.root =</span> T)<span class="co">#calculate the root</span></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>tree_root<span class="co">#it gives you the number of tips and nodes</span></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">is.rooted</span>(tree_root)<span class="co">#check that the tree now is uprooted</span></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert each element into suitable objects for the construction of a phyloseq object</span></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>phy_OTUtable<span class="ot">=</span><span class="fu">otu_table</span>(ASV, <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>phy_taxonomy<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(tax))</span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>phy_metadata<span class="ot">=</span><span class="fu">sample_data</span>(mt) </span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="co">#the tree is already in the proper format</span></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a>phy_data_total<span class="ot">=</span><span class="fu">phyloseq</span>(phy_OTUtable,phy_taxonomy,phy_metadata,tree_root)<span class="co">#bind all the elements into the phyloseq object</span></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a><span class="fu">nsamples</span>(phy_OTUtable); <span class="fu">sum</span>(<span class="fu">sample_names</span>(phy_metadata) <span class="sc">%in%</span> <span class="fu">sample_names</span>(phy_OTUtable)); <span class="fu">nsamples</span>(phy_metadata)<span class="co">#check all the elements have the same number of samples</span></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Data curation</span></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>The phyloseq object is already created, however, we still have to check the quality of the data. For instance, we have to check if all the samples are comprised by enough sequences, and if the sampling and sequencing efforts are enough. For that purpose, we have to check the number of total sequences</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>numsec<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_data_total)))</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(numsec) <span class="co">#order the table in ascending order to check the lowest library size (the sample with the lowest number of sequences)</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>We found that sample **A2M05R** had low number of sequences (8730), so let's remove it from further analyses:</span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a>phy_data_total<span class="ot">=</span><span class="fu">subset_samples</span>(phy_data_total,Sample <span class="sc">!=</span> <span class="st">"A1S04E"</span>) <span class="co">#!= indicates "not equal to", so it means "select all the Samples different to the one we want to remove"</span></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a>Now, it would be interesting to check the quality of the sterilization process. We want to visualize in an ordination plot if rhizosphere and root endosphere samples are separated in the multivariate space. As indicated in the **step 5**, we have to normalize the ASV counts and then, calculate the ordination of the samples and plot them into a multivariate ordination plot:</span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a>todas_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(phy_data_total,<span class="at">taxa_are_rows =</span> T))<span class="co">#obtain the ASV table from the phyloseq object</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a>todas_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_data_total))<span class="co">#obtain the metadata table from the phyloseq object</span></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>todas_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(phy_data_total))<span class="co">#obtain the taxonomy table from the phyloseq object</span></span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a>todas_tree<span class="ot">=</span><span class="fu">phy_tree</span>(phy_data_total)<span class="co">#obtain the phylogenetic tree from the phyloseq object</span></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a><span class="co">#all the previous steps are required to create a new object suitable for edgeR functions</span></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>todas_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> todas_ASV, <span class="at">samples =</span> todas_mt, <span class="at">genes =</span> todas_tax)<span class="co">#Create a DGEList object need for the TMM normalization</span></span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a>todas_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(todas_edgeR)<span class="co">#calculate all the normalization factor so that we can correct potential biases associated to the different librazy sizes (different number of sequences per sample)</span></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a>todas_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(todas_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)<span class="co">#extracting the normalized abundance</span></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a>todas_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(todas_ASV_norm,<span class="at">row.names=</span>F),<span class="at">taxa_are_rows =</span> T)<span class="co">#create the normalized phyloseq elements</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a>todas_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(todas_tax))</span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a>todas_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(todas_mt)</span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(todas_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(todas_phy_taxonomy_norm)<span class="co">#add the name of the taxa</span></span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(todas_ASV_norm), <span class="fu">rownames</span>(todas_tax))<span class="co">#if everything is well calculated, it should give "TRUE"</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>todas_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(todas_phy_OTU_norm,</span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a>                                    todas_phy_taxonomy_norm,</span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a>                                    todas_phy_metadata_norm,</span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>                                    todas_tree)<span class="co">#Create the new phyloseq object, in which the abundance of all the taxa is normalized</span></span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a>One the normalization is done, the plot is made as follows:</span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a>PCOA_wuni<span class="ot">=</span> <span class="fu">ordinate</span>(todas_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)<span class="co">#here we create the ordination plot (PCoA) based on Weighted UniFrac distances</span></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a>peso<span class="ot">=</span>PCOA_wuni<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="co">#save the percentage of the variance explained by each axis into a new variable</span></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a>peso<span class="co">#check the variance explained</span></span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span> <span class="fu">plot_ordination</span>(todas_normalized_phyloseq, PCOA_wuni,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Fusion"</span>,<span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span><span class="co">#indicate the variable of interest (i.e., if you want to color by "Plot", indicate "color=Plot")</span></span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">4.5</span>)<span class="sc">+</span></span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Sample, <span class="at">fontface=</span><span class="st">"bold"</span>), <span class="at">hjust=</span><span class="fl">0.15</span>, <span class="at">vjust=</span><span class="fl">0.15</span>, <span class="at">nudge_y =</span> <span class="fl">0.0075</span>,<span class="at">size=</span><span class="dv">4</span>, <span class="at">show.legend =</span>F) <span class="sc">+</span></span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"2022"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"2023"</span><span class="ot">=</span><span class="dv">17</span>))<span class="sc">+</span><span class="co">#the codes of the specific shapes</span></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtitle</span>(<span class="st">"All the samples</span><span class="sc">\n</span><span class="st">PCoA on Weighted UniFrac dissimilarities"</span>)</span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure1. PCoA based on Weighted UniFrac including all the rhizosphere and root endosphere samples](images/PCoA_todas.jpg)</span>{fig-align="center"}</span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a>As shown in Figure 1, there are some root endosphere samples that are closer than rhizosphere samples than other root endosphere samples. Thus, we consider that these roots were not properly sterilized. We should remove them because we are not aware of their origin</span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a>This, we have to curate our dataset, and remove all these samples:</span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a>phy_total<span class="ot">=</span><span class="fu">subset_samples</span>(phy_data_total, </span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a>                         Sample <span class="sc">!=</span> <span class="st">"A1S04E"</span>  <span class="sc">&amp;</span> </span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a>                           Sample<span class="sc">!=</span> <span class="st">"A1M01E"</span><span class="sc">&amp;</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span> <span class="st">"A2S09E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"A2S12E"</span><span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"A2S08E"</span> <span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"A2S01E"</span><span class="sc">&amp;</span></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B1S03E"</span><span class="sc">&amp;</span> Sample <span class="sc">!=</span> <span class="st">"B1S06E"</span><span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"B1S09E"</span><span class="sc">&amp;</span> Sample<span class="sc">!=</span><span class="st">"B1S10E"</span><span class="sc">&amp;</span></span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B1M12E"</span><span class="sc">&amp;</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span> <span class="st">"B2S06E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S11E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S07E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2S02E"</span> <span class="sc">&amp;</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a>                           Sample <span class="sc">!=</span><span class="st">"B2M08E"</span> <span class="sc">&amp;</span> Sample <span class="sc">!=</span><span class="st">"B2M03E"</span>)</span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a>numsec_pruned<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total)))</span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a>numASV_pruned<span class="ot">=</span><span class="fu">as.data.frame</span>((<span class="fu">otu_table</span>(phy_total)))</span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(numsec_pruned),numsec_pruned),<span class="at">file=</span><span class="st">"Numero_secuencias_deTrabajo.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#save the table with the number of total sequences per sample</span></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(numASV_pruned),numASV_pruned),<span class="at">file=</span><span class="st">"Numero_ASVs_deTrabajo.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#save the table with the number of total ASVs</span></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Rarefaction curves</span></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a>We still have to check whether the sequencing effort has been enough, so let's have a look at rarefaction curves. They are the best way to visualize the quality of the sequencing and sampling.</span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a>In our case, we should visualize the rarefaction curves by plant compartment, to check whether the data curation was made well</span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(phy_total))<span class="co">#calculate the smallest library size</span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_total)))]<span class="co">#check which is the sample with the smallest library size </span></span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_total))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_total)))),<span class="at">decreasing=</span>F),]<span class="co">#obtain the metadata table</span></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">otu_table</span>(phy_total)))<span class="co">#obtain the ASV table and traspose it</span></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Compartment)</span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)<span class="co">#we are creating a new column so that then we can plot based on the plant compartment (or based on other variable)</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a>out <span class="ot">=</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) <span class="co">#calculate the rarefaction</span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">=</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a>})<span class="co">#this function is to create a table from the rarefaction variable</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">=</span> sample_names</span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">=</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Compartment<span class="ot">=</span>rare<span class="sc">$</span>Sample <span class="co">#these lines aimed at creating a new column in which the information needed for the plotting is included. You should include here the factor that determines the color of the curves</span></span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Compartment<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Compartment)<span class="co">#replace all the text before "/"</span></span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a>p_endo_rizo<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Compartment, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Compartment), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Compartment),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(phy_total))), </span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Endosphere"</span><span class="ot">=</span><span class="st">"black"</span>,<span class="st">"Rhizosphere"</span><span class="ot">=</span><span class="st">"#66CC33"</span>))<span class="sc">+</span></span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Endosphere"</span><span class="ot">=</span><span class="st">"black"</span>, <span class="st">"Rhizosphere"</span><span class="ot">=</span><span class="st">"#66CC33"</span>),</span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Compartment"</span>,</span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Endosphere"</span>, <span class="st">"Rhizosphere"</span>),</span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Endosphere"</span>, <span class="st">"Rhizosphere"</span>))<span class="sc">+</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"All the samples"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a>p_endo_rizo</span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a>Now yes, we will create rarefaction curves. But we have to split the data according to the orchards, otherwise it will be really difficult to understand the graphs. So, let's subset the data according to our experimental design. We will create new phyloseq objects: two per plant compartment, corresponding to each orchard or plot.</span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a>rizo1<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Rhizosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span><span class="st">"Plot1"</span>)</span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a>rizo1<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(rizo1)<span class="sc">&gt;</span><span class="fl">0.0</span>, rizo1)<span class="co">#</span></span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a>rizo2<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Rhizosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span> <span class="st">"Plot2"</span>)</span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a>rizo2<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(rizo2)<span class="sc">&gt;</span><span class="fl">0.0</span>, rizo2)</span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a>endo1<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span><span class="st">"Plot1"</span>)</span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a>endo1<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo1)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo1)</span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a>endo2<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span> <span class="sc">&amp;</span> Plot<span class="sc">==</span> <span class="st">"Plot2"</span>)</span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a>endo2<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo2)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo2)</span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a>Now, calculate and plot the rarefaction curves:</span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1))</span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo1)))] </span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(rizo1)</span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt) </span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)<span class="co">#we want to color in different colors mothers and suckers, and also the samples taken in each year</span></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a>p_rizo1<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1))), </span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>))<span class="sc">+</span></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>),</span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Rhizosphere; Plot 1"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a>p_rizo1</span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot2</span></span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2)) </span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rizo2)))] </span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(rizo2)</span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){ </span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>p_rizo2<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2))), </span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>),</span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Rhizosphere; Plot 2"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a>p_rizo2</span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a><span class="co">#ENDOSPHERE SAMPLES:</span></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1)) </span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo1)))] </span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(endo1)</span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){  </span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb35-449"><a href="#cb35-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-450"><a href="#cb35-450" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample</span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>p_endo1<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1))), </span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>))<span class="sc">+</span></span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#00FFCC"</span>,</span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#6600CC"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"magenta"</span>),</span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Endosphere; Plot 1"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a>p_endo1</span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot2</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2))</span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(endo2)))] </span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2))[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2)))),<span class="at">decreasing=</span>F),]</span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">otu_table</span>(endo2)</span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a>otu <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(otu))</span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a>otu<span class="ot">=</span>otu[<span class="fu">order</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(otu)),<span class="at">decreasing=</span><span class="cn">FALSE</span>),]</span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="sc">==</span><span class="fu">rownames</span>(mt)</span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(otu)<span class="ot">=</span><span class="fu">paste0</span>(<span class="fu">rownames</span>(otu),<span class="st">"/"</span>,mt<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a>sample_names <span class="ot">=</span> <span class="fu">rownames</span>(otu)</span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rarecurve</span>(otu, <span class="at">step =</span> <span class="dv">100</span>, <span class="at">label =</span> F) </span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">lapply</span>(out, <span class="cf">function</span>(x){</span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(x)</span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ASV =</span> b[,<span class="dv">1</span>], <span class="at">raw.read =</span> <span class="fu">rownames</span>(b))</span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a>  b<span class="sc">$</span>raw.read <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"N"</span>, <span class="st">""</span>,  b<span class="sc">$</span>raw.read))</span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rare) <span class="ot">&lt;-</span> sample_names</span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>rare <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(rare, <span class="cf">function</span>(x){</span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span>rare<span class="sc">$</span>Sample </span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>Condition_Year<span class="ot">=</span><span class="fu">gsub</span>(<span class="st">".*/"</span>, <span class="st">""</span>, rare<span class="sc">$</span>Condition_Year)</span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>rare<span class="sc">$</span>raw.read<span class="ot">=</span><span class="fu">as.numeric</span>(rare<span class="sc">$</span>raw.read)</span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>p_endo2<span class="ot">=</span><span class="fu">ggplot</span>(rare, <span class="fu">aes</span>(<span class="at">x=</span>raw.read, <span class="at">y=</span>ASV, <span class="at">colour=</span>Condition_Year, <span class="at">group=</span>Sample)) <span class="sc">+</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year), <span class="at">size=</span><span class="fl">0.85</span>)<span class="sc">+</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>Condition_Year),<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2))), </span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a>             <span class="at">lty=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature_A"</span><span class="ot">=</span><span class="st">"#FF0000"</span>, <span class="st">"Mature_A"</span><span class="ot">=</span><span class="st">"#FF9999"</span>,</span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Immature_B"</span><span class="ot">=</span><span class="st">"#993300"</span> ,<span class="st">"Mature_B"</span><span class="ot">=</span><span class="st">"black"</span>),</span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name=</span><span class="st">"Condition (sampling year)"</span>,</span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature_A"</span>, <span class="st">"Mature_A"</span>,</span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Immature_B"</span> ,<span class="st">"Mature_B"</span>),</span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers (2022)"</span>, <span class="st">"Mothers (2022)"</span>,</span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Suckers (2023)"</span>,<span class="st">"Mothers (2023)"</span>))<span class="sc">+</span></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Endosphere; Plot 2"</span>, <span class="at">x=</span><span class="st">"Number of sequences"</span>, <span class="at">y=</span><span class="st">"Number of ASV"</span>)<span class="sc">+</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">alpha=</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.85</span>,</span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>p_endo2</span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a>As shown in Figures 2-5, at the same rarefaction levels, most of the samples reached to the asymptote, so the sequencing effort can be considered enough. Furthermore, no clear patterns of richnes can be deduced from the rarefaction curves</span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure 2. Rarefaction curves corresponding to rhizosphere samples of the south plot (also named "Plot 1").](images/Rarefacc_rizo1.jpeg)</span>{fig-align="center" width="700"} <span class="al">![Figure 3. Rarefaction curves corresponding to rhizosphere samples of the north plot (also named "Plot 2").](images/Rarefacc_rizo2.jpeg)</span>{fig-align="center" width="700"} <span class="al">![Figure 4. Rarefaction curves corresponding to root endosphere samples of the south plot (also named "Plot 1").](images/Rarefacc_endo1.jpeg)</span>{fig-align="center" width="700"} <span class="al">![Figure 5. Rarefaction curves corresponding to root endosphere samples of the north plot (also named "Plot 2").](images/Rarefacc_endo2.jpeg)</span>{fig-align="center" width="700"}</span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Alpha diversity analysis</span></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a>We are going to estimate the richness, diversity and evenness of each sample by calculating the number of observed ASVs, and Shannon's and Inverse of Simpson and Pielou's indices, respectively.</span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a>Some alpha diversity indices are sensitive to different library sizes, so first, we will rarefy all the samples to the smallest library size to avoid potential biases associated to different number of sequences.</span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a>It should be made a rarefaction per groups of samples to be compared. For instance, if we want to compare the diversity of rhizosphere bacterial communitites of Mother and Suckers plants located in the south plot, we should calculate the rarefaction level corresponding to the subgroup of Rhizosphere samples of the south plot (namely, object *rizo1*). And then, rarefy to the smallest library size of the samples included in the object *rizo1*.</span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a><span class="co">#a) Endosphere samples</span></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a>rarefac_endo1<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(endo1, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo1)),<span class="at">rngseed=</span>T)<span class="co">#rarefaction. You can indicate manually the minimum sample size or by using the function "min"</span></span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_endo1) <span class="co">#check that now all the samples have the same number of sequences</span></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo1)))]</span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_endo1, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))<span class="co">#calculate the indices</span></span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Pielou<span class="ot">=</span>indices_endo1<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_endo1<span class="sc">$</span>Observed)<span class="co">#calculated manually the Pielou index</span></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_endo1))<span class="sc">==</span><span class="fu">row.names</span>(indices_endo1)</span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a>mt_indices_endo1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_endo1))<span class="co">#extract the metadata</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="ot">=</span><span class="fu">add_column</span>(indices_endo1, mt_indices_endo1[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_endo1)], <span class="at">.before =</span> <span class="st">"Observed"</span>)<span class="co">#add the metadata to the indices table, before the column named "Observed"</span></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_endo1),indices_endo1),<span class="at">file=</span><span class="st">"Indices_Endo_Plot1_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a><span class="co">#We have already calculated the indices per replicates but we are interested in the mean and standard values per groups of samples, so let's calculate them:</span></span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a>media_endo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo1<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)<span class="co">#be careful. Here you have to indicate the position of the columns where the values of the indices are placed</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a>sd_endo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo1<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ <span class="co">#be careful with the position of the numeric values (alpha indices)</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_endo1[,i], <span class="st">" +/- "</span>, sd_endo1[,i]))}<span class="co">#then in Excel you can replace "+/-" by the corresponding symbol</span></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_endo1 <span class="ot">=</span> <span class="fu">cbind</span>(media_endo1<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_endo1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_endo1)</span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_endo1,<span class="at">file=</span><span class="st">"Indices_media_sd_Endo_Plot1.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)<span class="co">#this table shows the mean +/- sd of the indices for each group of samples. Ready for publication</span></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a>rarefac_endo2<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(endo2, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(endo2)),<span class="at">rngseed=</span>T)</span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_endo2)</span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_endo2)))]</span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_endo2, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Pielou<span class="ot">=</span>indices_endo2<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_endo2<span class="sc">$</span>Observed)</span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_endo2))<span class="sc">==</span><span class="fu">row.names</span>(indices_endo2)</span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a>mt_indices_endo2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_endo2))</span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="ot">=</span><span class="fu">add_column</span>(indices_endo2, mt_indices_endo2[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_endo2)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_endo2),indices_endo2),<span class="at">file=</span><span class="st">"Indices_Endo_Plot2_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a>media_endo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo2<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a>sd_endo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_endo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_endo2<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ </span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_endo2[,i], <span class="st">" +/- "</span>, sd_endo2[,i]))}</span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_endo2 <span class="ot">=</span> <span class="fu">cbind</span>(media_endo2<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_endo2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_endo2)</span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_endo2,<span class="at">file=</span><span class="st">"Indices_media_sd_Endo_Plot2.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a><span class="co">#b) Rhizosphere</span></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a>rarefac_rizo1<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(rizo1, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo1)),<span class="at">rngseed=</span>T)</span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_rizo1) </span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo1))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo1)))]</span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-621"><a href="#cb35-621" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_rizo1, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb35-622"><a href="#cb35-622" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Pielou<span class="ot">=</span>indices_rizo1<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_rizo1<span class="sc">$</span>Observed)</span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-624"><a href="#cb35-624" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_rizo1))<span class="sc">==</span><span class="fu">row.names</span>(indices_rizo1)</span>
<span id="cb35-625"><a href="#cb35-625" aria-hidden="true" tabindex="-1"></a>mt_indices_rizo1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_rizo1))</span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="ot">=</span><span class="fu">add_column</span>(indices_rizo1, mt_indices_rizo1[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_rizo1)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_rizo1),indices_rizo1),<span class="at">file=</span><span class="st">"Indices_rizo_Plot1_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-631"><a href="#cb35-631" aria-hidden="true" tabindex="-1"></a>media_rizo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo1<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-632"><a href="#cb35-632" aria-hidden="true" tabindex="-1"></a>sd_rizo1<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo1[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo1<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-633"><a href="#cb35-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ <span class="co">#OJO aqui con el numero de las columnas numericas</span></span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_rizo1[,i], <span class="st">" +/- "</span>, sd_rizo1[,i]))}</span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_rizo1 <span class="ot">=</span> <span class="fu">cbind</span>(media_rizo1<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_rizo1) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_rizo1)</span>
<span id="cb35-641"><a href="#cb35-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-642"><a href="#cb35-642" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_rizo1,<span class="at">file=</span><span class="st">"Indices_media_sd_rizo_Plot1.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-643"><a href="#cb35-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-644"><a href="#cb35-644" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-645"><a href="#cb35-645" aria-hidden="true" tabindex="-1"></a>rarefac_rizo2<span class="ot">=</span><span class="fu">rarefy_even_depth</span>(rizo2, <span class="at">sample.size =</span> <span class="fu">min</span>(<span class="fu">sample_sums</span>(rizo2)),<span class="at">rngseed=</span>T)</span>
<span id="cb35-646"><a href="#cb35-646" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sums</span>(rarefac_rizo2) </span>
<span id="cb35-647"><a href="#cb35-647" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo2))[<span class="fu">which.min</span>(<span class="fu">colSums</span>(<span class="fu">otu_table</span>(rarefac_rizo2)))]</span>
<span id="cb35-648"><a href="#cb35-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-649"><a href="#cb35-649" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="ot">=</span><span class="fu">estimate_richness</span>(rarefac_rizo2, <span class="at">measures=</span><span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Shannon"</span>))</span>
<span id="cb35-650"><a href="#cb35-650" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Pielou<span class="ot">=</span>indices_rizo2<span class="sc">$</span>Shannon<span class="sc">/</span><span class="fu">log</span>(indices_rizo2<span class="sc">$</span>Observed)</span>
<span id="cb35-651"><a href="#cb35-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-652"><a href="#cb35-652" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(<span class="fu">sample_data</span>(rarefac_rizo2))<span class="sc">==</span><span class="fu">row.names</span>(indices_rizo2)</span>
<span id="cb35-653"><a href="#cb35-653" aria-hidden="true" tabindex="-1"></a>mt_indices_rizo2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rarefac_rizo2))</span>
<span id="cb35-654"><a href="#cb35-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-655"><a href="#cb35-655" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="ot">=</span><span class="fu">add_column</span>(indices_rizo2, mt_indices_rizo2[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mt_indices_rizo2)], <span class="at">.before =</span> <span class="st">"Observed"</span>)</span>
<span id="cb35-656"><a href="#cb35-656" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">" "</span><span class="ot">=</span><span class="fu">rownames</span>(indices_rizo2),indices_rizo2),<span class="at">file=</span><span class="st">"Indices_rizo_Plot2_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-657"><a href="#cb35-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-658"><a href="#cb35-658" aria-hidden="true" tabindex="-1"></a>media_rizo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo2<span class="sc">$</span>Condition_Year), mean)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-659"><a href="#cb35-659" aria-hidden="true" tabindex="-1"></a>sd_rizo2<span class="ot">=</span><span class="fu">aggregate</span>(indices_rizo2[,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>], <span class="fu">list</span>(<span class="at">grouping=</span>indices_rizo2<span class="sc">$</span>Condition_Year), sd)<span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb35-660"><a href="#cb35-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-661"><a href="#cb35-661" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb35-662"><a href="#cb35-662" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>){ </span>
<span id="cb35-663"><a href="#cb35-663" aria-hidden="true" tabindex="-1"></a>  mean_sd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mean_sd,<span class="fu">paste0</span>(media_rizo2[,i], <span class="st">" +/- "</span>, sd_rizo2[,i]))}</span>
<span id="cb35-664"><a href="#cb35-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-665"><a href="#cb35-665" aria-hidden="true" tabindex="-1"></a>tabla_publicaciones_rizo2 <span class="ot">=</span> <span class="fu">cbind</span>(media_rizo2<span class="sc">$</span>grouping, mean_sd)</span>
<span id="cb35-666"><a href="#cb35-666" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla_publicaciones_rizo2) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Group"</span>,<span class="st">"Observed"</span>, <span class="st">"Shannon"</span>, <span class="st">"InvSimpson"</span>, <span class="st">"Pielou"</span>)</span>
<span id="cb35-667"><a href="#cb35-667" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(tabla_publicaciones_rizo2)</span>
<span id="cb35-668"><a href="#cb35-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-669"><a href="#cb35-669" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(tabla_publicaciones_rizo2,<span class="at">file=</span><span class="st">"Indices_media_sd_rizo_Plot2.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-670"><a href="#cb35-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-671"><a href="#cb35-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-672"><a href="#cb35-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-673"><a href="#cb35-673" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Statistical analysis</span></span>
<span id="cb35-674"><a href="#cb35-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-675"><a href="#cb35-675" aria-hidden="true" tabindex="-1"></a>We have just calculated the alpha indices per sample and per group of samples, but we have to compare them among group of samples. For that purpose, we will apply univariate statistic test. We will go into different steps, which briefly consist of:</span>
<span id="cb35-676"><a href="#cb35-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-677"><a href="#cb35-677" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Check the normality of the data**: we have to confirm whether our variables follow a normal distribution. If they are not normally distributed, we will also check if they are very far from the normal distribution.</span>
<span id="cb35-678"><a href="#cb35-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-679"><a href="#cb35-679" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Check the homoscedasticity of the data**: confirm if dispersion of the variable is the same in all the groups of samples to compare. If the distribution of the variables is normal (or almost normal) and there is homogeneity of variances, we will apply parametric tests. Otherwise, we will use non-parametric tests.</span>
<span id="cb35-680"><a href="#cb35-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-681"><a href="#cb35-681" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Check the presence of the outliers**. Outliers are not a problem, but we have to check if they are extreme outliers. In that case, we will apply robust tests</span>
<span id="cb35-682"><a href="#cb35-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-683"><a href="#cb35-683" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Apply the proper statistical test.** Depending on the characteristics of the variables and the experimental design (one factor to be studied: one-way statistics; two factors: two-way statistical tests).</span>
<span id="cb35-684"><a href="#cb35-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-685"><a href="#cb35-685" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Calculate the size of the effect**. In case we find statistical differences among groups of samples in the studied variables, we have to measure the magnitude of the effect.</span>
<span id="cb35-686"><a href="#cb35-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-687"><a href="#cb35-687" aria-hidden="true" tabindex="-1"></a>We have to study separately each individual variable (in this case, each alpha diversity index).</span>
<span id="cb35-688"><a href="#cb35-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-689"><a href="#cb35-689" aria-hidden="true" tabindex="-1"></a>In this example, we are interested in two factors: the effect of the sampling year, and the effect of the plants' developmental stage, also named *Condition* in this web</span>
<span id="cb35-690"><a href="#cb35-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-693"><a href="#cb35-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-694"><a href="#cb35-694" aria-hidden="true" tabindex="-1"></a><span class="co">#a) ENDOSPHERE</span></span>
<span id="cb35-695"><a href="#cb35-695" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-696"><a href="#cb35-696" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb35-697"><a href="#cb35-697" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb35-698"><a href="#cb35-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="co">#</span></span>
<span id="cb35-699"><a href="#cb35-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-700"><a href="#cb35-700" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-701"><a href="#cb35-701" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb35-702"><a href="#cb35-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-703"><a href="#cb35-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-704"><a href="#cb35-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-705"><a href="#cb35-705" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb35-706"><a href="#cb35-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-707"><a href="#cb35-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)<span class="co">#data are not normally distributed</span></span>
<span id="cb35-708"><a href="#cb35-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-709"><a href="#cb35-709" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span></span>
<span id="cb35-710"><a href="#cb35-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-711"><a href="#cb35-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-712"><a href="#cb35-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-713"><a href="#cb35-713" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()<span class="co">#let's see how far are our data from the normal distribution into a qq-plot.</span></span>
<span id="cb35-714"><a href="#cb35-714" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-715"><a href="#cb35-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-716"><a href="#cb35-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-717"><a href="#cb35-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-718"><a href="#cb35-718" aria-hidden="true" tabindex="-1"></a>As shown in Figure 6, just one point is far from the normal distribution, so we can still applied parametric data is homoscedasticity hypothesis is met.</span>
<span id="cb35-719"><a href="#cb35-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-720"><a href="#cb35-720" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure 6. QQplot showing distribution of the InvSimpson corresponding to root endosphere samples f plants located in the south plot](images/graficoQQ_InvSimpson_endo1.jpeg)</span>{fig-align="center"}</span>
<span id="cb35-721"><a href="#cb35-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-724"><a href="#cb35-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-725"><a href="#cb35-725" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-726"><a href="#cb35-726" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-727"><a href="#cb35-727" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-728"><a href="#cb35-728" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-729"><a href="#cb35-729" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-730"><a href="#cb35-730" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-731"><a href="#cb35-731" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-732"><a href="#cb35-732" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span>  <span class="fu">identify_outliers</span>(Observed);<span class="fu">View</span>(a)</span>
<span id="cb35-733"><a href="#cb35-733" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb35-734"><a href="#cb35-734" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb35-735"><a href="#cb35-735" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span> <span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb35-736"><a href="#cb35-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-737"><a href="#cb35-737" aria-hidden="true" tabindex="-1"></a><span class="co">#Hypothesis contrasting tests</span></span>
<span id="cb35-738"><a href="#cb35-738" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Condition <span class="sc">*</span> Year)<span class="co">#two-way ANOVA because our data are homoscedatic</span></span>
<span id="cb35-739"><a href="#cb35-739" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-740"><a href="#cb35-740" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-741"><a href="#cb35-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-742"><a href="#cb35-742" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Condition)<span class="co">#robust test because Invesrse of Simpson have extreme outliers</span></span>
<span id="cb35-743"><a href="#cb35-743" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Year)</span>
<span id="cb35-744"><a href="#cb35-744" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_endo1)</span>
<span id="cb35-745"><a href="#cb35-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-746"><a href="#cb35-746" aria-hidden="true" tabindex="-1"></a><span class="co">#We did not find the interaction between Year and plant developmental Condition significant in any of the variables studied, but the effect of Year or Condition (or both) was statistaclly significant on some of the indices. In that case, we have to study the effect of each factor individually:</span></span>
<span id="cb35-747"><a href="#cb35-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-748"><a href="#cb35-748" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc tests</span></span>
<span id="cb35-749"><a href="#cb35-749" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Observed<span class="sc">~</span>Year)</span>
<span id="cb35-750"><a href="#cb35-750" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Shannon<span class="sc">~</span>Year)</span>
<span id="cb35-751"><a href="#cb35-751" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Condition)</span>
<span id="cb35-752"><a href="#cb35-752" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Year)</span>
<span id="cb35-753"><a href="#cb35-753" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Condition)</span>
<span id="cb35-754"><a href="#cb35-754" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo1<span class="sc">$</span>Year)</span>
<span id="cb35-755"><a href="#cb35-755" aria-hidden="true" tabindex="-1"></a><span class="fu">mcp2atm</span>(InvSimpson<span class="sc">~</span>Year<span class="sc">*</span>Condition, <span class="at">data=</span>indices_endo1) <span class="co">#the robust post-hoc test</span></span>
<span id="cb35-756"><a href="#cb35-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-757"><a href="#cb35-757" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-758"><a href="#cb35-758" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb35-759"><a href="#cb35-759" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb35-760"><a href="#cb35-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-761"><a href="#cb35-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-762"><a href="#cb35-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-763"><a href="#cb35-763" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb35-764"><a href="#cb35-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-765"><a href="#cb35-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-766"><a href="#cb35-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-767"><a href="#cb35-767" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb35-768"><a href="#cb35-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-769"><a href="#cb35-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-770"><a href="#cb35-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-771"><a href="#cb35-771" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb35-772"><a href="#cb35-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-773"><a href="#cb35-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-774"><a href="#cb35-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-775"><a href="#cb35-775" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-776"><a href="#cb35-776" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-777"><a href="#cb35-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-778"><a href="#cb35-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-779"><a href="#cb35-779" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-780"><a href="#cb35-780" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-781"><a href="#cb35-781" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-782"><a href="#cb35-782" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-783"><a href="#cb35-783" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-784"><a href="#cb35-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-785"><a href="#cb35-785" aria-hidden="true" tabindex="-1"></a><span class="co">#outliers</span></span>
<span id="cb35-786"><a href="#cb35-786" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-787"><a href="#cb35-787" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb35-788"><a href="#cb35-788" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb35-789"><a href="#cb35-789" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb35-790"><a href="#cb35-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-791"><a href="#cb35-791" aria-hidden="true" tabindex="-1"></a><span class="co">#two-way tests </span></span>
<span id="cb35-792"><a href="#cb35-792" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Condition <span class="sc">*</span> Year)<span class="co">#two way ANOVA</span></span>
<span id="cb35-793"><a href="#cb35-793" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-794"><a href="#cb35-794" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Condition)</span>
<span id="cb35-795"><a href="#cb35-795" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Year)</span>
<span id="cb35-796"><a href="#cb35-796" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_endo2)<span class="co">#robust test</span></span>
<span id="cb35-797"><a href="#cb35-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-798"><a href="#cb35-798" aria-hidden="true" tabindex="-1"></a><span class="co">#The dispersion of the Pielou index for both groups of samples is not homogeneous, so we cannot compute parametric tests. However, there are not suitable options for non-parametric two-way tests. Let's make a data transformation according to this tutorial.http://depts.washington.edu/acelab/proj/art/index.html</span></span>
<span id="cb35-799"><a href="#cb35-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-800"><a href="#cb35-800" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Condition)</span>
<span id="cb35-801"><a href="#cb35-801" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_endo2<span class="sc">$</span>Year)</span>
<span id="cb35-802"><a href="#cb35-802" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">art</span>(Observed <span class="sc">~</span> Year <span class="sc">*</span> Condition, <span class="at">data=</span>indices_endo2) <span class="co"># linear model syntax; see lm()</span></span>
<span id="cb35-803"><a href="#cb35-803" aria-hidden="true" tabindex="-1"></a>mm<span class="ot">=</span><span class="fu">anova</span>(m)</span>
<span id="cb35-804"><a href="#cb35-804" aria-hidden="true" tabindex="-1"></a><span class="fu">eta_squared</span>(mm)</span>
<span id="cb35-805"><a href="#cb35-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-806"><a href="#cb35-806" aria-hidden="true" tabindex="-1"></a><span class="co">#B) RHIZOSPHERE</span></span>
<span id="cb35-807"><a href="#cb35-807" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-808"><a href="#cb35-808" aria-hidden="true" tabindex="-1"></a><span class="co">#normality</span></span>
<span id="cb35-809"><a href="#cb35-809" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb35-810"><a href="#cb35-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-811"><a href="#cb35-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-812"><a href="#cb35-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-813"><a href="#cb35-813" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb35-814"><a href="#cb35-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-815"><a href="#cb35-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-816"><a href="#cb35-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-817"><a href="#cb35-817" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb35-818"><a href="#cb35-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-819"><a href="#cb35-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-820"><a href="#cb35-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-821"><a href="#cb35-821" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span></span>
<span id="cb35-822"><a href="#cb35-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-823"><a href="#cb35-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-824"><a href="#cb35-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-825"><a href="#cb35-825" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-826"><a href="#cb35-826" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-827"><a href="#cb35-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-828"><a href="#cb35-828" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-829"><a href="#cb35-829" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-830"><a href="#cb35-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-831"><a href="#cb35-831" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-832"><a href="#cb35-832" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Pielou"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-833"><a href="#cb35-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-834"><a href="#cb35-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-835"><a href="#cb35-835" aria-hidden="true" tabindex="-1"></a><span class="co">#Homocesdasticity</span></span>
<span id="cb35-836"><a href="#cb35-836" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-837"><a href="#cb35-837" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-838"><a href="#cb35-838" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-839"><a href="#cb35-839" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-840"><a href="#cb35-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-841"><a href="#cb35-841" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-842"><a href="#cb35-842" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-843"><a href="#cb35-843" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon); <span class="fu">View</span>(b)</span>
<span id="cb35-844"><a href="#cb35-844" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb35-845"><a href="#cb35-845" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb35-846"><a href="#cb35-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-847"><a href="#cb35-847" aria-hidden="true" tabindex="-1"></a><span class="co">#we found that Observed and InvSimpson have extremo outliers. We should check wether applying robust methods we maintain the homoscedasticity of the data</span></span>
<span id="cb35-848"><a href="#cb35-848" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb35-849"><a href="#cb35-849" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  <span class="co">#remove the 10% of the data (in one tail)</span></span>
<span id="cb35-850"><a href="#cb35-850" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span><span class="co">#remove the 10% of the data (in the other tail)</span></span>
<span id="cb35-851"><a href="#cb35-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Year<span class="sc">*</span>Plot)<span class="co">#still homoscedastic</span></span>
<span id="cb35-852"><a href="#cb35-852" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb35-853"><a href="#cb35-853" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>), </span>
<span id="cb35-854"><a href="#cb35-854" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-855"><a href="#cb35-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Year<span class="sc">*</span>Plot)<span class="co">#still homoscedastic</span></span>
<span id="cb35-856"><a href="#cb35-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-857"><a href="#cb35-857" aria-hidden="true" tabindex="-1"></a><span class="co">#two-way tests</span></span>
<span id="cb35-858"><a href="#cb35-858" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Condition)</span>
<span id="cb35-859"><a href="#cb35-859" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Year)</span>
<span id="cb35-860"><a href="#cb35-860" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb35-861"><a href="#cb35-861" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-862"><a href="#cb35-862" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb35-863"><a href="#cb35-863" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-864"><a href="#cb35-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-865"><a href="#cb35-865" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc:</span></span>
<span id="cb35-866"><a href="#cb35-866" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo1<span class="sc">$</span>Year)</span>
<span id="cb35-867"><a href="#cb35-867" aria-hidden="true" tabindex="-1"></a><span class="fu">mcp2atm</span>(Observed<span class="sc">~</span>Year<span class="sc">*</span>Condition, <span class="at">data=</span>indices_rizo1)<span class="co">#robust test</span></span>
<span id="cb35-868"><a href="#cb35-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-869"><a href="#cb35-869" aria-hidden="true" tabindex="-1"></a><span class="co">#effect size</span></span>
<span id="cb35-870"><a href="#cb35-870" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">lm</span>(Observed<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo1)</span>
<span id="cb35-871"><a href="#cb35-871" aria-hidden="true" tabindex="-1"></a><span class="fu">eta_squared</span>(x) </span>
<span id="cb35-872"><a href="#cb35-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-873"><a href="#cb35-873" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-874"><a href="#cb35-874" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb35-875"><a href="#cb35-875" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb35-876"><a href="#cb35-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-877"><a href="#cb35-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-878"><a href="#cb35-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-879"><a href="#cb35-879" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb35-880"><a href="#cb35-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-881"><a href="#cb35-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-882"><a href="#cb35-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-883"><a href="#cb35-883" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb35-884"><a href="#cb35-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-885"><a href="#cb35-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-886"><a href="#cb35-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-887"><a href="#cb35-887" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span></span>
<span id="cb35-888"><a href="#cb35-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span></span>
<span id="cb35-889"><a href="#cb35-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-890"><a href="#cb35-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-891"><a href="#cb35-891" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-892"><a href="#cb35-892" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-893"><a href="#cb35-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Condition <span class="sc">~</span> Year)</span>
<span id="cb35-894"><a href="#cb35-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-895"><a href="#cb35-895" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-896"><a href="#cb35-896" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-897"><a href="#cb35-897" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-898"><a href="#cb35-898" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-899"><a href="#cb35-899" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Condition<span class="sc">*</span>Year)</span>
<span id="cb35-900"><a href="#cb35-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-901"><a href="#cb35-901" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-902"><a href="#cb35-902" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition,Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-903"><a href="#cb35-903" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b) </span>
<span id="cb35-904"><a href="#cb35-904" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson);<span class="fu">View</span>(c)</span>
<span id="cb35-905"><a href="#cb35-905" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Condition, Year)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou);<span class="fu">View</span>(d)</span>
<span id="cb35-906"><a href="#cb35-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-907"><a href="#cb35-907" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the possibility to apply robust tests</span></span>
<span id="cb35-908"><a href="#cb35-908" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> </span>
<span id="cb35-909"><a href="#cb35-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb35-910"><a href="#cb35-910" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  </span>
<span id="cb35-911"><a href="#cb35-911" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-912"><a href="#cb35-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Year<span class="sc">*</span>Condition)</span>
<span id="cb35-913"><a href="#cb35-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-914"><a href="#cb35-914" aria-hidden="true" tabindex="-1"></a><span class="co">#tests</span></span>
<span id="cb35-915"><a href="#cb35-915" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo2<span class="sc">$</span>Condition)</span>
<span id="cb35-916"><a href="#cb35-916" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">$</span>Year<span class="ot">=</span><span class="fu">as.factor</span>(indices_rizo2<span class="sc">$</span>Year)</span>
<span id="cb35-917"><a href="#cb35-917" aria-hidden="true" tabindex="-1"></a><span class="fu">t2way</span>(Observed <span class="sc">~</span> Condition<span class="sc">*</span>Year, <span class="at">data=</span>indices_rizo2)</span>
<span id="cb35-918"><a href="#cb35-918" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-919"><a href="#cb35-919" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(InvSimpson <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-920"><a href="#cb35-920" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Condition <span class="sc">*</span> Year)</span>
<span id="cb35-921"><a href="#cb35-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-922"><a href="#cb35-922" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc</span></span>
<span id="cb35-923"><a href="#cb35-923" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">pairwise_t_test</span>(Pielou<span class="sc">~</span>Condition)</span>
<span id="cb35-924"><a href="#cb35-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-925"><a href="#cb35-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-926"><a href="#cb35-926" aria-hidden="true" tabindex="-1"></a>We can also compare if the alpha diversity indices of bacterial communities associated to mothers, first and second suckers are different each other. In the <span class="co">[</span><span class="ot">index of this website</span><span class="co">](index.qmd "Click if you want more information")</span>, you can find more details about the concepts of *Mothers*, *first suckers* and *second suckers*. These concepts are very similar to the concept of "Generation" in sexually reproducing plants, and that's exactly the name of the factor employed here. So, we will compare the indices of these groups, by the factor *Generation*.</span>
<span id="cb35-927"><a href="#cb35-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-930"><a href="#cb35-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-931"><a href="#cb35-931" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-932"><a href="#cb35-932" aria-hidden="true" tabindex="-1"></a><span class="co"># a.1) South plot</span></span>
<span id="cb35-933"><a href="#cb35-933" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb35-934"><a href="#cb35-934" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-935"><a href="#cb35-935" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-936"><a href="#cb35-936" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-937"><a href="#cb35-937" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-938"><a href="#cb35-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-939"><a href="#cb35-939" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-940"><a href="#cb35-940" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-941"><a href="#cb35-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb35-942"><a href="#cb35-942" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-943"><a href="#cb35-943" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-944"><a href="#cb35-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb35-945"><a href="#cb35-945" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-946"><a href="#cb35-946" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo1, <span class="st">"Pielou"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-947"><a href="#cb35-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb35-948"><a href="#cb35-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-949"><a href="#cb35-949" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-950"><a href="#cb35-950" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-951"><a href="#cb35-951" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-952"><a href="#cb35-952" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-953"><a href="#cb35-953" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-954"><a href="#cb35-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-955"><a href="#cb35-955" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-956"><a href="#cb35-956" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-957"><a href="#cb35-957" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon); <span class="fu">View</span>(b)</span>
<span id="cb35-958"><a href="#cb35-958" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb35-959"><a href="#cb35-959" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb35-960"><a href="#cb35-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-961"><a href="#cb35-961" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether the variables "Observed" and "InvSimpson" are still homocedastic in case we apply robust tests</span></span>
<span id="cb35-962"><a href="#cb35-962" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> </span>
<span id="cb35-963"><a href="#cb35-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Observed,</span>
<span id="cb35-964"><a href="#cb35-964" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed,<span class="fl">0.1</span>),  </span>
<span id="cb35-965"><a href="#cb35-965" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Observed, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-966"><a href="#cb35-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-967"><a href="#cb35-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-968"><a href="#cb35-968" aria-hidden="true" tabindex="-1"></a>indices_rizo1<span class="sc">%&gt;%</span> </span>
<span id="cb35-969"><a href="#cb35-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb35-970"><a href="#cb35-970" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb35-971"><a href="#cb35-971" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-972"><a href="#cb35-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-973"><a href="#cb35-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-974"><a href="#cb35-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-975"><a href="#cb35-975" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb35-976"><a href="#cb35-976" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(Observed<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo1)<span class="co">#one-way robust test</span></span>
<span id="cb35-977"><a href="#cb35-977" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)<span class="co">#one-way ANOVA</span></span>
<span id="cb35-978"><a href="#cb35-978" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo1)</span>
<span id="cb35-979"><a href="#cb35-979" aria-hidden="true" tabindex="-1"></a>indices_rizo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-980"><a href="#cb35-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-981"><a href="#cb35-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-982"><a href="#cb35-982" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-983"><a href="#cb35-983" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-984"><a href="#cb35-984" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-985"><a href="#cb35-985" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-986"><a href="#cb35-986" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-987"><a href="#cb35-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-988"><a href="#cb35-988" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-989"><a href="#cb35-989" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-990"><a href="#cb35-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb35-991"><a href="#cb35-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-992"><a href="#cb35-992" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-993"><a href="#cb35-993" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_rizo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-994"><a href="#cb35-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb35-995"><a href="#cb35-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-996"><a href="#cb35-996" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-997"><a href="#cb35-997" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-998"><a href="#cb35-998" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-999"><a href="#cb35-999" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1000"><a href="#cb35-1000" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1001"><a href="#cb35-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1002"><a href="#cb35-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-1003"><a href="#cb35-1003" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-1004"><a href="#cb35-1004" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon);<span class="fu">View</span>(b)</span>
<span id="cb35-1005"><a href="#cb35-1005" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb35-1006"><a href="#cb35-1006" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_rizo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb35-1007"><a href="#cb35-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1008"><a href="#cb35-1008" aria-hidden="true" tabindex="-1"></a>indices_rizo2<span class="sc">%&gt;%</span> </span>
<span id="cb35-1009"><a href="#cb35-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb35-1010"><a href="#cb35-1010" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb35-1011"><a href="#cb35-1011" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-1012"><a href="#cb35-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1013"><a href="#cb35-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1014"><a href="#cb35-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb35-1015"><a href="#cb35-1015" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-1016"><a href="#cb35-1016" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-1017"><a href="#cb35-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_rizo2)</span>
<span id="cb35-1018"><a href="#cb35-1018" aria-hidden="true" tabindex="-1"></a>indices_rizo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1019"><a href="#cb35-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1020"><a href="#cb35-1020" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1021"><a href="#cb35-1021" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1022"><a href="#cb35-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality</span></span>
<span id="cb35-1023"><a href="#cb35-1023" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-1024"><a href="#cb35-1024" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-1025"><a href="#cb35-1025" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-1026"><a href="#cb35-1026" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-1027"><a href="#cb35-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1028"><a href="#cb35-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1029"><a href="#cb35-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo1, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-1030"><a href="#cb35-1030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb35-1031"><a href="#cb35-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1032"><a href="#cb35-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-1033"><a href="#cb35-1033" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-1034"><a href="#cb35-1034" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-1035"><a href="#cb35-1035" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1036"><a href="#cb35-1036" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1037"><a href="#cb35-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1038"><a href="#cb35-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-1039"><a href="#cb35-1039" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-1040"><a href="#cb35-1040" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon) ;<span class="fu">View</span>(b)</span>
<span id="cb35-1041"><a href="#cb35-1041" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb35-1042"><a href="#cb35-1042" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo1 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb35-1043"><a href="#cb35-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1044"><a href="#cb35-1044" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> </span>
<span id="cb35-1045"><a href="#cb35-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb35-1046"><a href="#cb35-1046" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb35-1047"><a href="#cb35-1047" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-1048"><a href="#cb35-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1049"><a href="#cb35-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1050"><a href="#cb35-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#Tests</span></span>
<span id="cb35-1051"><a href="#cb35-1051" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-1052"><a href="#cb35-1052" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-1053"><a href="#cb35-1053" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo1)</span>
<span id="cb35-1054"><a href="#cb35-1054" aria-hidden="true" tabindex="-1"></a>indices_endo1 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1055"><a href="#cb35-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1056"><a href="#cb35-1056" aria-hidden="true" tabindex="-1"></a><span class="co">#Post-hoc test: "Observed" resulted statistically significant, so let's apply Student's t-test</span></span>
<span id="cb35-1057"><a href="#cb35-1057" aria-hidden="true" tabindex="-1"></a>indices_endo1<span class="sc">%&gt;%</span> <span class="fu">pairwise_t_test</span>(Observed<span class="sc">~</span>Generation)</span>
<span id="cb35-1058"><a href="#cb35-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1059"><a href="#cb35-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1060"><a href="#cb35-1060" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(Observed)</span>
<span id="cb35-1061"><a href="#cb35-1061" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Shannon)</span>
<span id="cb35-1062"><a href="#cb35-1062" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(InvSimpson)</span>
<span id="cb35-1063"><a href="#cb35-1063" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span>  <span class="fu">shapiro_test</span>(Pielou)</span>
<span id="cb35-1064"><a href="#cb35-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1065"><a href="#cb35-1065" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1066"><a href="#cb35-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"Observed"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-1067"><a href="#cb35-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation<span class="sc">~</span>Plot)</span>
<span id="cb35-1068"><a href="#cb35-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1069"><a href="#cb35-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1070"><a href="#cb35-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(indices_endo2, <span class="st">"InvSimpson"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb35-1071"><a href="#cb35-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Generation <span class="sc">~</span> Plot)</span>
<span id="cb35-1072"><a href="#cb35-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1073"><a href="#cb35-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity</span></span>
<span id="cb35-1074"><a href="#cb35-1074" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-1075"><a href="#cb35-1075" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-1076"><a href="#cb35-1076" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1077"><a href="#cb35-1077" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span> <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1078"><a href="#cb35-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1079"><a href="#cb35-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers</span></span>
<span id="cb35-1080"><a href="#cb35-1080" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Observed); <span class="fu">View</span>(a)</span>
<span id="cb35-1081"><a href="#cb35-1081" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Shannon) ;<span class="fu">View</span>(b)</span>
<span id="cb35-1082"><a href="#cb35-1082" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(InvSimpson); <span class="fu">View</span>(c)</span>
<span id="cb35-1083"><a href="#cb35-1083" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>indices_endo2 <span class="sc">%&gt;%</span><span class="fu">group_by</span>(Generation)<span class="sc">%&gt;%</span><span class="fu">identify_outliers</span>(Pielou); <span class="fu">View</span>(d)</span>
<span id="cb35-1084"><a href="#cb35-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1085"><a href="#cb35-1085" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span> </span>
<span id="cb35-1086"><a href="#cb35-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(InvSimpson,</span>
<span id="cb35-1087"><a href="#cb35-1087" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson,<span class="fl">0.1</span>),  </span>
<span id="cb35-1088"><a href="#cb35-1088" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(InvSimpson, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-1089"><a href="#cb35-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(InvSimpson <span class="sc">~</span> Generation)</span>
<span id="cb35-1090"><a href="#cb35-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1091"><a href="#cb35-1091" aria-hidden="true" tabindex="-1"></a>indices_endo2<span class="sc">%&gt;%</span></span>
<span id="cb35-1092"><a href="#cb35-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(Pielou,</span>
<span id="cb35-1093"><a href="#cb35-1093" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Pielou,<span class="fl">0.1</span>),  </span>
<span id="cb35-1094"><a href="#cb35-1094" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">quantile</span>(Pielou, <span class="fl">0.9</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb35-1095"><a href="#cb35-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Pielou <span class="sc">~</span> Generation)</span>
<span id="cb35-1096"><a href="#cb35-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1097"><a href="#cb35-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#tests</span></span>
<span id="cb35-1098"><a href="#cb35-1098" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Observed <span class="sc">~</span> Generation)</span>
<span id="cb35-1099"><a href="#cb35-1099" aria-hidden="true" tabindex="-1"></a>indices_endo2 <span class="sc">%&gt;%</span>  <span class="fu">anova_test</span>(Shannon <span class="sc">~</span> Generation)</span>
<span id="cb35-1100"><a href="#cb35-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(InvSimpson<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo2)</span>
<span id="cb35-1101"><a href="#cb35-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">t1way</span>(Pielou<span class="sc">~</span>Generation, <span class="at">data=</span>indices_endo2)</span>
<span id="cb35-1102"><a href="#cb35-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1103"><a href="#cb35-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1104"><a href="#cb35-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1105"><a href="#cb35-1105" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. Beta diversity analyses</span></span>
<span id="cb35-1106"><a href="#cb35-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1107"><a href="#cb35-1107" aria-hidden="true" tabindex="-1"></a>It's time to analyze the differences in the diversity of the bacterial communities between samples. For that purpose, we will navigate into the multivariate statistics.</span>
<span id="cb35-1108"><a href="#cb35-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1109"><a href="#cb35-1109" aria-hidden="true" tabindex="-1"></a>Firstly, we have to normalize the data to avoid potential biases due to different library sizes (different number of sequences in the samples). We prefer the edgeR method, which is based on the TMM (*Trimmed Mean of the M-values*). This normalization is needed when we are working also with compositional data; that is to say, with data that expressed in percentages, such as microbiota counts. More information can be found <span class="co">[</span><span class="ot">here</span><span class="co">](https://doi.org/10.1186/gb-2010-11-3-r25)</span>.</span>
<span id="cb35-1110"><a href="#cb35-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1111"><a href="#cb35-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.1 TMM Normalization</span></span>
<span id="cb35-1112"><a href="#cb35-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1113"><a href="#cb35-1113" aria-hidden="true" tabindex="-1"></a>We are going to use this normalization for both multivariate plots and for multivariate statistics.</span>
<span id="cb35-1114"><a href="#cb35-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1117"><a href="#cb35-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1118"><a href="#cb35-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1119"><a href="#cb35-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1120"><a href="#cb35-1120" aria-hidden="true" tabindex="-1"></a>rizo1_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(rizo1,<span class="at">taxa_are_rows =</span> T))<span class="co">#extract the ASV table from the phyloseq object</span></span>
<span id="cb35-1121"><a href="#cb35-1121" aria-hidden="true" tabindex="-1"></a>rizo1_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo1))<span class="co">#extract the metadata table from the phyloseq object</span></span>
<span id="cb35-1122"><a href="#cb35-1122" aria-hidden="true" tabindex="-1"></a>rizo1_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(rizo1))<span class="co">#extract the taxonomy table from the phyloseq object</span></span>
<span id="cb35-1123"><a href="#cb35-1123" aria-hidden="true" tabindex="-1"></a>rizo1_tree<span class="ot">=</span><span class="fu">phy_tree</span>(rizo1)<span class="co">#extract the phylogenetic tree from the phyloseq object</span></span>
<span id="cb35-1124"><a href="#cb35-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1125"><a href="#cb35-1125" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a new object suitbale for the normalization by the package edgeR</span></span>
<span id="cb35-1126"><a href="#cb35-1126" aria-hidden="true" tabindex="-1"></a>rizo1_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> rizo1_ASV, <span class="at">samples =</span> rizo1_mt, <span class="at">genes =</span> rizo1_tax)</span>
<span id="cb35-1127"><a href="#cb35-1127" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the normalization factors to correct the differences in sequencing depth</span></span>
<span id="cb35-1128"><a href="#cb35-1128" aria-hidden="true" tabindex="-1"></a>rizo1_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(rizo1_edgeR)</span>
<span id="cb35-1129"><a href="#cb35-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the normalized abundance</span></span>
<span id="cb35-1130"><a href="#cb35-1130" aria-hidden="true" tabindex="-1"></a>rizo1_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(rizo1_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb35-1131"><a href="#cb35-1131" aria-hidden="true" tabindex="-1"></a><span class="co">#Create the phyloseq elements with the ASV counts normalized</span></span>
<span id="cb35-1132"><a href="#cb35-1132" aria-hidden="true" tabindex="-1"></a>rizo1_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(rizo1_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb35-1133"><a href="#cb35-1133" aria-hidden="true" tabindex="-1"></a>rizo1_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(rizo1_tax))</span>
<span id="cb35-1134"><a href="#cb35-1134" aria-hidden="true" tabindex="-1"></a>rizo1_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(rizo1_mt)</span>
<span id="cb35-1135"><a href="#cb35-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(rizo1_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(rizo1_phy_taxonomy_norm)</span>
<span id="cb35-1136"><a href="#cb35-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1137"><a href="#cb35-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(rizo1_ASV_norm), <span class="fu">rownames</span>(rizo1_tax))<span class="co">#it should give "TRUE"</span></span>
<span id="cb35-1138"><a href="#cb35-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#Join all the elements into a new phyloseq object</span></span>
<span id="cb35-1139"><a href="#cb35-1139" aria-hidden="true" tabindex="-1"></a>rizo1_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(rizo1_phy_OTU_norm, rizo1_phy_taxonomy_norm,rizo1_phy_metadata_norm,rizo1_tree)</span>
<span id="cb35-1140"><a href="#cb35-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-1141"><a href="#cb35-1141" aria-hidden="true" tabindex="-1"></a>rizo2_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(rizo2,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb35-1142"><a href="#cb35-1142" aria-hidden="true" tabindex="-1"></a>rizo2_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(rizo2))</span>
<span id="cb35-1143"><a href="#cb35-1143" aria-hidden="true" tabindex="-1"></a>rizo2_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(rizo2))</span>
<span id="cb35-1144"><a href="#cb35-1144" aria-hidden="true" tabindex="-1"></a>rizo2_tree<span class="ot">=</span><span class="fu">phy_tree</span>(rizo2)</span>
<span id="cb35-1145"><a href="#cb35-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1146"><a href="#cb35-1146" aria-hidden="true" tabindex="-1"></a>rizo2_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> rizo2_ASV, <span class="at">samples =</span> rizo2_mt, <span class="at">genes =</span> rizo2_tax)</span>
<span id="cb35-1147"><a href="#cb35-1147" aria-hidden="true" tabindex="-1"></a>rizo2_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(rizo2_edgeR)</span>
<span id="cb35-1148"><a href="#cb35-1148" aria-hidden="true" tabindex="-1"></a>rizo2_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(rizo2_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb35-1149"><a href="#cb35-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1150"><a href="#cb35-1150" aria-hidden="true" tabindex="-1"></a>rizo2_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(rizo2_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb35-1151"><a href="#cb35-1151" aria-hidden="true" tabindex="-1"></a>rizo2_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(rizo2_tax))</span>
<span id="cb35-1152"><a href="#cb35-1152" aria-hidden="true" tabindex="-1"></a>rizo2_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(rizo2_mt)</span>
<span id="cb35-1153"><a href="#cb35-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(rizo2_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(rizo2_phy_taxonomy_norm)</span>
<span id="cb35-1154"><a href="#cb35-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1155"><a href="#cb35-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(rizo2_ASV_norm), <span class="fu">rownames</span>(rizo2_tax))</span>
<span id="cb35-1156"><a href="#cb35-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1157"><a href="#cb35-1157" aria-hidden="true" tabindex="-1"></a>rizo2_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(rizo2_phy_OTU_norm,rizo2_phy_taxonomy_norm,rizo2_phy_metadata_norm,rizo2_tree)</span>
<span id="cb35-1158"><a href="#cb35-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1159"><a href="#cb35-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#b)ENDOSPHERE</span></span>
<span id="cb35-1160"><a href="#cb35-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1161"><a href="#cb35-1161" aria-hidden="true" tabindex="-1"></a>endo1_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(endo1,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb35-1162"><a href="#cb35-1162" aria-hidden="true" tabindex="-1"></a>endo1_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo1))</span>
<span id="cb35-1163"><a href="#cb35-1163" aria-hidden="true" tabindex="-1"></a>endo1_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(endo1))</span>
<span id="cb35-1164"><a href="#cb35-1164" aria-hidden="true" tabindex="-1"></a>endo1_tree<span class="ot">=</span><span class="fu">phy_tree</span>(endo1)</span>
<span id="cb35-1165"><a href="#cb35-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1166"><a href="#cb35-1166" aria-hidden="true" tabindex="-1"></a>endo1_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> endo1_ASV, <span class="at">samples =</span> endo1_mt, <span class="at">genes =</span> endo1_tax)</span>
<span id="cb35-1167"><a href="#cb35-1167" aria-hidden="true" tabindex="-1"></a>endo1_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(endo1_edgeR)</span>
<span id="cb35-1168"><a href="#cb35-1168" aria-hidden="true" tabindex="-1"></a>endo1_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(endo1_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb35-1169"><a href="#cb35-1169" aria-hidden="true" tabindex="-1"></a>endo1_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(endo1_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb35-1170"><a href="#cb35-1170" aria-hidden="true" tabindex="-1"></a>endo1_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(endo1_tax))</span>
<span id="cb35-1171"><a href="#cb35-1171" aria-hidden="true" tabindex="-1"></a>endo1_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(endo1_mt)</span>
<span id="cb35-1172"><a href="#cb35-1172" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(endo1_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(endo1_phy_taxonomy_norm)</span>
<span id="cb35-1173"><a href="#cb35-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1174"><a href="#cb35-1174" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(endo1_ASV_norm), <span class="fu">rownames</span>(endo1_tax))</span>
<span id="cb35-1175"><a href="#cb35-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1176"><a href="#cb35-1176" aria-hidden="true" tabindex="-1"></a>endo1_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(endo1_phy_OTU_norm,endo1_phy_taxonomy_norm,endo1_phy_metadata_norm,endo1_tree)</span>
<span id="cb35-1177"><a href="#cb35-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1178"><a href="#cb35-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1179"><a href="#cb35-1179" aria-hidden="true" tabindex="-1"></a>endo2_ASV<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(endo2,<span class="at">taxa_are_rows =</span> T))</span>
<span id="cb35-1180"><a href="#cb35-1180" aria-hidden="true" tabindex="-1"></a>endo2_mt<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(endo2))</span>
<span id="cb35-1181"><a href="#cb35-1181" aria-hidden="true" tabindex="-1"></a>endo2_tax<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(endo2))</span>
<span id="cb35-1182"><a href="#cb35-1182" aria-hidden="true" tabindex="-1"></a>endo2_tree<span class="ot">=</span><span class="fu">phy_tree</span>(endo2)</span>
<span id="cb35-1183"><a href="#cb35-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1184"><a href="#cb35-1184" aria-hidden="true" tabindex="-1"></a>endo2_edgeR <span class="ot">=</span> <span class="fu">DGEList</span>(<span class="at">counts =</span> endo2_ASV, <span class="at">samples =</span> endo2_mt, <span class="at">genes =</span> endo2_tax)</span>
<span id="cb35-1185"><a href="#cb35-1185" aria-hidden="true" tabindex="-1"></a>endo2_edgeR <span class="ot">=</span> <span class="fu">calcNormFactors</span>(endo2_edgeR)</span>
<span id="cb35-1186"><a href="#cb35-1186" aria-hidden="true" tabindex="-1"></a>endo2_ASV_norm <span class="ot">=</span> <span class="fu">cpm</span>(endo2_edgeR, <span class="at">normalized.lib.sizes=</span>T, <span class="at">log=</span>F)</span>
<span id="cb35-1187"><a href="#cb35-1187" aria-hidden="true" tabindex="-1"></a>endo2_phy_OTU_norm<span class="ot">=</span><span class="fu">otu_table</span>(<span class="fu">as.data.frame</span>(endo2_ASV_norm,<span class="at">row.names=</span>F), <span class="at">taxa_are_rows =</span> T)</span>
<span id="cb35-1188"><a href="#cb35-1188" aria-hidden="true" tabindex="-1"></a>endo2_phy_taxonomy_norm<span class="ot">=</span><span class="fu">tax_table</span>(<span class="fu">as.matrix</span>(endo2_tax))</span>
<span id="cb35-1189"><a href="#cb35-1189" aria-hidden="true" tabindex="-1"></a>endo2_phy_metadata_norm<span class="ot">=</span><span class="fu">sample_data</span>(endo2_mt)</span>
<span id="cb35-1190"><a href="#cb35-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1191"><a href="#cb35-1191" aria-hidden="true" tabindex="-1"></a><span class="fu">taxa_names</span>(endo2_phy_OTU_norm)<span class="ot">=</span> <span class="fu">taxa_names</span>(endo2_phy_taxonomy_norm)</span>
<span id="cb35-1192"><a href="#cb35-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1193"><a href="#cb35-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(endo2_ASV_norm), <span class="fu">rownames</span>(endo2_tax))</span>
<span id="cb35-1194"><a href="#cb35-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1195"><a href="#cb35-1195" aria-hidden="true" tabindex="-1"></a>endo2_normalized_phyloseq<span class="ot">&lt;-</span><span class="fu">phyloseq</span>(endo2_phy_OTU_norm,endo2_phy_taxonomy_norm,endo2_phy_metadata_norm,endo2_tree)</span>
<span id="cb35-1196"><a href="#cb35-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1197"><a href="#cb35-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1198"><a href="#cb35-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.2 Multivariate statistical tests</span></span>
<span id="cb35-1199"><a href="#cb35-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1200"><a href="#cb35-1200" aria-hidden="true" tabindex="-1"></a>The best options to test whether the groups of samples have the same dispersion is to apply the test PERMDISP2, while PERMANOVA (Permutational Multivariate Analysis of Variance Using Distance Matrices) is a test suitable to check whether the centroid (concept similar to the mean of groups of samples) of all the groups of samples to be compared is homogenus. Thus, these tests are the multivariate version of Levene's and ANOVA tests. However, both of them are based on distance matrices. That is to say, we have to calculate the distance between all sample pairs. There are many different distance or dissimilarity measures, but here we are going to use Weighted UniFrac distance, because it is based on both the phylogenetic proximity among ASVs and on their abundance.</span>
<span id="cb35-1201"><a href="#cb35-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1202"><a href="#cb35-1202" aria-hidden="true" tabindex="-1"></a>Null hypotheses of both tests: PERMANOVA H~0~: no significant differences in the centroids (mean values) of the groups of samples PERMDISPD2 H~0~: no significant differences in the dispersion of the groups of samples</span>
<span id="cb35-1203"><a href="#cb35-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1204"><a href="#cb35-1204" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb35-1205"><a href="#cb35-1205" aria-hidden="true" tabindex="-1"></a>Be careful with unbalanced experiments. As stated <span class="co">[</span><span class="ot">Anderson and Walsh (2013)</span><span class="co">](https://doi.org/10.1890/12-2010.1)</span>, when the groups of samples to be compared have different number of replicates (unbalanced design), heterocedasticity becomes a problem. In that cases, PERMANOVA cannot distinguish between the differences between groups of samples are due to the different dispersion or due to differences in the centroids. So, in case of unbalances designs, it is superimportant to check the dispersion of the data.</span>
<span id="cb35-1206"><a href="#cb35-1206" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-1207"><a href="#cb35-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1210"><a href="#cb35-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1211"><a href="#cb35-1211" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1212"><a href="#cb35-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1213"><a href="#cb35-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1214"><a href="#cb35-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1215"><a href="#cb35-1215" aria-hidden="true" tabindex="-1"></a>df_r1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rizo1_normalized_phyloseq))<span class="co">#extract the metadata table from the phyloseq object (NORMALIZED phyloseq!)</span></span>
<span id="cb35-1216"><a href="#cb35-1216" aria-hidden="true" tabindex="-1"></a>wuni_r1<span class="ot">=</span><span class="fu">UniFrac</span>(rizo1_normalized_phyloseq, <span class="at">weighted=</span>T)<span class="co">#calculate Weighted UniFrac distances</span></span>
<span id="cb35-1217"><a href="#cb35-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1218"><a href="#cb35-1218" aria-hidden="true" tabindex="-1"></a>adonis_rizo1<span class="ot">=</span><span class="fu">adonis</span>(wuni_r1<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_r1, <span class="at">permutations =</span> <span class="dv">9999</span>)<span class="co">#apply the PERMANOVA test. Here we test the model Community structure~Plant type*Sampling year</span></span>
<span id="cb35-1219"><a href="#cb35-1219" aria-hidden="true" tabindex="-1"></a>adonis_rizo1<span class="co">#check the results</span></span>
<span id="cb35-1220"><a href="#cb35-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1221"><a href="#cb35-1221" aria-hidden="true" tabindex="-1"></a>betadisper_r1condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Condition)<span class="co">#check the betadispersion of each factor separately</span></span>
<span id="cb35-1222"><a href="#cb35-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r1condition)</span>
<span id="cb35-1223"><a href="#cb35-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1224"><a href="#cb35-1224" aria-hidden="true" tabindex="-1"></a>betadisper_r1year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Year)</span>
<span id="cb35-1225"><a href="#cb35-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r1year)</span>
<span id="cb35-1226"><a href="#cb35-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1227"><a href="#cb35-1227" aria-hidden="true" tabindex="-1"></a><span class="co">#North plot</span></span>
<span id="cb35-1228"><a href="#cb35-1228" aria-hidden="true" tabindex="-1"></a>df_r2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(rizo2_normalized_phyloseq))</span>
<span id="cb35-1229"><a href="#cb35-1229" aria-hidden="true" tabindex="-1"></a>wuni_r2<span class="ot">=</span><span class="fu">UniFrac</span>(rizo2_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb35-1230"><a href="#cb35-1230" aria-hidden="true" tabindex="-1"></a>adonis_rizo2<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r2<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_r2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1231"><a href="#cb35-1231" aria-hidden="true" tabindex="-1"></a>adonis_rizo2</span>
<span id="cb35-1232"><a href="#cb35-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1233"><a href="#cb35-1233" aria-hidden="true" tabindex="-1"></a>betadisper_r2condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Condition)</span>
<span id="cb35-1234"><a href="#cb35-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r2condition)</span>
<span id="cb35-1235"><a href="#cb35-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1236"><a href="#cb35-1236" aria-hidden="true" tabindex="-1"></a>betadisper_r2year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Year)</span>
<span id="cb35-1237"><a href="#cb35-1237" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_r2year)</span>
<span id="cb35-1238"><a href="#cb35-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1239"><a href="#cb35-1239" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1240"><a href="#cb35-1240" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1241"><a href="#cb35-1241" aria-hidden="true" tabindex="-1"></a>df_e1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(endo1_normalized_phyloseq))</span>
<span id="cb35-1242"><a href="#cb35-1242" aria-hidden="true" tabindex="-1"></a>wuni_e1<span class="ot">=</span><span class="fu">UniFrac</span>(endo1_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb35-1243"><a href="#cb35-1243" aria-hidden="true" tabindex="-1"></a>adonis_endo1<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e1<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_e1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1244"><a href="#cb35-1244" aria-hidden="true" tabindex="-1"></a>adonis_endo1</span>
<span id="cb35-1245"><a href="#cb35-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1246"><a href="#cb35-1246" aria-hidden="true" tabindex="-1"></a>betadisper_e1condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Condition)</span>
<span id="cb35-1247"><a href="#cb35-1247" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e1condition)</span>
<span id="cb35-1248"><a href="#cb35-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1249"><a href="#cb35-1249" aria-hidden="true" tabindex="-1"></a>betadisper_e1year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Year)</span>
<span id="cb35-1250"><a href="#cb35-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e1year)</span>
<span id="cb35-1251"><a href="#cb35-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1252"><a href="#cb35-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1253"><a href="#cb35-1253" aria-hidden="true" tabindex="-1"></a>df_e2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">sample_data</span>(endo2_normalized_phyloseq))</span>
<span id="cb35-1254"><a href="#cb35-1254" aria-hidden="true" tabindex="-1"></a>wuni_e2<span class="ot">=</span><span class="fu">UniFrac</span>(endo2_normalized_phyloseq, <span class="at">weighted=</span>T)</span>
<span id="cb35-1255"><a href="#cb35-1255" aria-hidden="true" tabindex="-1"></a>adonis_endo2<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e2<span class="sc">~</span>Condition<span class="sc">*</span>Year, <span class="at">data=</span>df_e2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1256"><a href="#cb35-1256" aria-hidden="true" tabindex="-1"></a>adonis_endo2</span>
<span id="cb35-1257"><a href="#cb35-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1258"><a href="#cb35-1258" aria-hidden="true" tabindex="-1"></a>betadisper_e2condition<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Condition)</span>
<span id="cb35-1259"><a href="#cb35-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e2condition)</span>
<span id="cb35-1260"><a href="#cb35-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1261"><a href="#cb35-1261" aria-hidden="true" tabindex="-1"></a>betadisper_e2year<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Year)</span>
<span id="cb35-1262"><a href="#cb35-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_e2year)</span>
<span id="cb35-1263"><a href="#cb35-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1264"><a href="#cb35-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#Let's calculate the size of the effects:</span></span>
<span id="cb35-1265"><a href="#cb35-1265" aria-hidden="true" tabindex="-1"></a>adonis_OmegaSq <span class="ot">&lt;-</span> <span class="cf">function</span>(adonisOutput, <span class="at">partial =</span> <span class="cn">TRUE</span>){</span>
<span id="cb35-1266"><a href="#cb35-1266" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>(<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>) <span class="sc">||</span> <span class="fu">is</span>(adonisOutput, <span class="st">"anova.cca"</span>)))</span>
<span id="cb35-1267"><a href="#cb35-1267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Input should be an adonis object"</span>)</span>
<span id="cb35-1268"><a href="#cb35-1268" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"anova.cca"</span>)) {</span>
<span id="cb35-1269"><a href="#cb35-1269" aria-hidden="true" tabindex="-1"></a>    aov_tab <span class="ot">&lt;-</span> adonisOutput</span>
<span id="cb35-1270"><a href="#cb35-1270" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>MeanSqs <span class="ot">&lt;-</span> aov_tab<span class="sc">$</span>SumOfSqs <span class="sc">/</span> aov_tab<span class="sc">$</span>Df</span>
<span id="cb35-1271"><a href="#cb35-1271" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>MeanSqs[<span class="fu">length</span>(aov_tab<span class="sc">$</span>Df)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb35-1272"><a href="#cb35-1272" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb35-1273"><a href="#cb35-1273" aria-hidden="true" tabindex="-1"></a>    aov_tab <span class="ot">&lt;-</span> adonisOutput<span class="sc">$</span>aov.tab</span>
<span id="cb35-1274"><a href="#cb35-1274" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-1275"><a href="#cb35-1275" aria-hidden="true" tabindex="-1"></a>  heading <span class="ot">&lt;-</span> <span class="fu">attr</span>(aov_tab, <span class="st">"heading"</span>)</span>
<span id="cb35-1276"><a href="#cb35-1276" aria-hidden="true" tabindex="-1"></a>  MS_res <span class="ot">&lt;-</span> aov_tab[<span class="fu">pmatch</span>(<span class="st">"Residual"</span>, <span class="fu">rownames</span>(aov_tab)), <span class="st">"MeanSqs"</span>]</span>
<span id="cb35-1277"><a href="#cb35-1277" aria-hidden="true" tabindex="-1"></a>  SS_tot <span class="ot">&lt;-</span> aov_tab[<span class="fu">rownames</span>(aov_tab) <span class="sc">==</span> <span class="st">"Total"</span>, <span class="st">"SumsOfSqs"</span>]</span>
<span id="cb35-1278"><a href="#cb35-1278" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> aov_tab[<span class="fu">rownames</span>(aov_tab) <span class="sc">==</span> <span class="st">"Total"</span>, <span class="st">"Df"</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb35-1279"><a href="#cb35-1279" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(partial){</span>
<span id="cb35-1280"><a href="#cb35-1280" aria-hidden="true" tabindex="-1"></a>    omega <span class="ot">&lt;-</span> <span class="fu">apply</span>(aov_tab, <span class="dv">1</span>, <span class="cf">function</span>(x) (x[<span class="st">"Df"</span>]<span class="sc">*</span>(x[<span class="st">"MeanSqs"</span>]<span class="sc">-</span>MS_res))<span class="sc">/</span>(x[<span class="st">"Df"</span>]<span class="sc">*</span>x[<span class="st">"MeanSqs"</span>]<span class="sc">+</span>(N<span class="sc">-</span>x[<span class="st">"Df"</span>])<span class="sc">*</span>MS_res))</span>
<span id="cb35-1281"><a href="#cb35-1281" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>parOmegaSq <span class="ot">&lt;-</span> <span class="fu">c</span>(omega[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(omega)<span class="sc">-</span><span class="dv">2</span>)], <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb35-1282"><a href="#cb35-1282" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb35-1283"><a href="#cb35-1283" aria-hidden="true" tabindex="-1"></a>    omega <span class="ot">&lt;-</span> <span class="fu">apply</span>(aov_tab, <span class="dv">1</span>, <span class="cf">function</span>(x) (x[<span class="st">"SumsOfSqs"</span>]<span class="sc">-</span>x[<span class="st">"Df"</span>]<span class="sc">*</span>MS_res)<span class="sc">/</span>(SS_tot<span class="sc">+</span>MS_res))</span>
<span id="cb35-1284"><a href="#cb35-1284" aria-hidden="true" tabindex="-1"></a>    aov_tab<span class="sc">$</span>OmegaSq <span class="ot">&lt;-</span> <span class="fu">c</span>(omega[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(omega)<span class="sc">-</span><span class="dv">2</span>)], <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb35-1285"><a href="#cb35-1285" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-1286"><a href="#cb35-1286" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>))</span>
<span id="cb35-1287"><a href="#cb35-1287" aria-hidden="true" tabindex="-1"></a>    cn_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Df"</span>, <span class="st">"SumsOfSqs"</span>, <span class="st">"MeanSqs"</span>, <span class="st">"F.Model"</span>, <span class="st">"R2"</span>,</span>
<span id="cb35-1288"><a href="#cb35-1288" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">if</span> (partial) <span class="st">"parOmegaSq"</span> <span class="cf">else</span> <span class="st">"OmegaSq"</span>, <span class="st">"Pr(&gt;F)"</span>)</span>
<span id="cb35-1289"><a href="#cb35-1289" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb35-1290"><a href="#cb35-1290" aria-hidden="true" tabindex="-1"></a>    cn_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Df"</span>, <span class="st">"SumOfSqs"</span>, <span class="st">"F"</span>, <span class="cf">if</span> (partial) <span class="st">"parOmegaSq"</span> <span class="cf">else</span> <span class="st">"OmegaSq"</span>,</span>
<span id="cb35-1291"><a href="#cb35-1291" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Pr(&gt;F)"</span>)</span>
<span id="cb35-1292"><a href="#cb35-1292" aria-hidden="true" tabindex="-1"></a>  aov_tab <span class="ot">&lt;-</span> aov_tab[, cn_order]</span>
<span id="cb35-1293"><a href="#cb35-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(aov_tab, <span class="st">"names"</span>) <span class="ot">&lt;-</span> cn_order</span>
<span id="cb35-1294"><a href="#cb35-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(aov_tab, <span class="st">"heading"</span>) <span class="ot">&lt;-</span> heading</span>
<span id="cb35-1295"><a href="#cb35-1295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(adonisOutput, <span class="st">"adonis"</span>))</span>
<span id="cb35-1296"><a href="#cb35-1296" aria-hidden="true" tabindex="-1"></a>    adonisOutput<span class="sc">$</span>aov.tab <span class="ot">&lt;-</span> aov_tab</span>
<span id="cb35-1297"><a href="#cb35-1297" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb35-1298"><a href="#cb35-1298" aria-hidden="true" tabindex="-1"></a>    adonisOutput <span class="ot">&lt;-</span> aov_tab</span>
<span id="cb35-1299"><a href="#cb35-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(adonisOutput)</span>
<span id="cb35-1300"><a href="#cb35-1300" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-1301"><a href="#cb35-1301" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_rizo1)<span class="co">#apply just in that cases in which PERMANOVA gives significant results</span></span>
<span id="cb35-1302"><a href="#cb35-1302" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo1)</span>
<span id="cb35-1303"><a href="#cb35-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo2)</span>
<span id="cb35-1304"><a href="#cb35-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1305"><a href="#cb35-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1306"><a href="#cb35-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1307"><a href="#cb35-1307" aria-hidden="true" tabindex="-1"></a>Now, let's compare the structure of bacterial communities of mothers, first and second suckers:</span>
<span id="cb35-1308"><a href="#cb35-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1311"><a href="#cb35-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1312"><a href="#cb35-1312" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1313"><a href="#cb35-1313" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1314"><a href="#cb35-1314" aria-hidden="true" tabindex="-1"></a>adonis_rizo1_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r1<span class="sc">~</span>Generation, <span class="at">data=</span>df_r1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1315"><a href="#cb35-1315" aria-hidden="true" tabindex="-1"></a>adonis_rizo1_generation</span>
<span id="cb35-1316"><a href="#cb35-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1317"><a href="#cb35-1317" aria-hidden="true" tabindex="-1"></a>betadisper_rizo1_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r1, df_r1<span class="sc">$</span>Generation)</span>
<span id="cb35-1318"><a href="#cb35-1318" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_rizo1_generation)</span>
<span id="cb35-1319"><a href="#cb35-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1320"><a href="#cb35-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-1321"><a href="#cb35-1321" aria-hidden="true" tabindex="-1"></a>adonis_rizo2_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_r2<span class="sc">~</span>Generation, <span class="at">data=</span>df_r2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1322"><a href="#cb35-1322" aria-hidden="true" tabindex="-1"></a>adonis_rizo2_generation</span>
<span id="cb35-1323"><a href="#cb35-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1324"><a href="#cb35-1324" aria-hidden="true" tabindex="-1"></a>betadisper_rizo2_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_r2, df_r2<span class="sc">$</span>Generation)</span>
<span id="cb35-1325"><a href="#cb35-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_rizo2_generation)</span>
<span id="cb35-1326"><a href="#cb35-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1327"><a href="#cb35-1327" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1328"><a href="#cb35-1328" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1329"><a href="#cb35-1329" aria-hidden="true" tabindex="-1"></a>adonis_endo1_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e1<span class="sc">~</span>Generation, <span class="at">data=</span>df_e1, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1330"><a href="#cb35-1330" aria-hidden="true" tabindex="-1"></a>adonis_endo1_generation</span>
<span id="cb35-1331"><a href="#cb35-1331" aria-hidden="true" tabindex="-1"></a>betadisper_endo1_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e1, df_e1<span class="sc">$</span>Generation)</span>
<span id="cb35-1332"><a href="#cb35-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_endo1_generation)</span>
<span id="cb35-1333"><a href="#cb35-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1334"><a href="#cb35-1334" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1335"><a href="#cb35-1335" aria-hidden="true" tabindex="-1"></a>adonis_endo2_generation<span class="ot">=</span><span class="fu">adonis2</span>(wuni_e2<span class="sc">~</span>Generation, <span class="at">data=</span>df_e2, <span class="at">permutations =</span> <span class="dv">9999</span>)</span>
<span id="cb35-1336"><a href="#cb35-1336" aria-hidden="true" tabindex="-1"></a>adonis_endo2_generation</span>
<span id="cb35-1337"><a href="#cb35-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis_OmegaSq</span>(adonis_endo2)<span class="co">#pass this function since significant differences were found</span></span>
<span id="cb35-1338"><a href="#cb35-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1339"><a href="#cb35-1339" aria-hidden="true" tabindex="-1"></a>betadisper_endo2_generation<span class="ot">=</span><span class="fu">betadisper</span>(wuni_e2, df_e2<span class="sc">$</span>Generation)</span>
<span id="cb35-1340"><a href="#cb35-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(betadisper_endo2_generation)</span>
<span id="cb35-1341"><a href="#cb35-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1342"><a href="#cb35-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the following function as post-hoc test. The following code will perform PERMANOVA between two groups of samples (A vs. B; A vs C; B vs C). It is just a wrapping-around function</span></span>
<span id="cb35-1343"><a href="#cb35-1343" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.adonis</span>(wuni_e2, phyloseq<span class="sc">::</span><span class="fu">sample_data</span>(endo2)<span class="sc">$</span>Generation, <span class="at">p.adjust.m =</span> <span class="st">"holm"</span>)</span>
<span id="cb35-1344"><a href="#cb35-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1345"><a href="#cb35-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1346"><a href="#cb35-1346" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5.3 Ordination plots</span></span>
<span id="cb35-1347"><a href="#cb35-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1348"><a href="#cb35-1348" aria-hidden="true" tabindex="-1"></a>There are several options to visualize the results of PERMANOVA tests, for instance, by ordination plots such as PCoA (Principal Coordinate Analysis), NMDS (Non-metric MultiDimenstional Scaling), PCA (Principal Component Analysis), among others. Theses graphs are very useful because help us to detect the differences in the structure of the microbiota among groups of samples. Both PCoA and NMDS are based on non-euclidean distances or dissimilarity measures, so we consider that they are the best options for microbiota analyses.</span>
<span id="cb35-1349"><a href="#cb35-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1350"><a href="#cb35-1350" aria-hidden="true" tabindex="-1"></a>One the one hand, PCoA plots represent in two dimensions the arrangement of the samples in the multivariate space, although the percentage of the total variance is commonly explained by many dimensions. On the other hand, NMDS approach "forces" the samples to be ordinated in just two dimensions, although this forced arrangement has an associated *stress*. We tolerate stress values lower than 0.2.</span>
<span id="cb35-1351"><a href="#cb35-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1352"><a href="#cb35-1352" aria-hidden="true" tabindex="-1"></a>We recommend calculating both ordination plots with the aim of selecting the option that best represents the results of PERMANOVA analyses.</span>
<span id="cb35-1353"><a href="#cb35-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1356"><a href="#cb35-1356" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1357"><a href="#cb35-1357" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1358"><a href="#cb35-1358" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1359"><a href="#cb35-1359" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_rizo1<span class="ot">=</span> <span class="fu">ordinate</span>(rizo1_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)<span class="co">#indicate the ordination plot and the distance</span></span>
<span id="cb35-1360"><a href="#cb35-1360" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_rizo1<span class="sc">$</span>stress))<span class="co">#this shows the stress of the NMDS</span></span>
<span id="cb35-1361"><a href="#cb35-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1362"><a href="#cb35-1362" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_rizo1 <span class="ot">=</span> <span class="fu">ordinate</span>(rizo1_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1363"><a href="#cb35-1363" aria-hidden="true" tabindex="-1"></a>peso_r1w<span class="ot">=</span>PCOA_wuni_rizo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb35-1364"><a href="#cb35-1364" aria-hidden="true" tabindex="-1"></a>peso_r1w <span class="co">#This shows the percentage of the total variance explained by just the first and second axes</span></span>
<span id="cb35-1365"><a href="#cb35-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1366"><a href="#cb35-1366" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-1367"><a href="#cb35-1367" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_rizo2<span class="ot">=</span> <span class="fu">ordinate</span>(rizo2_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)<span class="co">#indicate the ordination plot and the distance</span></span>
<span id="cb35-1368"><a href="#cb35-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_rizo2<span class="sc">$</span>stress))<span class="co">#this shows the stress of the NMDS</span></span>
<span id="cb35-1369"><a href="#cb35-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1370"><a href="#cb35-1370" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_rizo2 <span class="ot">=</span> <span class="fu">ordinate</span>(rizo2_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1371"><a href="#cb35-1371" aria-hidden="true" tabindex="-1"></a>peso_r2w<span class="ot">=</span>PCOA_wuni_rizo2<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb35-1372"><a href="#cb35-1372" aria-hidden="true" tabindex="-1"></a>peso_r2w <span class="co">#This shows the percentage of the total variance explained by just the first and second axes</span></span>
<span id="cb35-1373"><a href="#cb35-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1374"><a href="#cb35-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1375"><a href="#cb35-1375" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1376"><a href="#cb35-1376" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_endo1<span class="ot">=</span> <span class="fu">ordinate</span>(endo1_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1377"><a href="#cb35-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_endo1<span class="sc">$</span>stress))</span>
<span id="cb35-1378"><a href="#cb35-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1379"><a href="#cb35-1379" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_endo1 <span class="ot">=</span> <span class="fu">ordinate</span>(endo1_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1380"><a href="#cb35-1380" aria-hidden="true" tabindex="-1"></a>peso_e1w<span class="ot">=</span>PCOA_wuni_endo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb35-1381"><a href="#cb35-1381" aria-hidden="true" tabindex="-1"></a>peso_e1w</span>
<span id="cb35-1382"><a href="#cb35-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1383"><a href="#cb35-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1384"><a href="#cb35-1384" aria-hidden="true" tabindex="-1"></a>NMDS_wuni_endo2<span class="ot">=</span> <span class="fu">ordinate</span>(endo2_normalized_phyloseq, <span class="st">"NMDS"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1385"><a href="#cb35-1385" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"The stress of the NMDS based on Weighted Unifrac is:"</span>, NMDS_wuni_endo2<span class="sc">$</span>stress))</span>
<span id="cb35-1386"><a href="#cb35-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1387"><a href="#cb35-1387" aria-hidden="true" tabindex="-1"></a>PCOA_wuni_endo2 <span class="ot">=</span> <span class="fu">ordinate</span>(endo2_normalized_phyloseq, <span class="st">"PCoA"</span>, <span class="st">"wunifrac"</span>)</span>
<span id="cb35-1388"><a href="#cb35-1388" aria-hidden="true" tabindex="-1"></a>peso_e2w<span class="ot">=</span>PCOA_wuni_endo1<span class="sc">$</span>values<span class="sc">$</span>Relative_eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb35-1389"><a href="#cb35-1389" aria-hidden="true" tabindex="-1"></a>peso_e2w</span>
<span id="cb35-1390"><a href="#cb35-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1391"><a href="#cb35-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1392"><a href="#cb35-1392" aria-hidden="true" tabindex="-1"></a>Once these values of stress and the weight of the axes are obtained, we should choose which option is the most suitable for our dataset. Although you can also use both method in your research paper. In this case, we selected PCoA plots because we obtained relatively high values of NMDS stress (<span class="sc">\&gt;</span>0.13). It is easy to understand: our data are probably multidimensional are complex due to the high diversity and richness of the data, so it is easy to have high stress when forcing the data to fit just into two dimensions.</span>
<span id="cb35-1393"><a href="#cb35-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1394"><a href="#cb35-1394" aria-hidden="true" tabindex="-1"></a>Let's obtain the plot:</span>
<span id="cb35-1395"><a href="#cb35-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1398"><a href="#cb35-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1399"><a href="#cb35-1399" aria-hidden="true" tabindex="-1"></a><span class="co">#a)RHIZOSPHERE</span></span>
<span id="cb35-1400"><a href="#cb35-1400" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1401"><a href="#cb35-1401" aria-hidden="true" tabindex="-1"></a>p_rizo1_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(rizo1_normalized_phyloseq, PCOA_wuni_rizo1,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span><span class="co">#to color by "Condition" and shape by "Year"</span></span>
<span id="cb35-1402"><a href="#cb35-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1403"><a href="#cb35-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1404"><a href="#cb35-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb35-1405"><a href="#cb35-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_r1w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), <span class="co">#write the weight of each axis with two decimals</span></span>
<span id="cb35-1406"><a href="#cb35-1406" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_r1w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb35-1407"><a href="#cb35-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"cornflowerblue"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"darkgreen"</span>),</span>
<span id="cb35-1408"><a href="#cb35-1408" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb35-1409"><a href="#cb35-1409" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb35-1410"><a href="#cb35-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb35-1411"><a href="#cb35-1411" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb35-1412"><a href="#cb35-1412" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb35-1413"><a href="#cb35-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1414"><a href="#cb35-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1415"><a href="#cb35-1415" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1416"><a href="#cb35-1416" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1417"><a href="#cb35-1417" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1418"><a href="#cb35-1418" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1419"><a href="#cb35-1419" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb35-1420"><a href="#cb35-1420" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1421"><a href="#cb35-1421" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1422"><a href="#cb35-1422" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1423"><a href="#cb35-1423" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb35-1424"><a href="#cb35-1424" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1425"><a href="#cb35-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"South Plot"</span>)<span class="sc">+</span></span>
<span id="cb35-1426"><a href="#cb35-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1427"><a href="#cb35-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1428"><a href="#cb35-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb35-1429"><a href="#cb35-1429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.15</span>, <span class="fl">0.1</span>))</span>
<span id="cb35-1430"><a href="#cb35-1430" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1431"><a href="#cb35-1431" aria-hidden="true" tabindex="-1"></a>p_rizo1_pcoa</span>
<span id="cb35-1432"><a href="#cb35-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1433"><a href="#cb35-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-1434"><a href="#cb35-1434" aria-hidden="true" tabindex="-1"></a>p_rizo2_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(rizo2_normalized_phyloseq, PCOA_wuni_rizo2,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb35-1435"><a href="#cb35-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1436"><a href="#cb35-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1437"><a href="#cb35-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb35-1438"><a href="#cb35-1438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_r2w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb35-1439"><a href="#cb35-1439" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_r2w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb35-1440"><a href="#cb35-1440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"magenta"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"darkolivegreen2"</span>),</span>
<span id="cb35-1441"><a href="#cb35-1441" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb35-1442"><a href="#cb35-1442" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb35-1443"><a href="#cb35-1443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb35-1444"><a href="#cb35-1444" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb35-1445"><a href="#cb35-1445" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb35-1446"><a href="#cb35-1446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1447"><a href="#cb35-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1448"><a href="#cb35-1448" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1449"><a href="#cb35-1449" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1450"><a href="#cb35-1450" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1451"><a href="#cb35-1451" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1452"><a href="#cb35-1452" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb35-1453"><a href="#cb35-1453" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1454"><a href="#cb35-1454" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1455"><a href="#cb35-1455" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1456"><a href="#cb35-1456" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb35-1457"><a href="#cb35-1457" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1458"><a href="#cb35-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"North Plot"</span>)<span class="sc">+</span></span>
<span id="cb35-1459"><a href="#cb35-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1460"><a href="#cb35-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1461"><a href="#cb35-1461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb35-1462"><a href="#cb35-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.15</span>))</span>
<span id="cb35-1463"><a href="#cb35-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1464"><a href="#cb35-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1465"><a href="#cb35-1465" aria-hidden="true" tabindex="-1"></a>p_rizo2_pcoa</span>
<span id="cb35-1466"><a href="#cb35-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1467"><a href="#cb35-1467" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1468"><a href="#cb35-1468" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1469"><a href="#cb35-1469" aria-hidden="true" tabindex="-1"></a>p_endo1_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(endo1_normalized_phyloseq, PCOA_wuni_endo1,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb35-1470"><a href="#cb35-1470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1471"><a href="#cb35-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1472"><a href="#cb35-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb35-1473"><a href="#cb35-1473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_e1w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb35-1474"><a href="#cb35-1474" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_e1w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb35-1475"><a href="#cb35-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"#00CCFF"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"green"</span>),</span>
<span id="cb35-1476"><a href="#cb35-1476" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb35-1477"><a href="#cb35-1477" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb35-1478"><a href="#cb35-1478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb35-1479"><a href="#cb35-1479" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb35-1480"><a href="#cb35-1480" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb35-1481"><a href="#cb35-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1482"><a href="#cb35-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1483"><a href="#cb35-1483" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1484"><a href="#cb35-1484" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1485"><a href="#cb35-1485" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1486"><a href="#cb35-1486" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1487"><a href="#cb35-1487" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb35-1488"><a href="#cb35-1488" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1489"><a href="#cb35-1489" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1490"><a href="#cb35-1490" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1491"><a href="#cb35-1491" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb35-1492"><a href="#cb35-1492" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-1493"><a href="#cb35-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"South Plot"</span>)<span class="sc">+</span></span>
<span id="cb35-1494"><a href="#cb35-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1495"><a href="#cb35-1495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1496"><a href="#cb35-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb35-1497"><a href="#cb35-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>))</span>
<span id="cb35-1498"><a href="#cb35-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1499"><a href="#cb35-1499" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1500"><a href="#cb35-1500" aria-hidden="true" tabindex="-1"></a>p_endo1_pcoa</span>
<span id="cb35-1501"><a href="#cb35-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1502"><a href="#cb35-1502" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1503"><a href="#cb35-1503" aria-hidden="true" tabindex="-1"></a>p_endo2_pcoa<span class="ot">=</span> <span class="fu">plot_ordination</span>(endo2_normalized_phyloseq, PCOA_wuni_endo2,<span class="at">type=</span> <span class="st">"samples"</span>, <span class="at">color=</span> <span class="st">"Condition"</span>, <span class="at">shape =</span> <span class="st">"Year"</span>)<span class="sc">+</span></span>
<span id="cb35-1504"><a href="#cb35-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1505"><a href="#cb35-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">0.00</span>)), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">"grey"</span>)<span class="sc">+</span></span>
<span id="cb35-1506"><a href="#cb35-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb35-1507"><a href="#cb35-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"Axis 1 ("</span>,<span class="fu">round</span>(peso_e2w[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>), </span>
<span id="cb35-1508"><a href="#cb35-1508" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"Axis 2 ("</span>,<span class="fu">round</span>(peso_e2w[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="at">digits =</span> <span class="dv">2</span>),<span class="st">"%)"</span>))<span class="sc">+</span></span>
<span id="cb35-1509"><a href="#cb35-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Immature"</span><span class="ot">=</span><span class="st">"blueviolet"</span>,<span class="st">"Mature"</span><span class="ot">=</span><span class="st">"aquamarine"</span>),</span>
<span id="cb35-1510"><a href="#cb35-1510" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Immature"</span>, <span class="st">"Mature"</span>),</span>
<span id="cb35-1511"><a href="#cb35-1511" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>))<span class="sc">+</span></span>
<span id="cb35-1512"><a href="#cb35-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"A"</span><span class="ot">=</span><span class="dv">16</span>, <span class="st">"B"</span><span class="ot">=</span><span class="dv">17</span>),</span>
<span id="cb35-1513"><a href="#cb35-1513" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb35-1514"><a href="#cb35-1514" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"2022"</span>, <span class="st">"2023"</span>))<span class="sc">+</span></span>
<span id="cb35-1515"><a href="#cb35-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1516"><a href="#cb35-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1517"><a href="#cb35-1517" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1518"><a href="#cb35-1518" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1519"><a href="#cb35-1519" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb35-1520"><a href="#cb35-1520" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>,</span>
<span id="cb35-1521"><a href="#cb35-1521" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">7</span>),</span>
<span id="cb35-1522"><a href="#cb35-1522" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1523"><a href="#cb35-1523" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>, <span class="at">face=</span><span class="st">"bold"</span>,<span class="at">size=</span><span class="dv">5</span>),</span>
<span id="cb35-1524"><a href="#cb35-1524" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>),</span>
<span id="cb35-1525"><a href="#cb35-1525" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> </span>
<span id="cb35-1526"><a href="#cb35-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"North Plot"</span>)<span class="sc">+</span></span>
<span id="cb35-1527"><a href="#cb35-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1528"><a href="#cb35-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb35-1529"><a href="#cb35-1529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb35-1530"><a href="#cb35-1530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.3</span>))</span>
<span id="cb35-1531"><a href="#cb35-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1532"><a href="#cb35-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1533"><a href="#cb35-1533" aria-hidden="true" tabindex="-1"></a>p_endo2_pcoa</span>
<span id="cb35-1534"><a href="#cb35-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1535"><a href="#cb35-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1536"><a href="#cb35-1536" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6. Taxonomical profiles</span></span>
<span id="cb35-1537"><a href="#cb35-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1538"><a href="#cb35-1538" aria-hidden="true" tabindex="-1"></a>We already know that there are differences in the structure of bacterial communities in some case, however, we still do not know which taxa are the responsible of that differences. So, let's analyze the taxonomical profiles. Fistly, we have to obtain the relative abundance of each ASV:</span>
<span id="cb35-1539"><a href="#cb35-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1542"><a href="#cb35-1542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1543"><a href="#cb35-1543" aria-hidden="true" tabindex="-1"></a>phy_data_relabun<span class="ot">=</span><span class="fu">transform_sample_counts</span>(phy_total, <span class="cf">function</span>(x){x<span class="sc">/</span><span class="fu">sum</span>(x)}<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb35-1544"><a href="#cb35-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phy_data_relabun))<span class="co">#check that all sum 100%</span></span>
<span id="cb35-1545"><a href="#cb35-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1546"><a href="#cb35-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1547"><a href="#cb35-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.1 Phylum level</span></span>
<span id="cb35-1548"><a href="#cb35-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1549"><a href="#cb35-1549" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.1. Obtaining tables with the relative abundance and standard deviation values</span></span>
<span id="cb35-1550"><a href="#cb35-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1551"><a href="#cb35-1551" aria-hidden="true" tabindex="-1"></a>We are going to obtain the relative abundance of each phylum detected in our samples.</span>
<span id="cb35-1552"><a href="#cb35-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1555"><a href="#cb35-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1556"><a href="#cb35-1556" aria-hidden="true" tabindex="-1"></a>phylum_relabun<span class="ot">=</span><span class="fu">tax_glom</span>(phy_data_relabun, <span class="at">taxrank =</span> <span class="st">"Phylum"</span>)<span class="co">#aglomerate at Phylum level</span></span>
<span id="cb35-1557"><a href="#cb35-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(phylum_relabun)) <span class="co">#check that the relative abundance sums 100% in all cases</span></span>
<span id="cb35-1558"><a href="#cb35-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1559"><a href="#cb35-1559" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we are going to create a table with the relative abundance of each taxa in each replicate so that we can work on it, for instance, in Excel</span></span>
<span id="cb35-1560"><a href="#cb35-1560" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(phylum_relabun))</span>
<span id="cb35-1561"><a href="#cb35-1561" aria-hidden="true" tabindex="-1"></a>aa<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">tax_table</span>(phylum_relabun),a)</span>
<span id="cb35-1562"><a href="#cb35-1562" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(a),<span class="fu">rownames</span>(aa))<span class="co">#it should give "TRUE"</span></span>
<span id="cb35-1563"><a href="#cb35-1563" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(aa),aa),<span class="at">file=</span><span class="st">"abundrel_phylum_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-1564"><a href="#cb35-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1565"><a href="#cb35-1565" aria-hidden="true" tabindex="-1"></a><span class="co">#Another table, with the mean and standard deviation of the relative abundance of each phylum:</span></span>
<span id="cb35-1566"><a href="#cb35-1566" aria-hidden="true" tabindex="-1"></a>table_phylum <span class="ot">=</span> a[,] <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb35-1567"><a href="#cb35-1567" aria-hidden="true" tabindex="-1"></a>tax_phylum<span class="ot">=</span><span class="fu">tax_table</span>(phylum_relabun)</span>
<span id="cb35-1568"><a href="#cb35-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1569"><a href="#cb35-1569" aria-hidden="true" tabindex="-1"></a>phylum_media<span class="ot">=</span><span class="fu">aggregate</span>(table_phylum, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phylum_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>mean)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>) <span class="sc">%&gt;%</span> <span class="fu">t</span>()<span class="co">#calculate the mean values of the relative abundance of each phylum in each group of samples </span></span>
<span id="cb35-1570"><a href="#cb35-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1571"><a href="#cb35-1571" aria-hidden="true" tabindex="-1"></a>phylum_sd <span class="ot">=</span><span class="fu">aggregate</span>(table_phylum, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phylum_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>sd)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">t</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb35-1572"><a href="#cb35-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="at">.fn=</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(phylum_media), <span class="st">"_SD"</span>))<span class="co">#calculate the standard deviation of the relative abundance of each phylum in each group of samples </span></span>
<span id="cb35-1573"><a href="#cb35-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1574"><a href="#cb35-1574" aria-hidden="true" tabindex="-1"></a>phylum_media_sd<span class="ot">=</span><span class="fu">merge</span>(tax_phylum, phylum_media, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span><span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-1575"><a href="#cb35-1575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(phylum_sd, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>)<span class="co">#bind mean and sd values into one table</span></span>
<span id="cb35-1576"><a href="#cb35-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1577"><a href="#cb35-1577" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(phylum_media_sd),phylum_media_sd), <span class="at">file=</span><span class="st">"abundrel_media_sd_phylum.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-1578"><a href="#cb35-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1579"><a href="#cb35-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1580"><a href="#cb35-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1.2. Plotting</span></span>
<span id="cb35-1581"><a href="#cb35-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1582"><a href="#cb35-1582" aria-hidden="true" tabindex="-1"></a>We are going to make a stacked bars plot, just indicating the most abundant phyla</span>
<span id="cb35-1583"><a href="#cb35-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1584"><a href="#cb35-1584" aria-hidden="true" tabindex="-1"></a>Firstly, we have to prepare the data and modify the table so that we can obtain tables suitable for the plotting with the package ggplot2.</span>
<span id="cb35-1585"><a href="#cb35-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1588"><a href="#cb35-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1589"><a href="#cb35-1589" aria-hidden="true" tabindex="-1"></a>df_melt_phylum <span class="ot">=</span> <span class="fu">psmelt</span>(<span class="at">physeq =</span> phylum_relabun) <span class="co">#transform the phyloseq object into a dataframe in which the abundance of each phylum is in rows</span></span>
<span id="cb35-1590"><a href="#cb35-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_phylum) <span class="co"># check the content of the dataframe</span></span>
<span id="cb35-1591"><a href="#cb35-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1592"><a href="#cb35-1592" aria-hidden="true" tabindex="-1"></a><span class="co">#Here we aggregate the data by the factor we indicate in the argument "by".</span></span>
<span id="cb35-1593"><a href="#cb35-1593" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg1 <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_phylum<span class="sc">$</span>Abundance, </span>
<span id="cb35-1594"><a href="#cb35-1594" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_phylum<span class="sc">$</span>Fusion, </span>
<span id="cb35-1595"><a href="#cb35-1595" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sample=</span>df_melt_phylum<span class="sc">$</span>Sample,<span class="at">Phylum=</span>df_melt_phylum<span class="sc">$</span>Phylum,</span>
<span id="cb35-1596"><a href="#cb35-1596" aria-hidden="true" tabindex="-1"></a>                                                              <span class="at">Compartment=</span>df_melt_phylum<span class="sc">$</span>Compartment,</span>
<span id="cb35-1597"><a href="#cb35-1597" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Plot=</span>df_melt_phylum<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_phylum<span class="sc">$</span>Year, <span class="at">Condition=</span>df_melt_phylum<span class="sc">$</span>Condition), <span class="at">FUN=</span>sum)<span class="co">#it sums the abundance of each phylum in all the replicates corresponding to the same group of samples</span></span>
<span id="cb35-1598"><a href="#cb35-1598" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Sample"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)<span class="co">#rename the columns</span></span>
<span id="cb35-1599"><a href="#cb35-1599" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg1)</span>
<span id="cb35-1600"><a href="#cb35-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1601"><a href="#cb35-1601" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_aggreg1<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg1<span class="sc">$</span>Group, </span>
<span id="cb35-1602"><a href="#cb35-1602" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Phylum=</span>df_melt_aggreg1<span class="sc">$</span>Phylum,</span>
<span id="cb35-1603"><a href="#cb35-1603" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Compartment=</span>df_melt_aggreg1<span class="sc">$</span>Compartment,</span>
<span id="cb35-1604"><a href="#cb35-1604" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Plot=</span>df_melt_aggreg1<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg1<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg1<span class="sc">$</span>Condition), <span class="at">FUN=</span>mean)<span class="co">#now, it makes the mean relative abundance of each phylum in each group of samples</span></span>
<span id="cb35-1605"><a href="#cb35-1605" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>, <span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb35-1606"><a href="#cb35-1606" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)</span>
<span id="cb35-1607"><a href="#cb35-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1608"><a href="#cb35-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1609"><a href="#cb35-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#repeat the same with the standard deviation</span></span>
<span id="cb35-1610"><a href="#cb35-1610" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_sd<span class="ot">=</span><span class="fu">aggregate</span>(df_melt_aggreg1<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg1<span class="sc">$</span>Group, </span>
<span id="cb35-1611"><a href="#cb35-1611" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Phylum=</span>df_melt_aggreg1<span class="sc">$</span>Phylum,</span>
<span id="cb35-1612"><a href="#cb35-1612" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Compartment=</span>df_melt_aggreg1<span class="sc">$</span>Compartment,</span>
<span id="cb35-1613"><a href="#cb35-1613" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Plot=</span>df_melt_aggreg1<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg1<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg1<span class="sc">$</span>Condition), <span class="at">FUN=</span>sd)</span>
<span id="cb35-1614"><a href="#cb35-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_sd)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Phylum"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"sd"</span>)</span>
<span id="cb35-1615"><a href="#cb35-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1616"><a href="#cb35-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1617"><a href="#cb35-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#check whether the groups of samples and the name of the phyla is the same in both mean and sd table</span></span>
<span id="cb35-1618"><a href="#cb35-1618" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Group<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Group)<span class="co">#it should give "TRUE"</span></span>
<span id="cb35-1619"><a href="#cb35-1619" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Phylum<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Phylum)</span>
<span id="cb35-1620"><a href="#cb35-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1621"><a href="#cb35-1621" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, add the sd values in the table of mean values</span></span>
<span id="cb35-1622"><a href="#cb35-1622" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean<span class="sc">$</span>sd<span class="ot">=</span>df_melt_aggreg_sd<span class="sc">$</span>sd </span>
<span id="cb35-1623"><a href="#cb35-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1624"><a href="#cb35-1624" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_todos<span class="ot">=</span>df_melt_aggreg_mean</span>
<span id="cb35-1625"><a href="#cb35-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1626"><a href="#cb35-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1627"><a href="#cb35-1627" aria-hidden="true" tabindex="-1"></a>Now, we are ready to plot the mean relative abundances. We want to order the phyla by ascending relative abundance, keeping the unclassified and minor phyla in the upper part of the plot.</span>
<span id="cb35-1628"><a href="#cb35-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1631"><a href="#cb35-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1632"><a href="#cb35-1632" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1633"><a href="#cb35-1633" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1634"><a href="#cb35-1634" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]<span class="co">#subset the dataset</span></span>
<span id="cb35-1635"><a href="#cb35-1635" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo[media_sd_phylum_Rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb35-1636"><a href="#cb35-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1637"><a href="#cb35-1637" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate all the phyla that were not classified</span></span>
<span id="cb35-1638"><a href="#cb35-1638" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1639"><a href="#cb35-1639" aria-hidden="true" tabindex="-1"></a>unclassified_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] <span class="co">#save them into a new variable</span></span>
<span id="cb35-1640"><a href="#cb35-1640" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] <span class="co">#remove the unclassified phyla from the original dataset</span></span>
<span id="cb35-1641"><a href="#cb35-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1642"><a href="#cb35-1642" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate all the phyla that account less than 1% into an artificial group named "Other phyla &lt;1%"</span></span>
<span id="cb35-1643"><a href="#cb35-1643" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum[media_sd_phylum_Rizo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span></span>
<span id="cb35-1644"><a href="#cb35-1644" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1645"><a href="#cb35-1645" aria-hidden="true" tabindex="-1"></a>others_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]<span class="co">#save the "other phyla" into a new variable</span></span>
<span id="cb35-1646"><a href="#cb35-1646" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[media_sd_phylum_Rizo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]<span class="co">#remove them from the original dataset</span></span>
<span id="cb35-1647"><a href="#cb35-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1648"><a href="#cb35-1648" aria-hidden="true" tabindex="-1"></a><span class="co">#Now, the minor and unclassified phyla are not included in the original dataset, so let's order by abundance the remaining phyla</span></span>
<span id="cb35-1649"><a href="#cb35-1649" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="ot">=</span>media_sd_phylum_Rizo1[<span class="fu">order</span>(media_sd_phylum_Rizo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] <span class="co">#order by relative abundance</span></span>
<span id="cb35-1650"><a href="#cb35-1650" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_rizo1,others_rizo1,unclassified_rizo1)<span class="co">#now add the minor phyla and the unclassified</span></span>
<span id="cb35-1651"><a href="#cb35-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1652"><a href="#cb35-1652" aria-hidden="true" tabindex="-1"></a>group_label_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mature"</span>,<span class="st">"Immature"</span>, <span class="st">"Mature"</span>,<span class="st">"Immature"</span>)<span class="co">#set the labels</span></span>
<span id="cb35-1653"><a href="#cb35-1653" aria-hidden="true" tabindex="-1"></a>levels_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,<span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)<span class="co">#set the levels of the graph</span></span>
<span id="cb35-1654"><a href="#cb35-1654" aria-hidden="true" tabindex="-1"></a>limits_rizo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,<span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)<span class="co">#set the limits of the graph</span></span>
<span id="cb35-1655"><a href="#cb35-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1656"><a href="#cb35-1656" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_rizo1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_rizo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1657"><a href="#cb35-1657" aria-hidden="true" tabindex="-1"></a>nombres_unicos_rizo1<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_rizo1)<span class="co">#get the levels (=the names of the phyla )of the factor "Phylum", and show them just once regardless of their abundance and prevalence)</span></span>
<span id="cb35-1658"><a href="#cb35-1658" aria-hidden="true" tabindex="-1"></a>ordenado_rizo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_rizo1<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_rizo1))<span class="co">#order the name of the phyla</span></span>
<span id="cb35-1659"><a href="#cb35-1659" aria-hidden="true" tabindex="-1"></a>lab_unicos_rizo1<span class="ot">=</span>nombres_unicos_rizo1 </span>
<span id="cb35-1660"><a href="#cb35-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1661"><a href="#cb35-1661" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_rizo1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_rizo1,</span>
<span id="cb35-1662"><a href="#cb35-1662" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb35-1663"><a href="#cb35-1663" aria-hidden="true" tabindex="-1"></a>                                    {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-1664"><a href="#cb35-1664" aria-hidden="true" tabindex="-1"></a><span class="co">#this function helps us to write the name of the phyla (and genera) in italics and the name of the minor phyla and unclassified without italics</span></span>
<span id="cb35-1665"><a href="#cb35-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1666"><a href="#cb35-1666" aria-hidden="true" tabindex="-1"></a>colores_rizo1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>, <span class="st">"#9933FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"red"</span>, <span class="st">"brown"</span>,<span class="st">"#FF00FF"</span>,<span class="st">"darkolivegreen"</span>,</span>
<span id="cb35-1667"><a href="#cb35-1667" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#FFFF00"</span>,<span class="st">"grey"</span>, <span class="st">"black"</span>)<span class="co">#choose the colors of specific phyla</span></span>
<span id="cb35-1668"><a href="#cb35-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1669"><a href="#cb35-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo1)<span class="sc">==</span><span class="fu">length</span>(colores_rizo1)  <span class="co">#in case of "FALSE", check the number of phyla and the number of colors. Establish as many colors as number of phyla (including the groups of minor and unclassified phyla)</span></span>
<span id="cb35-1670"><a href="#cb35-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo1)</span>
<span id="cb35-1671"><a href="#cb35-1671" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_rizo1)</span>
<span id="cb35-1672"><a href="#cb35-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1673"><a href="#cb35-1673" aria-hidden="true" tabindex="-1"></a>titulo_plot_rizo1<span class="ot">=</span><span class="st">"Plot 1"</span></span>
<span id="cb35-1674"><a href="#cb35-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1675"><a href="#cb35-1675" aria-hidden="true" tabindex="-1"></a>p_rizo_1_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_rizo1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-1676"><a href="#cb35-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_rizo1,</span>
<span id="cb35-1677"><a href="#cb35-1677" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_rizo1,</span>
<span id="cb35-1678"><a href="#cb35-1678" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_rizo1)<span class="sc">+</span></span>
<span id="cb35-1679"><a href="#cb35-1679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_rizo1)<span class="sc">+</span></span>
<span id="cb35-1680"><a href="#cb35-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-1681"><a href="#cb35-1681" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_rizo1,<span class="at">labels=</span>group_label_rizo1,</span>
<span id="cb35-1682"><a href="#cb35-1682" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span>levels_rizo1)<span class="sc">+</span></span>
<span id="cb35-1683"><a href="#cb35-1683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-1684"><a href="#cb35-1684" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-1685"><a href="#cb35-1685" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-1686"><a href="#cb35-1686" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-1687"><a href="#cb35-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1688"><a href="#cb35-1688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-1689"><a href="#cb35-1689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-1690"><a href="#cb35-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1691"><a href="#cb35-1691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-1692"><a href="#cb35-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1693"><a href="#cb35-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1694"><a href="#cb35-1694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-1695"><a href="#cb35-1695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-1696"><a href="#cb35-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-1697"><a href="#cb35-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-1698"><a href="#cb35-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb35-1699"><a href="#cb35-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1700"><a href="#cb35-1700" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1701"><a href="#cb35-1701" aria-hidden="true" tabindex="-1"></a>p_rizo_1_phylum</span>
<span id="cb35-1702"><a href="#cb35-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1703"><a href="#cb35-1703" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-1704"><a href="#cb35-1704" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]</span>
<span id="cb35-1705"><a href="#cb35-1705" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo[media_sd_phylum_Rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb35-1706"><a href="#cb35-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1707"><a href="#cb35-1707" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1708"><a href="#cb35-1708" aria-hidden="true" tabindex="-1"></a>unclassified_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1709"><a href="#cb35-1709" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1710"><a href="#cb35-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1711"><a href="#cb35-1711" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum[media_sd_phylum_Rizo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb35-1712"><a href="#cb35-1712" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1713"><a href="#cb35-1713" aria-hidden="true" tabindex="-1"></a>others_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1714"><a href="#cb35-1714" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[media_sd_phylum_Rizo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1715"><a href="#cb35-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1716"><a href="#cb35-1716" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="ot">=</span>media_sd_phylum_Rizo2[<span class="fu">order</span>(media_sd_phylum_Rizo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-1717"><a href="#cb35-1717" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_rizo2,others_rizo2,unclassified_rizo2)</span>
<span id="cb35-1718"><a href="#cb35-1718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1719"><a href="#cb35-1719" aria-hidden="true" tabindex="-1"></a>group_label_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mature"</span>,<span class="st">"Immature"</span>, <span class="st">"Mature"</span>,<span class="st">"Immature"</span>)</span>
<span id="cb35-1720"><a href="#cb35-1720" aria-hidden="true" tabindex="-1"></a>levels_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,<span class="st">"B_Plot2_Mature_Rhizosphere"</span>,</span>
<span id="cb35-1721"><a href="#cb35-1721" aria-hidden="true" tabindex="-1"></a>               <span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb35-1722"><a href="#cb35-1722" aria-hidden="true" tabindex="-1"></a>limits_rizo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,<span class="st">"B_Plot2_Mature_Rhizosphere"</span>,</span>
<span id="cb35-1723"><a href="#cb35-1723" aria-hidden="true" tabindex="-1"></a>               <span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb35-1724"><a href="#cb35-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1725"><a href="#cb35-1725" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_rizo2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_rizo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1726"><a href="#cb35-1726" aria-hidden="true" tabindex="-1"></a>nombres_unicos_rizo2<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_rizo2)</span>
<span id="cb35-1727"><a href="#cb35-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1728"><a href="#cb35-1728" aria-hidden="true" tabindex="-1"></a>ordenado_rizo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_rizo2<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_rizo2))</span>
<span id="cb35-1729"><a href="#cb35-1729" aria-hidden="true" tabindex="-1"></a>lab_unicos_rizo2<span class="ot">=</span>nombres_unicos_rizo2</span>
<span id="cb35-1730"><a href="#cb35-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1731"><a href="#cb35-1731" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_rizo2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_rizo2,</span>
<span id="cb35-1732"><a href="#cb35-1732" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb35-1733"><a href="#cb35-1733" aria-hidden="true" tabindex="-1"></a>                                     {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-1734"><a href="#cb35-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1735"><a href="#cb35-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1736"><a href="#cb35-1736" aria-hidden="true" tabindex="-1"></a>colores_rizo2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>, <span class="st">"#00CC00"</span>, <span class="st">"#9933FF"</span>,<span class="st">"red"</span>,<span class="st">"#FF00FF"</span>,</span>
<span id="cb35-1737"><a href="#cb35-1737" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"brown"</span>,<span class="st">"#FFFF00"</span>,<span class="st">"blue"</span>,<span class="st">"grey"</span>, <span class="st">"black"</span>)</span>
<span id="cb35-1738"><a href="#cb35-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1739"><a href="#cb35-1739" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo2)<span class="sc">==</span><span class="fu">length</span>(colores_rizo2) </span>
<span id="cb35-1740"><a href="#cb35-1740" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_rizo2)</span>
<span id="cb35-1741"><a href="#cb35-1741" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_rizo2)</span>
<span id="cb35-1742"><a href="#cb35-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1743"><a href="#cb35-1743" aria-hidden="true" tabindex="-1"></a>titulo_plot_rizo2<span class="ot">=</span><span class="st">"Plot 2"</span></span>
<span id="cb35-1744"><a href="#cb35-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1745"><a href="#cb35-1745" aria-hidden="true" tabindex="-1"></a>p_rizo_2_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_rizo2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-1746"><a href="#cb35-1746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_rizo2,</span>
<span id="cb35-1747"><a href="#cb35-1747" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_rizo2,</span>
<span id="cb35-1748"><a href="#cb35-1748" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_rizo2)<span class="sc">+</span></span>
<span id="cb35-1749"><a href="#cb35-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_rizo2)<span class="sc">+</span></span>
<span id="cb35-1750"><a href="#cb35-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-1751"><a href="#cb35-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_rizo2,<span class="at">labels=</span>group_label_rizo2,</span>
<span id="cb35-1752"><a href="#cb35-1752" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_rizo2)<span class="sc">+</span></span>
<span id="cb35-1753"><a href="#cb35-1753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-1754"><a href="#cb35-1754" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-1755"><a href="#cb35-1755" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-1756"><a href="#cb35-1756" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-1757"><a href="#cb35-1757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1758"><a href="#cb35-1758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-1759"><a href="#cb35-1759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-1760"><a href="#cb35-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1761"><a href="#cb35-1761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-1762"><a href="#cb35-1762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1763"><a href="#cb35-1763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1764"><a href="#cb35-1764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-1765"><a href="#cb35-1765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-1766"><a href="#cb35-1766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-1767"><a href="#cb35-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-1768"><a href="#cb35-1768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb35-1769"><a href="#cb35-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1770"><a href="#cb35-1770" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1771"><a href="#cb35-1771" aria-hidden="true" tabindex="-1"></a>p_rizo_2_phylum</span>
<span id="cb35-1772"><a href="#cb35-1772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1773"><a href="#cb35-1773" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-1774"><a href="#cb35-1774" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo<span class="ot">=</span>media_sd_phylum_todos[media_sd_phylum_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Endosphere"</span>,]</span>
<span id="cb35-1775"><a href="#cb35-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1776"><a href="#cb35-1776" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-1777"><a href="#cb35-1777" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo[media_sd_phylum_Endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb35-1778"><a href="#cb35-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1779"><a href="#cb35-1779" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Endo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1780"><a href="#cb35-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1781"><a href="#cb35-1781" aria-hidden="true" tabindex="-1"></a>unclassified_endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1782"><a href="#cb35-1782" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1783"><a href="#cb35-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1784"><a href="#cb35-1784" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum[media_sd_phylum_Endo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb35-1785"><a href="#cb35-1785" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Endo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1786"><a href="#cb35-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1787"><a href="#cb35-1787" aria-hidden="true" tabindex="-1"></a>others_endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1788"><a href="#cb35-1788" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo1<span class="ot">=</span>media_sd_phylum_Endo1[media_sd_phylum_Endo1[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1789"><a href="#cb35-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1790"><a href="#cb35-1790" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="ot">=</span>media_sd_phylum_Endo1[<span class="fu">order</span>(media_sd_phylum_Endo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-1791"><a href="#cb35-1791" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_endo1,others_endo1,unclassified_endo1)</span>
<span id="cb35-1792"><a href="#cb35-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1793"><a href="#cb35-1793" aria-hidden="true" tabindex="-1"></a>group_label_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>)</span>
<span id="cb35-1794"><a href="#cb35-1794" aria-hidden="true" tabindex="-1"></a>levels_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,<span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb35-1795"><a href="#cb35-1795" aria-hidden="true" tabindex="-1"></a>limits_endo1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,<span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb35-1796"><a href="#cb35-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1797"><a href="#cb35-1797" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_endo1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_endo1<span class="sc">$</span>Phylum)</span>
<span id="cb35-1798"><a href="#cb35-1798" aria-hidden="true" tabindex="-1"></a>nombres_unicos_endo1<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_endo1)</span>
<span id="cb35-1799"><a href="#cb35-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1800"><a href="#cb35-1800" aria-hidden="true" tabindex="-1"></a>ordenado_endo1<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_endo1<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_endo1))</span>
<span id="cb35-1801"><a href="#cb35-1801" aria-hidden="true" tabindex="-1"></a>lab_unicos_endo1<span class="ot">=</span>nombres_unicos_endo1 </span>
<span id="cb35-1802"><a href="#cb35-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1803"><a href="#cb35-1803" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_endo1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_endo1,</span>
<span id="cb35-1804"><a href="#cb35-1804" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb35-1805"><a href="#cb35-1805" aria-hidden="true" tabindex="-1"></a>                                    {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-1806"><a href="#cb35-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1807"><a href="#cb35-1807" aria-hidden="true" tabindex="-1"></a>colores_endo1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"brown"</span>,<span class="st">"yellow"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"red"</span>, <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-1808"><a href="#cb35-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1809"><a href="#cb35-1809" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo1)<span class="sc">==</span><span class="fu">length</span>(colores_endo1) </span>
<span id="cb35-1810"><a href="#cb35-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo1)</span>
<span id="cb35-1811"><a href="#cb35-1811" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_endo1)</span>
<span id="cb35-1812"><a href="#cb35-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1813"><a href="#cb35-1813" aria-hidden="true" tabindex="-1"></a>titulo_plot_endo1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb35-1814"><a href="#cb35-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1815"><a href="#cb35-1815" aria-hidden="true" tabindex="-1"></a>p_endo1_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_endo1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-1816"><a href="#cb35-1816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_endo1,</span>
<span id="cb35-1817"><a href="#cb35-1817" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_endo1,</span>
<span id="cb35-1818"><a href="#cb35-1818" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_endo1)<span class="sc">+</span></span>
<span id="cb35-1819"><a href="#cb35-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_endo1)<span class="sc">+</span></span>
<span id="cb35-1820"><a href="#cb35-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-1821"><a href="#cb35-1821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_endo1,<span class="at">labels=</span>group_label_endo1,</span>
<span id="cb35-1822"><a href="#cb35-1822" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_endo1)<span class="sc">+</span></span>
<span id="cb35-1823"><a href="#cb35-1823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-1824"><a href="#cb35-1824" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-1825"><a href="#cb35-1825" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-1826"><a href="#cb35-1826" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-1827"><a href="#cb35-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1828"><a href="#cb35-1828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-1829"><a href="#cb35-1829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-1830"><a href="#cb35-1830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1831"><a href="#cb35-1831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-1832"><a href="#cb35-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1833"><a href="#cb35-1833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1834"><a href="#cb35-1834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-1835"><a href="#cb35-1835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-1836"><a href="#cb35-1836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-1837"><a href="#cb35-1837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-1838"><a href="#cb35-1838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>) </span>
<span id="cb35-1839"><a href="#cb35-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1840"><a href="#cb35-1840" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1841"><a href="#cb35-1841" aria-hidden="true" tabindex="-1"></a>p_endo1_phylum</span>
<span id="cb35-1842"><a href="#cb35-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1843"><a href="#cb35-1843" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-1844"><a href="#cb35-1844" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo[media_sd_phylum_Endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb35-1845"><a href="#cb35-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1846"><a href="#cb35-1846" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.character</span>(media_sd_phylum_Endo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1847"><a href="#cb35-1847" aria-hidden="true" tabindex="-1"></a>unclassified_endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1848"><a href="#cb35-1848" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb35-1849"><a href="#cb35-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1850"><a href="#cb35-1850" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum[media_sd_phylum_Endo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="fl">1.0</span>] <span class="ot">=</span> <span class="st">"Other phyla (&lt;1%)"</span> </span>
<span id="cb35-1851"><a href="#cb35-1851" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_phylum_Endo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1852"><a href="#cb35-1852" aria-hidden="true" tabindex="-1"></a>others_endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1853"><a href="#cb35-1853" aria-hidden="true" tabindex="-1"></a>media_sd_phylum_Endo2<span class="ot">=</span>media_sd_phylum_Endo2[media_sd_phylum_Endo2[,<span class="st">"Phylum"</span>] <span class="sc">!=</span> <span class="st">"Other phyla (&lt;1%)"</span>,]</span>
<span id="cb35-1854"><a href="#cb35-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1855"><a href="#cb35-1855" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="ot">=</span>media_sd_phylum_Endo2[<span class="fu">order</span>(media_sd_phylum_Endo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),]</span>
<span id="cb35-1856"><a href="#cb35-1856" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_endo2,others_endo2,unclassified_endo2)</span>
<span id="cb35-1857"><a href="#cb35-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1858"><a href="#cb35-1858" aria-hidden="true" tabindex="-1"></a>group_label_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>, <span class="st">"Mothers"</span>,<span class="st">"Suckers"</span>)</span>
<span id="cb35-1859"><a href="#cb35-1859" aria-hidden="true" tabindex="-1"></a>levels_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,<span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb35-1860"><a href="#cb35-1860" aria-hidden="true" tabindex="-1"></a>limits_endo2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,<span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb35-1861"><a href="#cb35-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1862"><a href="#cb35-1862" aria-hidden="true" tabindex="-1"></a>phyl_name_ordered_endo2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_endo2<span class="sc">$</span>Phylum)</span>
<span id="cb35-1863"><a href="#cb35-1863" aria-hidden="true" tabindex="-1"></a>nombres_unicos_endo2<span class="ot">=</span><span class="fu">unique</span>(phyl_name_ordered_endo2)</span>
<span id="cb35-1864"><a href="#cb35-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1865"><a href="#cb35-1865" aria-hidden="true" tabindex="-1"></a>ordenado_endo2<span class="sc">$</span>Phylum<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_endo2<span class="sc">$</span>Phylum,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_endo2))</span>
<span id="cb35-1866"><a href="#cb35-1866" aria-hidden="true" tabindex="-1"></a>lab_unicos_endo2<span class="ot">=</span>nombres_unicos_endo2 </span>
<span id="cb35-1867"><a href="#cb35-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1868"><a href="#cb35-1868" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_endo2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_endo2,</span>
<span id="cb35-1869"><a href="#cb35-1869" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other phyla (&lt;1%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;1%)"</span>)</span>
<span id="cb35-1870"><a href="#cb35-1870" aria-hidden="true" tabindex="-1"></a>                                     {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-1871"><a href="#cb35-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1872"><a href="#cb35-1872" aria-hidden="true" tabindex="-1"></a>colores_endo2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"brown"</span>,<span class="st">"#9933FF"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"yellow"</span>,<span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-1873"><a href="#cb35-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1874"><a href="#cb35-1874" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo2)<span class="sc">==</span><span class="fu">length</span>(colores_endo2) </span>
<span id="cb35-1875"><a href="#cb35-1875" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_endo2)</span>
<span id="cb35-1876"><a href="#cb35-1876" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_endo2)</span>
<span id="cb35-1877"><a href="#cb35-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1878"><a href="#cb35-1878" aria-hidden="true" tabindex="-1"></a>titulo_plot_endo2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb35-1879"><a href="#cb35-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1880"><a href="#cb35-1880" aria-hidden="true" tabindex="-1"></a>p_endo2_phylum<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_endo2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Phylum, <span class="at">order=</span>Phylum)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-1881"><a href="#cb35-1881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_endo2,</span>
<span id="cb35-1882"><a href="#cb35-1882" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_endo2,</span>
<span id="cb35-1883"><a href="#cb35-1883" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_endo2)<span class="sc">+</span></span>
<span id="cb35-1884"><a href="#cb35-1884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Phylum"</span>,<span class="at">title=</span>titulo_plot_endo2)<span class="sc">+</span></span>
<span id="cb35-1885"><a href="#cb35-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span><span class="co">#sirve para cambiar el orden de la leyenda</span></span>
<span id="cb35-1886"><a href="#cb35-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_endo2,<span class="at">labels=</span>group_label_endo2,</span>
<span id="cb35-1887"><a href="#cb35-1887" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_endo2)<span class="sc">+</span></span>
<span id="cb35-1888"><a href="#cb35-1888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-1889"><a href="#cb35-1889" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-1890"><a href="#cb35-1890" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-1891"><a href="#cb35-1891" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-1892"><a href="#cb35-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-1893"><a href="#cb35-1893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-1894"><a href="#cb35-1894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-1895"><a href="#cb35-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1896"><a href="#cb35-1896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-1897"><a href="#cb35-1897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1898"><a href="#cb35-1898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-1899"><a href="#cb35-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-1900"><a href="#cb35-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-1901"><a href="#cb35-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-1902"><a href="#cb35-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-1903"><a href="#cb35-1903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-1904"><a href="#cb35-1904" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-1905"><a href="#cb35-1905" aria-hidden="true" tabindex="-1"></a>p_endo2_phylum</span>
<span id="cb35-1906"><a href="#cb35-1906" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1907"><a href="#cb35-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1908"><a href="#cb35-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6.2. Genus level</span></span>
<span id="cb35-1909"><a href="#cb35-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1910"><a href="#cb35-1910" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.1. Obtain tables with the relative abundance and standard deviation values</span></span>
<span id="cb35-1911"><a href="#cb35-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1912"><a href="#cb35-1912" aria-hidden="true" tabindex="-1"></a>We are going to obtain the relative abundance of each phylum detected in our samples.</span>
<span id="cb35-1913"><a href="#cb35-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1916"><a href="#cb35-1916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1917"><a href="#cb35-1917" aria-hidden="true" tabindex="-1"></a>genus_relabun<span class="ot">=</span><span class="fu">tax_glom</span>(phy_data_relabun, <span class="at">taxrank =</span> <span class="st">"Genus"</span>)</span>
<span id="cb35-1918"><a href="#cb35-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">otu_table</span>(genus_relabun))</span>
<span id="cb35-1919"><a href="#cb35-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1920"><a href="#cb35-1920" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(genus_relabun))</span>
<span id="cb35-1921"><a href="#cb35-1921" aria-hidden="true" tabindex="-1"></a>bb<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">tax_table</span>(genus_relabun),b)</span>
<span id="cb35-1922"><a href="#cb35-1922" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(b),<span class="fu">rownames</span>(bb))</span>
<span id="cb35-1923"><a href="#cb35-1923" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(bb),bb),<span class="at">file=</span><span class="st">"abundrel_Genero_porReplicas.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-1924"><a href="#cb35-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1925"><a href="#cb35-1925" aria-hidden="true" tabindex="-1"></a>table_genus <span class="ot">=</span> <span class="fu">otu_table</span>(genus_relabun)[,] <span class="sc">%&gt;%</span> <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb35-1926"><a href="#cb35-1926" aria-hidden="true" tabindex="-1"></a>tax_genus<span class="ot">=</span><span class="fu">tax_table</span>(genus_relabun)</span>
<span id="cb35-1927"><a href="#cb35-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1928"><a href="#cb35-1928" aria-hidden="true" tabindex="-1"></a>genus_media<span class="ot">=</span><span class="fu">aggregate</span>(table_genus, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(genus_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>mean)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>) <span class="sc">%&gt;%</span> <span class="fu">t</span>() </span>
<span id="cb35-1929"><a href="#cb35-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1930"><a href="#cb35-1930" aria-hidden="true" tabindex="-1"></a>genus_sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(table_genus, <span class="at">by=</span><span class="fu">list</span>(<span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(genus_relabun))<span class="sc">$</span>Fusion), <span class="at">FUN=</span>sd)<span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Group.1"</span>)  <span class="sc">%&gt;%</span> <span class="fu">t</span>()  <span class="sc">%&gt;%</span> </span>
<span id="cb35-1931"><a href="#cb35-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="at">.fn=</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="fu">colnames</span>(genus_media), <span class="st">"_SD"</span>))</span>
<span id="cb35-1932"><a href="#cb35-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1933"><a href="#cb35-1933" aria-hidden="true" tabindex="-1"></a>genus_media_sd<span class="ot">=</span><span class="fu">merge</span>(tax_genus, genus_media, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span><span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-1934"><a href="#cb35-1934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(genus_sd, <span class="at">by=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"Row.names"</span>)</span>
<span id="cb35-1935"><a href="#cb35-1935" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(genus_media_sd[,<span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(genus_media_sd)])</span>
<span id="cb35-1936"><a href="#cb35-1936" aria-hidden="true" tabindex="-1"></a>genus_media_sd<span class="sc">$</span>ASV_names<span class="ot">=</span><span class="fu">row.names</span>(genus_media_sd)</span>
<span id="cb35-1937"><a href="#cb35-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1938"><a href="#cb35-1938" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"TAXA"</span><span class="ot">=</span><span class="fu">rownames</span>(genus_media_sd),genus_media_sd), <span class="at">file=</span><span class="st">"abundrel_media_sd_genus.txt"</span>, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span>F)</span>
<span id="cb35-1939"><a href="#cb35-1939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1940"><a href="#cb35-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1941"><a href="#cb35-1941" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2.2. Plotting</span></span>
<span id="cb35-1942"><a href="#cb35-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1943"><a href="#cb35-1943" aria-hidden="true" tabindex="-1"></a>We are going to make a stacked bars plot, just indicating the most abundant genera</span>
<span id="cb35-1944"><a href="#cb35-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1945"><a href="#cb35-1945" aria-hidden="true" tabindex="-1"></a>Firstly, we have to prepare the data and modify the table so that we can obtain tables suitable for the plotting with the package ggplot2.</span>
<span id="cb35-1946"><a href="#cb35-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1949"><a href="#cb35-1949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1950"><a href="#cb35-1950" aria-hidden="true" tabindex="-1"></a>df_melt_genus <span class="ot">=</span> <span class="fu">psmelt</span>(<span class="at">physeq =</span> genus_relabun) </span>
<span id="cb35-1951"><a href="#cb35-1951" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_genus) </span>
<span id="cb35-1952"><a href="#cb35-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1953"><a href="#cb35-1953" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg2 <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_genus<span class="sc">$</span>Abundance, </span>
<span id="cb35-1954"><a href="#cb35-1954" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_genus<span class="sc">$</span>Fusion, </span>
<span id="cb35-1955"><a href="#cb35-1955" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sample=</span>df_melt_genus<span class="sc">$</span>Sample,<span class="at">Genus=</span>df_melt_genus<span class="sc">$</span>Genus,</span>
<span id="cb35-1956"><a href="#cb35-1956" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Compartment=</span>df_melt_genus<span class="sc">$</span>Compartment,</span>
<span id="cb35-1957"><a href="#cb35-1957" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Plot=</span>df_melt_genus<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_genus<span class="sc">$</span>Year, <span class="at">Condition=</span>df_melt_genus<span class="sc">$</span>Condition), <span class="at">FUN=</span>sum)</span>
<span id="cb35-1958"><a href="#cb35-1958" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Sample"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb35-1959"><a href="#cb35-1959" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg2) </span>
<span id="cb35-1960"><a href="#cb35-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1961"><a href="#cb35-1961" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean <span class="ot">=</span> <span class="fu">aggregate</span>(df_melt_aggreg2<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg2<span class="sc">$</span>Group, </span>
<span id="cb35-1962"><a href="#cb35-1962" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Genus=</span>df_melt_aggreg2<span class="sc">$</span>Genus,</span>
<span id="cb35-1963"><a href="#cb35-1963" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Compartment=</span>df_melt_aggreg2<span class="sc">$</span>Compartment,</span>
<span id="cb35-1964"><a href="#cb35-1964" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="at">Plot=</span>df_melt_aggreg2<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg2<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg2<span class="sc">$</span>Condition), <span class="at">FUN=</span>mean)</span>
<span id="cb35-1965"><a href="#cb35-1965" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>, <span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"Abundance"</span>)</span>
<span id="cb35-1966"><a href="#cb35-1966" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_mean)</span>
<span id="cb35-1967"><a href="#cb35-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1968"><a href="#cb35-1968" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_sd<span class="ot">=</span><span class="fu">aggregate</span>(df_melt_aggreg2<span class="sc">$</span>Abundance, <span class="at">by=</span><span class="fu">list</span>(<span class="at">Group=</span>df_melt_aggreg2<span class="sc">$</span>Group, </span>
<span id="cb35-1969"><a href="#cb35-1969" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Genus=</span>df_melt_aggreg2<span class="sc">$</span>Genus,</span>
<span id="cb35-1970"><a href="#cb35-1970" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Compartment=</span>df_melt_aggreg2<span class="sc">$</span>Compartment,</span>
<span id="cb35-1971"><a href="#cb35-1971" aria-hidden="true" tabindex="-1"></a>                                                               <span class="at">Plot=</span>df_melt_aggreg2<span class="sc">$</span>Plot, <span class="at">Year=</span>df_melt_aggreg2<span class="sc">$</span>Year,<span class="at">Condition=</span>df_melt_aggreg2<span class="sc">$</span>Condition), <span class="at">FUN=</span>sd)</span>
<span id="cb35-1972"><a href="#cb35-1972" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_melt_aggreg_sd)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Group"</span>, <span class="st">"Genus"</span>,<span class="st">"Compartment"</span>,<span class="st">"Plot"</span>,<span class="st">"Year"</span>,<span class="st">"Condition"</span>,<span class="st">"sd"</span>)</span>
<span id="cb35-1973"><a href="#cb35-1973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1974"><a href="#cb35-1974" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Group<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Group)</span>
<span id="cb35-1975"><a href="#cb35-1975" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(df_melt_aggreg_mean<span class="sc">$</span>Genus<span class="sc">==</span>df_melt_aggreg_sd<span class="sc">$</span>Genus)</span>
<span id="cb35-1976"><a href="#cb35-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1977"><a href="#cb35-1977" aria-hidden="true" tabindex="-1"></a>df_melt_aggreg_mean<span class="sc">$</span>sd<span class="ot">=</span>df_melt_aggreg_sd<span class="sc">$</span>sd </span>
<span id="cb35-1978"><a href="#cb35-1978" aria-hidden="true" tabindex="-1"></a>media_sd_genus_todos<span class="ot">=</span>df_melt_aggreg_mean</span>
<span id="cb35-1979"><a href="#cb35-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1980"><a href="#cb35-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1981"><a href="#cb35-1981" aria-hidden="true" tabindex="-1"></a>Now, we are ready to plot the mean relative abundances. We want to order the genera by ascending relative abundance, keeping the unclassified and minor genera in the upper part of the plot.</span>
<span id="cb35-1982"><a href="#cb35-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1985"><a href="#cb35-1985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-1986"><a href="#cb35-1986" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-1987"><a href="#cb35-1987" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo<span class="ot">=</span>media_sd_genus_todos[media_sd_genus_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Rhizosphere"</span>,]</span>
<span id="cb35-1988"><a href="#cb35-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1989"><a href="#cb35-1989" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) South plot</span></span>
<span id="cb35-1990"><a href="#cb35-1990" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo[media_sd_genus_rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb35-1991"><a href="#cb35-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1992"><a href="#cb35-1992" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_rizo1<span class="sc">$</span>Genus)</span>
<span id="cb35-1993"><a href="#cb35-1993" aria-hidden="true" tabindex="-1"></a>unclassified_r1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1994"><a href="#cb35-1994" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-1995"><a href="#cb35-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1996"><a href="#cb35-1996" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus[media_sd_genus_rizo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb35-1997"><a href="#cb35-1997" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_rizo1<span class="sc">$</span>Genus)</span>
<span id="cb35-1998"><a href="#cb35-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1999"><a href="#cb35-1999" aria-hidden="true" tabindex="-1"></a>others_r1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2000"><a href="#cb35-2000" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo1<span class="ot">=</span>media_sd_genus_rizo1[media_sd_genus_rizo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2001"><a href="#cb35-2001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2002"><a href="#cb35-2002" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="ot">=</span>media_sd_genus_rizo1[<span class="fu">order</span>(media_sd_genus_rizo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-2003"><a href="#cb35-2003" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_r1,others_r1,unclassified_r1)</span>
<span id="cb35-2004"><a href="#cb35-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2005"><a href="#cb35-2005" aria-hidden="true" tabindex="-1"></a>group_label_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb35-2006"><a href="#cb35-2006" aria-hidden="true" tabindex="-1"></a>levels_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,</span>
<span id="cb35-2007"><a href="#cb35-2007" aria-hidden="true" tabindex="-1"></a>           <span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)</span>
<span id="cb35-2008"><a href="#cb35-2008" aria-hidden="true" tabindex="-1"></a>limits_r1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Rhizosphere"</span>,<span class="st">"A_Plot1_Immature_Rhizosphere"</span>,</span>
<span id="cb35-2009"><a href="#cb35-2009" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Rhizosphere"</span>,<span class="st">"B_Plot1_Immature_Rhizosphere"</span>)</span>
<span id="cb35-2010"><a href="#cb35-2010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2011"><a href="#cb35-2011" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_r1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_r1<span class="sc">$</span>Genus)</span>
<span id="cb35-2012"><a href="#cb35-2012" aria-hidden="true" tabindex="-1"></a>nombres_unicos_r1<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_r1)</span>
<span id="cb35-2013"><a href="#cb35-2013" aria-hidden="true" tabindex="-1"></a>ordenado_r1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_r1<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_r1))</span>
<span id="cb35-2014"><a href="#cb35-2014" aria-hidden="true" tabindex="-1"></a>lab_unicos_r1<span class="ot">=</span>nombres_unicos_r1 </span>
<span id="cb35-2015"><a href="#cb35-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2016"><a href="#cb35-2016" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_r1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_r1,</span>
<span id="cb35-2017"><a href="#cb35-2017" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb35-2018"><a href="#cb35-2018" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-2019"><a href="#cb35-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2020"><a href="#cb35-2020" aria-hidden="true" tabindex="-1"></a>colores_r1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"brown"</span>,<span class="st">"yellow"</span>,<span class="st">"orange"</span>,<span class="st">"#00FFFF"</span>,<span class="st">"red"</span>, </span>
<span id="cb35-2021"><a href="#cb35-2021" aria-hidden="true" tabindex="-1"></a>               <span class="st">"pink"</span>, <span class="st">"magenta"</span>,<span class="st">"blue"</span>,<span class="st">"khaki2"</span>, </span>
<span id="cb35-2022"><a href="#cb35-2022" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-2023"><a href="#cb35-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2024"><a href="#cb35-2024" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r1)<span class="sc">==</span><span class="fu">length</span>(colores_r1) </span>
<span id="cb35-2025"><a href="#cb35-2025" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r1)</span>
<span id="cb35-2026"><a href="#cb35-2026" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_r1)</span>
<span id="cb35-2027"><a href="#cb35-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2028"><a href="#cb35-2028" aria-hidden="true" tabindex="-1"></a>titulo_plot_r1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb35-2029"><a href="#cb35-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2030"><a href="#cb35-2030" aria-hidden="true" tabindex="-1"></a>pgenus_r1<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_r1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2031"><a href="#cb35-2031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_r1,</span>
<span id="cb35-2032"><a href="#cb35-2032" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_r1,</span>
<span id="cb35-2033"><a href="#cb35-2033" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_r1)<span class="sc">+</span></span>
<span id="cb35-2034"><a href="#cb35-2034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_r1)<span class="sc">+</span></span>
<span id="cb35-2035"><a href="#cb35-2035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2036"><a href="#cb35-2036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_r1,<span class="at">labels=</span>group_label_r1,</span>
<span id="cb35-2037"><a href="#cb35-2037" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_r1)<span class="sc">+</span></span>
<span id="cb35-2038"><a href="#cb35-2038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2039"><a href="#cb35-2039" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2040"><a href="#cb35-2040" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2041"><a href="#cb35-2041" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-2042"><a href="#cb35-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2043"><a href="#cb35-2043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2044"><a href="#cb35-2044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2045"><a href="#cb35-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2046"><a href="#cb35-2046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2047"><a href="#cb35-2047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2048"><a href="#cb35-2048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2049"><a href="#cb35-2049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2050"><a href="#cb35-2050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb35-2051"><a href="#cb35-2051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2052"><a href="#cb35-2052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2053"><a href="#cb35-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb35-2054"><a href="#cb35-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb35-2055"><a href="#cb35-2055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2056"><a href="#cb35-2056" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2057"><a href="#cb35-2057" aria-hidden="true" tabindex="-1"></a>pgenus_r1</span>
<span id="cb35-2058"><a href="#cb35-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2059"><a href="#cb35-2059" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) North plot</span></span>
<span id="cb35-2060"><a href="#cb35-2060" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo[media_sd_genus_rizo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb35-2061"><a href="#cb35-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2062"><a href="#cb35-2062" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_rizo2<span class="sc">$</span>Genus)</span>
<span id="cb35-2063"><a href="#cb35-2063" aria-hidden="true" tabindex="-1"></a>unclassified_r2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-2064"><a href="#cb35-2064" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb35-2065"><a href="#cb35-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2066"><a href="#cb35-2066" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus[media_sd_genus_rizo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb35-2067"><a href="#cb35-2067" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_rizo2<span class="sc">$</span>Genus)</span>
<span id="cb35-2068"><a href="#cb35-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2069"><a href="#cb35-2069" aria-hidden="true" tabindex="-1"></a>others_r2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2070"><a href="#cb35-2070" aria-hidden="true" tabindex="-1"></a>media_sd_genus_rizo2<span class="ot">=</span>media_sd_genus_rizo2[media_sd_genus_rizo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2071"><a href="#cb35-2071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2072"><a href="#cb35-2072" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="ot">=</span>media_sd_genus_rizo2[<span class="fu">order</span>(media_sd_genus_rizo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-2073"><a href="#cb35-2073" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_r2,others_r2,unclassified_r2)</span>
<span id="cb35-2074"><a href="#cb35-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2075"><a href="#cb35-2075" aria-hidden="true" tabindex="-1"></a>group_label_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb35-2076"><a href="#cb35-2076" aria-hidden="true" tabindex="-1"></a>levels_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,</span>
<span id="cb35-2077"><a href="#cb35-2077" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Rhizosphere"</span>,<span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb35-2078"><a href="#cb35-2078" aria-hidden="true" tabindex="-1"></a>limits_r2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Rhizosphere"</span>,<span class="st">"A_Plot2_Immature_Rhizosphere"</span>,</span>
<span id="cb35-2079"><a href="#cb35-2079" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Rhizosphere"</span>,<span class="st">"B_Plot2_Immature_Rhizosphere"</span>)</span>
<span id="cb35-2080"><a href="#cb35-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2081"><a href="#cb35-2081" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_r2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_r2<span class="sc">$</span>Genus)</span>
<span id="cb35-2082"><a href="#cb35-2082" aria-hidden="true" tabindex="-1"></a>nombres_unicos_r2<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_r2)</span>
<span id="cb35-2083"><a href="#cb35-2083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2084"><a href="#cb35-2084" aria-hidden="true" tabindex="-1"></a>ordenado_r2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_r2<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_r2))</span>
<span id="cb35-2085"><a href="#cb35-2085" aria-hidden="true" tabindex="-1"></a>lab_unicos_r2<span class="ot">=</span>nombres_unicos_r2</span>
<span id="cb35-2086"><a href="#cb35-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2087"><a href="#cb35-2087" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_r2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_r2,</span>
<span id="cb35-2088"><a href="#cb35-2088" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb35-2089"><a href="#cb35-2089" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-2090"><a href="#cb35-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2091"><a href="#cb35-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2092"><a href="#cb35-2092" aria-hidden="true" tabindex="-1"></a>colores_r2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#0099FF"</span>,<span class="st">"#00CC00"</span>,<span class="st">"#9933FF"</span>,<span class="st">"yellow"</span>,<span class="st">"green4"</span>,<span class="st">"steelblue4"</span>,<span class="st">"brown"</span>,<span class="st">"maroon"</span>,<span class="st">"gold1"</span>,</span>
<span id="cb35-2093"><a href="#cb35-2093" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb35-2094"><a href="#cb35-2094" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-2095"><a href="#cb35-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2096"><a href="#cb35-2096" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r2)<span class="sc">==</span><span class="fu">length</span>(colores_r2)</span>
<span id="cb35-2097"><a href="#cb35-2097" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_r2)</span>
<span id="cb35-2098"><a href="#cb35-2098" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_r2)</span>
<span id="cb35-2099"><a href="#cb35-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2100"><a href="#cb35-2100" aria-hidden="true" tabindex="-1"></a>titulo_plot_r2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb35-2101"><a href="#cb35-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2102"><a href="#cb35-2102" aria-hidden="true" tabindex="-1"></a>pgenus_r2<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_r2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2103"><a href="#cb35-2103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_r2,</span>
<span id="cb35-2104"><a href="#cb35-2104" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_r2,</span>
<span id="cb35-2105"><a href="#cb35-2105" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_r2)<span class="sc">+</span></span>
<span id="cb35-2106"><a href="#cb35-2106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_r2)<span class="sc">+</span></span>
<span id="cb35-2107"><a href="#cb35-2107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2108"><a href="#cb35-2108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_r2,<span class="at">labels=</span>group_label_r2,</span>
<span id="cb35-2109"><a href="#cb35-2109" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_r2)<span class="sc">+</span></span>
<span id="cb35-2110"><a href="#cb35-2110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2111"><a href="#cb35-2111" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2112"><a href="#cb35-2112" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2113"><a href="#cb35-2113" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-2114"><a href="#cb35-2114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2115"><a href="#cb35-2115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2116"><a href="#cb35-2116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2117"><a href="#cb35-2117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2118"><a href="#cb35-2118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2119"><a href="#cb35-2119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2120"><a href="#cb35-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2121"><a href="#cb35-2121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2122"><a href="#cb35-2122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb35-2123"><a href="#cb35-2123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2124"><a href="#cb35-2124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2125"><a href="#cb35-2125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb35-2126"><a href="#cb35-2126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb35-2127"><a href="#cb35-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2128"><a href="#cb35-2128" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2129"><a href="#cb35-2129" aria-hidden="true" tabindex="-1"></a>pgenus_r2</span>
<span id="cb35-2130"><a href="#cb35-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2131"><a href="#cb35-2131" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-2132"><a href="#cb35-2132" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo<span class="ot">=</span>media_sd_genus_todos[media_sd_genus_todos[,<span class="st">"Compartment"</span>] <span class="sc">==</span> <span class="st">"Endosphere"</span>,]</span>
<span id="cb35-2133"><a href="#cb35-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2134"><a href="#cb35-2134" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) South plot</span></span>
<span id="cb35-2135"><a href="#cb35-2135" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo[media_sd_genus_endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot1"</span>,]</span>
<span id="cb35-2136"><a href="#cb35-2136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2137"><a href="#cb35-2137" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_endo1<span class="sc">$</span>Genus)</span>
<span id="cb35-2138"><a href="#cb35-2138" aria-hidden="true" tabindex="-1"></a>unclassified_e1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-2139"><a href="#cb35-2139" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb35-2140"><a href="#cb35-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2141"><a href="#cb35-2141" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus[media_sd_genus_endo1<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb35-2142"><a href="#cb35-2142" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_endo1<span class="sc">$</span>Genus)</span>
<span id="cb35-2143"><a href="#cb35-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2144"><a href="#cb35-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2145"><a href="#cb35-2145" aria-hidden="true" tabindex="-1"></a>others_e1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2146"><a href="#cb35-2146" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo1<span class="ot">=</span>media_sd_genus_endo1[media_sd_genus_endo1[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2147"><a href="#cb35-2147" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="ot">=</span>media_sd_genus_endo1[<span class="fu">order</span>(media_sd_genus_endo1<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-2148"><a href="#cb35-2148" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="ot">=</span><span class="fu">rbind</span>(ordenado_e1,others_e1,unclassified_e1)</span>
<span id="cb35-2149"><a href="#cb35-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2150"><a href="#cb35-2150" aria-hidden="true" tabindex="-1"></a>group_label_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb35-2151"><a href="#cb35-2151" aria-hidden="true" tabindex="-1"></a>levels_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,</span>
<span id="cb35-2152"><a href="#cb35-2152" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb35-2153"><a href="#cb35-2153" aria-hidden="true" tabindex="-1"></a>limits_e1<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot1_Mature_Endosphere"</span>,<span class="st">"A_Plot1_Immature_Endosphere"</span>,</span>
<span id="cb35-2154"><a href="#cb35-2154" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot1_Mature_Endosphere"</span>,<span class="st">"B_Plot1_Immature_Endosphere"</span>)</span>
<span id="cb35-2155"><a href="#cb35-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2156"><a href="#cb35-2156" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_e1<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_e1<span class="sc">$</span>Genus)</span>
<span id="cb35-2157"><a href="#cb35-2157" aria-hidden="true" tabindex="-1"></a>nombres_unicos_e1<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_e1)</span>
<span id="cb35-2158"><a href="#cb35-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2159"><a href="#cb35-2159" aria-hidden="true" tabindex="-1"></a>ordenado_e1<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_e1<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_e1))</span>
<span id="cb35-2160"><a href="#cb35-2160" aria-hidden="true" tabindex="-1"></a>lab_unicos_e1<span class="ot">=</span>nombres_unicos_e1 </span>
<span id="cb35-2161"><a href="#cb35-2161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2162"><a href="#cb35-2162" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_e1<span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_e1,</span>
<span id="cb35-2163"><a href="#cb35-2163" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb35-2164"><a href="#cb35-2164" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-2165"><a href="#cb35-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2166"><a href="#cb35-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2167"><a href="#cb35-2167" aria-hidden="true" tabindex="-1"></a>colores_e1 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"purple"</span>,<span class="st">"violet"</span>,<span class="st">"firebrick"</span>,<span class="st">"#CAB2D6"</span>,<span class="st">"powderblue"</span>,<span class="st">"yellow4"</span>,<span class="st">"#FB9A99"</span>,</span>
<span id="cb35-2168"><a href="#cb35-2168" aria-hidden="true" tabindex="-1"></a>               <span class="st">"#FDBF6F"</span>, <span class="st">"coral2"</span>,<span class="st">"springgreen3"</span>,<span class="st">"lightgoldenrod2"</span>,<span class="st">"mediumorchid2"</span>,<span class="st">"gold1"</span>,</span>
<span id="cb35-2169"><a href="#cb35-2169" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-2170"><a href="#cb35-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2171"><a href="#cb35-2171" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e1)<span class="sc">==</span><span class="fu">length</span>(colores_e1)</span>
<span id="cb35-2172"><a href="#cb35-2172" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e1)</span>
<span id="cb35-2173"><a href="#cb35-2173" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_e1)</span>
<span id="cb35-2174"><a href="#cb35-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2175"><a href="#cb35-2175" aria-hidden="true" tabindex="-1"></a>titulo_plot_e1<span class="ot">=</span><span class="st">"South plot"</span></span>
<span id="cb35-2176"><a href="#cb35-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2177"><a href="#cb35-2177" aria-hidden="true" tabindex="-1"></a>pgenus_e1<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_e1, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2178"><a href="#cb35-2178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_e1,</span>
<span id="cb35-2179"><a href="#cb35-2179" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_e1,</span>
<span id="cb35-2180"><a href="#cb35-2180" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_e1)<span class="sc">+</span></span>
<span id="cb35-2181"><a href="#cb35-2181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_e1)<span class="sc">+</span></span>
<span id="cb35-2182"><a href="#cb35-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2183"><a href="#cb35-2183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_e1,<span class="at">labels=</span>group_label_e1,</span>
<span id="cb35-2184"><a href="#cb35-2184" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_e1)<span class="sc">+</span></span>
<span id="cb35-2185"><a href="#cb35-2185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2186"><a href="#cb35-2186" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2187"><a href="#cb35-2187" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2188"><a href="#cb35-2188" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-2189"><a href="#cb35-2189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2190"><a href="#cb35-2190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2191"><a href="#cb35-2191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2192"><a href="#cb35-2192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2193"><a href="#cb35-2193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2194"><a href="#cb35-2194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2195"><a href="#cb35-2195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2196"><a href="#cb35-2196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2197"><a href="#cb35-2197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb35-2198"><a href="#cb35-2198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2199"><a href="#cb35-2199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2200"><a href="#cb35-2200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2201"><a href="#cb35-2201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb35-2202"><a href="#cb35-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2203"><a href="#cb35-2203" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2204"><a href="#cb35-2204" aria-hidden="true" tabindex="-1"></a>pgenus_e1</span>
<span id="cb35-2205"><a href="#cb35-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2206"><a href="#cb35-2206" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-2207"><a href="#cb35-2207" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo[media_sd_genus_endo[,<span class="st">"Plot"</span>] <span class="sc">==</span> <span class="st">"Plot2"</span>,]</span>
<span id="cb35-2208"><a href="#cb35-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2209"><a href="#cb35-2209" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.character</span>(media_sd_genus_endo2<span class="sc">$</span>Genus)</span>
<span id="cb35-2210"><a href="#cb35-2210" aria-hidden="true" tabindex="-1"></a>unclassified_e2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"unclassified"</span>,] </span>
<span id="cb35-2211"><a href="#cb35-2211" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"unclassified"</span>,]</span>
<span id="cb35-2212"><a href="#cb35-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2213"><a href="#cb35-2213" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus[media_sd_genus_endo2<span class="sc">$</span>Abundance <span class="sc">&lt;=</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="st">"Other genera (&lt;2%)"</span> </span>
<span id="cb35-2214"><a href="#cb35-2214" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">as.factor</span>(media_sd_genus_endo2<span class="sc">$</span>Genus)</span>
<span id="cb35-2215"><a href="#cb35-2215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2216"><a href="#cb35-2216" aria-hidden="true" tabindex="-1"></a>others_e2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2217"><a href="#cb35-2217" aria-hidden="true" tabindex="-1"></a>media_sd_genus_endo2<span class="ot">=</span>media_sd_genus_endo2[media_sd_genus_endo2[,<span class="st">"Genus"</span>] <span class="sc">!=</span> <span class="st">"Other genera (&lt;2%)"</span>,]</span>
<span id="cb35-2218"><a href="#cb35-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2219"><a href="#cb35-2219" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="ot">=</span>media_sd_genus_endo2[<span class="fu">order</span>(media_sd_genus_endo2<span class="sc">$</span>Abundance, <span class="at">decreasing=</span>T),] </span>
<span id="cb35-2220"><a href="#cb35-2220" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="ot">=</span><span class="fu">rbind</span>(ordenado_e2,others_e2,unclassified_e2)</span>
<span id="cb35-2221"><a href="#cb35-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2222"><a href="#cb35-2222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2223"><a href="#cb35-2223" aria-hidden="true" tabindex="-1"></a>group_label_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"S"</span>, <span class="st">"M"</span>,<span class="st">"S"</span>)</span>
<span id="cb35-2224"><a href="#cb35-2224" aria-hidden="true" tabindex="-1"></a>levels_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,</span>
<span id="cb35-2225"><a href="#cb35-2225" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb35-2226"><a href="#cb35-2226" aria-hidden="true" tabindex="-1"></a>limits_e2<span class="ot">=</span><span class="fu">c</span>(<span class="st">"A_Plot2_Mature_Endosphere"</span>,<span class="st">"A_Plot2_Immature_Endosphere"</span>,</span>
<span id="cb35-2227"><a href="#cb35-2227" aria-hidden="true" tabindex="-1"></a>            <span class="st">"B_Plot2_Mature_Endosphere"</span>,<span class="st">"B_Plot2_Immature_Endosphere"</span>)</span>
<span id="cb35-2228"><a href="#cb35-2228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2229"><a href="#cb35-2229" aria-hidden="true" tabindex="-1"></a>genus_name_ordered_e2<span class="ot">=</span><span class="fu">as.vector</span>(ordenado_e2<span class="sc">$</span>Genus)</span>
<span id="cb35-2230"><a href="#cb35-2230" aria-hidden="true" tabindex="-1"></a>nombres_unicos_e2<span class="ot">=</span><span class="fu">unique</span>(genus_name_ordered_e2)</span>
<span id="cb35-2231"><a href="#cb35-2231" aria-hidden="true" tabindex="-1"></a>ordenado_e2<span class="sc">$</span>Genus<span class="ot">=</span><span class="fu">reorder.factor</span>(ordenado_e2<span class="sc">$</span>Genus,<span class="at">new.order=</span><span class="fu">rev</span>(nombres_unicos_e2))</span>
<span id="cb35-2232"><a href="#cb35-2232" aria-hidden="true" tabindex="-1"></a>lab_unicos_e2<span class="ot">=</span>nombres_unicos_e2 </span>
<span id="cb35-2233"><a href="#cb35-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2234"><a href="#cb35-2234" aria-hidden="true" tabindex="-1"></a>sorted_labels_ggplot_e2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lab_unicos_e2,</span>
<span id="cb35-2235"><a href="#cb35-2235" aria-hidden="true" tabindex="-1"></a>                                  <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"unclassified"</span><span class="sc">|</span>x <span class="sc">==</span> <span class="st">"Other genera (&lt;2%)"</span>)</span>
<span id="cb35-2236"><a href="#cb35-2236" aria-hidden="true" tabindex="-1"></a>                                  {<span class="fu">parse</span>(<span class="at">text=</span><span class="fu">paste0</span>(<span class="st">"'"</span>, <span class="fu">as.character</span>(x), <span class="st">"'"</span>))} <span class="cf">else</span> {<span class="fu">parse</span>(<span class="at">text =</span> <span class="fu">paste0</span>(<span class="st">"italic('"</span>,<span class="fu">as.character</span>(x), <span class="st">"')"</span>))})</span>
<span id="cb35-2237"><a href="#cb35-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2238"><a href="#cb35-2238" aria-hidden="true" tabindex="-1"></a>colores_e2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"purple"</span>, <span class="st">"violet"</span>,<span class="st">"burlywood"</span>,<span class="st">"gold1"</span>,<span class="st">"darkseagreen2"</span>,<span class="st">"darkmagenta"</span>,<span class="st">"sienna2"</span>,<span class="st">"grey90"</span>,<span class="st">"mediumslateblue"</span>,</span>
<span id="cb35-2239"><a href="#cb35-2239" aria-hidden="true" tabindex="-1"></a>               <span class="st">"lightgoldenrod2"</span>,<span class="st">"springgreen3"</span>,<span class="st">"#00CC00"</span>,<span class="st">"saddlebrown"</span>,<span class="st">"orangered2"</span>,<span class="st">"powderblue"</span>,<span class="st">"#CAB2D6"</span>,<span class="st">"peachpuff"</span>,</span>
<span id="cb35-2240"><a href="#cb35-2240" aria-hidden="true" tabindex="-1"></a>               <span class="st">"grey"</span>,<span class="st">"black"</span>)</span>
<span id="cb35-2241"><a href="#cb35-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2242"><a href="#cb35-2242" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e2)<span class="sc">==</span><span class="fu">length</span>(colores_e2) </span>
<span id="cb35-2243"><a href="#cb35-2243" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(lab_unicos_e2)</span>
<span id="cb35-2244"><a href="#cb35-2244" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(colores_e2)</span>
<span id="cb35-2245"><a href="#cb35-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2246"><a href="#cb35-2246" aria-hidden="true" tabindex="-1"></a>titulo_plot_e2<span class="ot">=</span><span class="st">"North plot"</span></span>
<span id="cb35-2247"><a href="#cb35-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2248"><a href="#cb35-2248" aria-hidden="true" tabindex="-1"></a>pgenus_e2<span class="ot">=</span><span class="fu">ggplot</span>(ordenado_e2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Genus, <span class="at">order=</span>Genus)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2249"><a href="#cb35-2249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>colores_e2,</span>
<span id="cb35-2250"><a href="#cb35-2250" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span>sorted_labels_ggplot_e2,</span>
<span id="cb35-2251"><a href="#cb35-2251" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span>nombres_unicos_e2)<span class="sc">+</span></span>
<span id="cb35-2252"><a href="#cb35-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Mean relative abundance (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Genus"</span>,<span class="at">title=</span>titulo_plot_e2)<span class="sc">+</span></span>
<span id="cb35-2253"><a href="#cb35-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2254"><a href="#cb35-2254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span>limits_e2,<span class="at">labels=</span>group_label_e2,</span>
<span id="cb35-2255"><a href="#cb35-2255" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span>levels_e2)<span class="sc">+</span></span>
<span id="cb35-2256"><a href="#cb35-2256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2257"><a href="#cb35-2257" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2258"><a href="#cb35-2258" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2259"><a href="#cb35-2259" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb35-2260"><a href="#cb35-2260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2261"><a href="#cb35-2261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2262"><a href="#cb35-2262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2263"><a href="#cb35-2263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2264"><a href="#cb35-2264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2265"><a href="#cb35-2265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2266"><a href="#cb35-2266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb35-2267"><a href="#cb35-2267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2268"><a href="#cb35-2268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb35-2269"><a href="#cb35-2269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2270"><a href="#cb35-2270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2271"><a href="#cb35-2271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)<span class="sc">+</span> </span>
<span id="cb35-2272"><a href="#cb35-2272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb35-2273"><a href="#cb35-2273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2274"><a href="#cb35-2274" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2275"><a href="#cb35-2275" aria-hidden="true" tabindex="-1"></a>pgenus_e2</span>
<span id="cb35-2276"><a href="#cb35-2276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2277"><a href="#cb35-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2278"><a href="#cb35-2278" aria-hidden="true" tabindex="-1"></a>In Figure 7 you can observe an example of the stacked bar plot for the main genera. This kind of plot can be calculated at the taxonomical rank you prefer. Please, try to open the plot in a new window if you want to view it at full size.</span>
<span id="cb35-2279"><a href="#cb35-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2280"><a href="#cb35-2280" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure 7. Distribution of the main classified genera in the root endosphere of mother and sucker plants in 2022 (left) and 2023 (right)](images/Genera_endo2.jpeg)</span>{fig-align="center"}</span>
<span id="cb35-2281"><a href="#cb35-2281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2282"><a href="#cb35-2282" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Inheritance analyses</span></span>
<span id="cb35-2283"><a href="#cb35-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2284"><a href="#cb35-2284" aria-hidden="true" tabindex="-1"></a>Our experimental design allows us to study the potential transmission of microorganisms from mothers to first and second suckers. For that purpose, we firstly compared the root microbiota of mothers and first suckers, and then, these shared microorganisms were further compared against the microbiota of rhizosphere of sucker plants. It is expected that the microorganisms that are found in the root endosphere of suckers (and not found in the rhizosphere) and also in the root endosphere of mother plants, are transferred from mothers to suckers through the root system (corm), but not acquired from the surrounding soil of from the environment.</span>
<span id="cb35-2285"><a href="#cb35-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2286"><a href="#cb35-2286" aria-hidden="true" tabindex="-1"></a>We will perform this analysis just at ASV level</span>
<span id="cb35-2287"><a href="#cb35-2287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2288"><a href="#cb35-2288" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.1 Prepare the data</span></span>
<span id="cb35-2289"><a href="#cb35-2289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2292"><a href="#cb35-2292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2293"><a href="#cb35-2293" aria-hidden="true" tabindex="-1"></a>mt1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">sample_data</span>(phy_data_relabun))</span>
<span id="cb35-2294"><a href="#cb35-2294" aria-hidden="true" tabindex="-1"></a>names <span class="ot">=</span> <span class="fu">unique</span>(mt1<span class="sc">$</span>Fusion) <span class="co">#get the name of each level of the variable "Fusion", which in this example corresponds to each individual group of samples. For instance, the first level of the variable "Fusion" is "A_Plot1_Mature_Rhizosphere" (all rhizosphere samples of mother plants sampled in 2022 located in the south plot)</span></span>
<span id="cb35-2295"><a href="#cb35-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2296"><a href="#cb35-2296" aria-hidden="true" tabindex="-1"></a><span class="co">#in the following for loop we are creating a list in which we are saving one each phyloseq object per group of samples. That is to say, in the first element of the list, the phyloseq object corresponding to the samples of the rhizosphere of mother plants sampled in 2022 located in the south plot is stored.</span></span>
<span id="cb35-2297"><a href="#cb35-2297" aria-hidden="true" tabindex="-1"></a>pruned_data <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb35-2298"><a href="#cb35-2298" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(names)){</span>
<span id="cb35-2299"><a href="#cb35-2299" aria-hidden="true" tabindex="-1"></a>  samples_group <span class="ot">=</span> mt1[<span class="fu">which</span>(mt1<span class="sc">$</span>Fusion<span class="sc">==</span>names[i]),]<span class="sc">$</span>Sample</span>
<span id="cb35-2300"><a href="#cb35-2300" aria-hidden="true" tabindex="-1"></a>  pruned_data[[i]] <span class="ot">=</span> <span class="fu">prune_samples</span>(samples_group, phy_data_relabun)</span>
<span id="cb35-2301"><a href="#cb35-2301" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-2302"><a href="#cb35-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2303"><a href="#cb35-2303" aria-hidden="true" tabindex="-1"></a><span class="co">#this loop stored the taxonony and ASV table of each phyloseq element of the previously created list</span></span>
<span id="cb35-2304"><a href="#cb35-2304" aria-hidden="true" tabindex="-1"></a>otu_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb35-2305"><a href="#cb35-2305" aria-hidden="true" tabindex="-1"></a>tax_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb35-2306"><a href="#cb35-2306" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pruned_data)){</span>
<span id="cb35-2307"><a href="#cb35-2307" aria-hidden="true" tabindex="-1"></a>  otu_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">otu_table</span>(pruned_data[[i]]))</span>
<span id="cb35-2308"><a href="#cb35-2308" aria-hidden="true" tabindex="-1"></a>  tax_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">tax_table</span>(pruned_data[[i]]))</span>
<span id="cb35-2309"><a href="#cb35-2309" aria-hidden="true" tabindex="-1"></a>}<span class="co">#it gives the list "otu_tables", whose element [[1]] corresponds to the ASV table of the group of sample "A_Plot1_Mature_Rhizosphere". While "tax_tables" list stores the taxonomy tables</span></span>
<span id="cb35-2310"><a href="#cb35-2310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2311"><a href="#cb35-2311" aria-hidden="true" tabindex="-1"></a><span class="co">#this list merges each ASV table with each tax table by rownames (by=0)</span></span>
<span id="cb35-2312"><a href="#cb35-2312" aria-hidden="true" tabindex="-1"></a>whole_tables <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb35-2313"><a href="#cb35-2313" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pruned_data)){</span>
<span id="cb35-2314"><a href="#cb35-2314" aria-hidden="true" tabindex="-1"></a>  whole_tables[[i]] <span class="ot">&lt;-</span> <span class="fu">merge</span>(tax_tables[[i]],otu_tables[[i]], <span class="at">by=</span><span class="dv">0</span>)</span>
<span id="cb35-2315"><a href="#cb35-2315" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-2316"><a href="#cb35-2316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2317"><a href="#cb35-2317" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(whole_tables)){</span>
<span id="cb35-2318"><a href="#cb35-2318" aria-hidden="true" tabindex="-1"></a>  whole_tables[[i]]<span class="sc">$</span>ASV_names<span class="ot">=</span>whole_tables[[i]]<span class="sc">$</span>Row.names</span>
<span id="cb35-2319"><a href="#cb35-2319" aria-hidden="true" tabindex="-1"></a>}<span class="co">#it creates a new column in the list "wholes_tables" that corresponds to the rownames</span></span>
<span id="cb35-2320"><a href="#cb35-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2321"><a href="#cb35-2321" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(whole_tables)){ <span class="co">#create one dataframe per element from the list "whole_tables"</span></span>
<span id="cb35-2322"><a href="#cb35-2322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(names[i],<span class="st">"_df"</span>),<span class="fu">as.data.frame</span>(whole_tables[[i]]))</span>
<span id="cb35-2323"><a href="#cb35-2323" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-2324"><a href="#cb35-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2325"><a href="#cb35-2325" aria-hidden="true" tabindex="-1"></a><span class="co">#the previous loop returns complex dataframe names, so let's rename them and calculate the total number of sequences registered for each ASV in all the corresponding dataset </span></span>
<span id="cb35-2326"><a href="#cb35-2326" aria-hidden="true" tabindex="-1"></a>A_r1_M<span class="ot">=</span>A_Plot1_Mature_Rhizosphere_df; A_r1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r1_M)]); A_r1_M_def<span class="ot">=</span>A_r1_M[<span class="fu">which</span>(A_r1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))<span class="co">#we remove those ASV that account for 0 sequences in sum in each dataset</span></span>
<span id="cb35-2327"><a href="#cb35-2327" aria-hidden="true" tabindex="-1"></a>A_e1_M<span class="ot">=</span>A_Plot1_Mature_Endosphere_df; A_e1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e1_M)]); A_e1_M_def<span class="ot">=</span>A_e1_M[<span class="fu">which</span>(A_e1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2328"><a href="#cb35-2328" aria-hidden="true" tabindex="-1"></a>A_e1_I<span class="ot">=</span>A_Plot1_Immature_Endosphere_df; A_e1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e1_I)]); A_e1_I_def<span class="ot">=</span>A_e1_I[<span class="fu">which</span>(A_e1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2329"><a href="#cb35-2329" aria-hidden="true" tabindex="-1"></a>A_r1_I<span class="ot">=</span>A_Plot1_Immature_Rhizosphere_df; A_r1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r1_I)]); A_r1_I_def<span class="ot">=</span>A_r1_I[<span class="fu">which</span>(A_r1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2330"><a href="#cb35-2330" aria-hidden="true" tabindex="-1"></a>A_e2_M<span class="ot">=</span>A_Plot2_Mature_Endosphere_df; A_e2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e2_M)]); A_e2_M_def<span class="ot">=</span>A_e2_M[<span class="fu">which</span>(A_e2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2331"><a href="#cb35-2331" aria-hidden="true" tabindex="-1"></a>A_r2_M<span class="ot">=</span>A_Plot2_Mature_Rhizosphere_df; A_r2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r2_M)]); A_r2_M_def<span class="ot">=</span>A_r2_M[<span class="fu">which</span>(A_r2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2332"><a href="#cb35-2332" aria-hidden="true" tabindex="-1"></a>A_r2_I<span class="ot">=</span>A_Plot2_Immature_Rhizosphere_df; A_r2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_r2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_r2_I)]); A_r2_I_def<span class="ot">=</span>A_r2_I[<span class="fu">which</span>(A_r2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_r2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_r2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2333"><a href="#cb35-2333" aria-hidden="true" tabindex="-1"></a>A_e2_I<span class="ot">=</span>A_Plot2_Immature_Endosphere_df; A_e2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(A_e2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(A_e2_I)]);A_e2_I_def<span class="ot">=</span>A_e2_I[<span class="fu">which</span>(A_e2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];A_e2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(A_e2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2334"><a href="#cb35-2334" aria-hidden="true" tabindex="-1"></a>B_r1_M<span class="ot">=</span>B_Plot1_Mature_Rhizosphere_df; B_r1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r1_M)]); B_r1_M_def<span class="ot">=</span>B_r1_M[<span class="fu">which</span>(B_r1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2335"><a href="#cb35-2335" aria-hidden="true" tabindex="-1"></a>B_r1_I<span class="ot">=</span>B_Plot1_Immature_Rhizosphere_df; B_r1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r1_I)]); B_r1_I_def<span class="ot">=</span>B_r1_I[<span class="fu">which</span>(B_r1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2336"><a href="#cb35-2336" aria-hidden="true" tabindex="-1"></a>B_r2_M<span class="ot">=</span>B_Plot2_Mature_Rhizosphere_df; B_r2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r2_M)]); B_r2_M_def<span class="ot">=</span>B_r2_M[<span class="fu">which</span>(B_r2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2337"><a href="#cb35-2337" aria-hidden="true" tabindex="-1"></a>B_r2_I<span class="ot">=</span>B_Plot2_Immature_Rhizosphere_df; B_r2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_r2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_r2_I)]); B_r2_I_def<span class="ot">=</span>B_r2_I[<span class="fu">which</span>(B_r2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_r2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_r2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2338"><a href="#cb35-2338" aria-hidden="true" tabindex="-1"></a>B_e1_I<span class="ot">=</span>B_Plot1_Immature_Endosphere_df; B_e1_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e1_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e1_I)]); B_e1_I_def<span class="ot">=</span>B_e1_I[<span class="fu">which</span>(B_e1_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e1_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e1_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2339"><a href="#cb35-2339" aria-hidden="true" tabindex="-1"></a>B_e1_M<span class="ot">=</span>B_Plot1_Mature_Endosphere_df; B_e1_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e1_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e1_M)]); B_e1_M_def<span class="ot">=</span>B_e1_M[<span class="fu">which</span>(B_e1_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e1_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e1_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2340"><a href="#cb35-2340" aria-hidden="true" tabindex="-1"></a>B_e2_M<span class="ot">=</span>B_Plot2_Mature_Endosphere_df; B_e2_M<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e2_M[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e2_M)]); B_e2_M_def<span class="ot">=</span>B_e2_M[<span class="fu">which</span>(B_e2_M<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e2_M_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e2_M_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2341"><a href="#cb35-2341" aria-hidden="true" tabindex="-1"></a>B_e2_I<span class="ot">=</span>B_Plot2_Immature_Endosphere_df; B_e2_I<span class="sc">$</span>Sum<span class="ot">=</span><span class="fu">rowSums</span>(B_e2_I[,<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(B_e2_I)]); B_e2_I_def<span class="ot">=</span>B_e2_I[<span class="fu">which</span>(B_e2_I<span class="sc">$</span>Sum<span class="sc">&gt;</span><span class="dv">0</span>,<span class="at">arr.ind=</span><span class="cn">TRUE</span>),];B_e2_I_def2<span class="ot">=</span> <span class="fu">subset</span>(B_e2_I_def, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Sum))</span>
<span id="cb35-2342"><a href="#cb35-2342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2343"><a href="#cb35-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2344"><a href="#cb35-2344" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.2 Compare ASVs between mother and sucker plants</span></span>
<span id="cb35-2345"><a href="#cb35-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2346"><a href="#cb35-2346" aria-hidden="true" tabindex="-1"></a>Remember that we want to retain the ASVs that are shared between mother and sucker plants (just in the root endosphere). They could be both inherited or acquired from the rhizosphere soil.</span>
<span id="cb35-2347"><a href="#cb35-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2350"><a href="#cb35-2350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2351"><a href="#cb35-2351" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb35-2352"><a href="#cb35-2352" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb35-2353"><a href="#cb35-2353" aria-hidden="true" tabindex="-1"></a>compartidos_A_e1<span class="ot">=</span><span class="fu">cbind</span>(A_e1_M_def2[A_e1_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e1_I_def2<span class="sc">$</span>ASV_names,], A_e1_I_def2[A_e1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e1_M_def2<span class="sc">$</span>ASV_names,])<span class="co">#retain those ASVs that are in the dataframe of mothers and suckers (root endosphere)</span></span>
<span id="cb35-2354"><a href="#cb35-2354" aria-hidden="true" tabindex="-1"></a>compartidos_A_e1<span class="ot">=</span>compartidos_A_e1[,<span class="sc">-</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)]<span class="co">#removing extra information</span></span>
<span id="cb35-2355"><a href="#cb35-2355" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A_e1),compartidos_A_e1),<span class="at">file=</span><span class="st">"Core_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2356"><a href="#cb35-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2357"><a href="#cb35-2357" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb35-2358"><a href="#cb35-2358" aria-hidden="true" tabindex="-1"></a>compartidos_B_e1<span class="ot">=</span><span class="fu">cbind</span>(B_e1_M_def2[B_e1_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e1_I_def2<span class="sc">$</span>ASV_names,], B_e1_I_def2[B_e1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e1_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2359"><a href="#cb35-2359" aria-hidden="true" tabindex="-1"></a>compartidos_B_e1<span class="ot">=</span>compartidos_B_e1[,<span class="sc">-</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">27</span>)]</span>
<span id="cb35-2360"><a href="#cb35-2360" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B_e1),compartidos_B_e1),<span class="at">file=</span><span class="st">"Core_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2361"><a href="#cb35-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2362"><a href="#cb35-2362" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb35-2363"><a href="#cb35-2363" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb35-2364"><a href="#cb35-2364" aria-hidden="true" tabindex="-1"></a>compartidos_A_e2<span class="ot">=</span><span class="fu">cbind</span>(A_e2_M_def2[A_e2_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e2_I_def2<span class="sc">$</span>ASV_names,], A_e2_I_def2[A_e2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_e2_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2365"><a href="#cb35-2365" aria-hidden="true" tabindex="-1"></a>compartidos_A_e2<span class="ot">=</span>compartidos_A_e2[,<span class="sc">-</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)]</span>
<span id="cb35-2366"><a href="#cb35-2366" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A_e2),compartidos_A_e2),<span class="at">file=</span><span class="st">"Core_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2367"><a href="#cb35-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2368"><a href="#cb35-2368" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) North plot</span></span>
<span id="cb35-2369"><a href="#cb35-2369" aria-hidden="true" tabindex="-1"></a>compartidos_B_e2<span class="ot">=</span><span class="fu">cbind</span>(B_e2_M_def2[B_e2_M_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e2_I_def2<span class="sc">$</span>ASV_names,], B_e2_I_def2[B_e2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_e2_M_def2<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2370"><a href="#cb35-2370" aria-hidden="true" tabindex="-1"></a>compartidos_B_e2<span class="ot">=</span>compartidos_B_e2[,<span class="sc">-</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">26</span>)]</span>
<span id="cb35-2371"><a href="#cb35-2371" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B_e2),compartidos_B_e2),<span class="at">file=</span><span class="st">"Core_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2372"><a href="#cb35-2372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2373"><a href="#cb35-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2374"><a href="#cb35-2374" aria-hidden="true" tabindex="-1"></a>Now, we are going to compare the shared bacterial communities against the bacterial communities dwelling in the rhizosphere soil of the suckers. We will retain bacterial members that are in the root endosphere but **NO** in the rhizosphere soil</span>
<span id="cb35-2375"><a href="#cb35-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2378"><a href="#cb35-2378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2379"><a href="#cb35-2379" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb35-2380"><a href="#cb35-2380" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb35-2381"><a href="#cb35-2381" aria-hidden="true" tabindex="-1"></a>compartidos_A1_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_A_e1[compartidos_A_e1<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_r1_I_def2<span class="sc">$</span>ASV_names,], A_r1_I_def2[A_r1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_A_e1<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2382"><a href="#cb35-2382" aria-hidden="true" tabindex="-1"></a>compartidos_A1_endo_rizo<span class="ot">=</span>compartidos_A1_endo_rizo[,<span class="sc">-</span>(<span class="dv">33</span><span class="sc">:</span><span class="dv">40</span>)]<span class="co">#remove extra information from the data (additional columns indicating, again, the taxonomy of the ASVs)</span></span>
<span id="cb35-2383"><a href="#cb35-2383" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A1_endo_rizo),compartidos_A1_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_A1_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2384"><a href="#cb35-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2385"><a href="#cb35-2385" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb35-2386"><a href="#cb35-2386" aria-hidden="true" tabindex="-1"></a>compartidos_B1_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_B_e1[compartidos_B_e1<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_r1_I_def2<span class="sc">$</span>ASV_names,], B_r1_I_def2[B_r1_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_B_e1<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2387"><a href="#cb35-2387" aria-hidden="true" tabindex="-1"></a>compartidos_B1_endo_rizo<span class="ot">=</span>compartidos_B1_endo_rizo[,<span class="sc">-</span>(<span class="dv">28</span><span class="sc">:</span><span class="dv">35</span>)]</span>
<span id="cb35-2388"><a href="#cb35-2388" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B1_endo_rizo),compartidos_B1_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_B1_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2389"><a href="#cb35-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2390"><a href="#cb35-2390" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb35-2391"><a href="#cb35-2391" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb35-2392"><a href="#cb35-2392" aria-hidden="true" tabindex="-1"></a>compartidos_A2_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_A_e2[compartidos_A_e2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> A_r2_I_def2<span class="sc">$</span>ASV_names,], A_r2_I_def2[A_r2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_A_e2<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2393"><a href="#cb35-2393" aria-hidden="true" tabindex="-1"></a>compartidos_A2_endo_rizo<span class="ot">=</span>compartidos_A2_endo_rizo[,<span class="sc">-</span>(<span class="dv">29</span><span class="sc">:</span><span class="dv">36</span>)]</span>
<span id="cb35-2394"><a href="#cb35-2394" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_A2_endo_rizo),compartidos_A2_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_A2_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2395"><a href="#cb35-2395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2396"><a href="#cb35-2396" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb35-2397"><a href="#cb35-2397" aria-hidden="true" tabindex="-1"></a>compartidos_B2_endo_rizo<span class="ot">=</span><span class="fu">cbind</span>(compartidos_B_e2[compartidos_B_e2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> B_r2_I_def2<span class="sc">$</span>ASV_names,], B_r2_I_def2[B_r2_I_def2<span class="sc">$</span>ASV_names <span class="sc">%in%</span> compartidos_B_e2<span class="sc">$</span>ASV_names,])</span>
<span id="cb35-2398"><a href="#cb35-2398" aria-hidden="true" tabindex="-1"></a>compartidos_B2_endo_rizo<span class="ot">=</span>compartidos_B2_endo_rizo[,<span class="sc">-</span>(<span class="dv">27</span><span class="sc">:</span><span class="dv">34</span>)]</span>
<span id="cb35-2399"><a href="#cb35-2399" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(compartidos_B2_endo_rizo),compartidos_B2_endo_rizo),<span class="at">file=</span><span class="st">"Compartidos_B2_endo_rizo.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2400"><a href="#cb35-2400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2401"><a href="#cb35-2401" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove those ASV detected both in the rhizosphere and in the root endosphere</span></span>
<span id="cb35-2402"><a href="#cb35-2402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2403"><a href="#cb35-2403" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb35-2404"><a href="#cb35-2404" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb35-2405"><a href="#cb35-2405" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_A_e1, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_A1_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2406"><a href="#cb35-2406" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A1_endo),especif_A1_endo),<span class="at">file=</span><span class="st">"A1_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2407"><a href="#cb35-2407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2408"><a href="#cb35-2408" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb35-2409"><a href="#cb35-2409" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_B_e1, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_B1_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2410"><a href="#cb35-2410" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B1_endo),especif_B1_endo),<span class="at">file=</span><span class="st">"B1_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2411"><a href="#cb35-2411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2412"><a href="#cb35-2412" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb35-2413"><a href="#cb35-2413" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb35-2414"><a href="#cb35-2414" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_A_e2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_A2_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2415"><a href="#cb35-2415" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A2_endo),especif_A2_endo),<span class="at">file=</span><span class="st">"A2_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2416"><a href="#cb35-2416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2417"><a href="#cb35-2417" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb35-2418"><a href="#cb35-2418" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="ot">=</span><span class="fu">subset</span>(compartidos_B_e2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> compartidos_B2_endo_rizo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2419"><a href="#cb35-2419" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B2_endo),especif_B2_endo),<span class="at">file=</span><span class="st">"B2_Endo_Transmitidos_Madreahija.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2420"><a href="#cb35-2420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2421"><a href="#cb35-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2422"><a href="#cb35-2422" aria-hidden="true" tabindex="-1"></a>In this work, we analyzed carefully the number and proportions of the transferred ASVs in Excel</span>
<span id="cb35-2423"><a href="#cb35-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2424"><a href="#cb35-2424" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7.3 Plotting</span></span>
<span id="cb35-2425"><a href="#cb35-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2426"><a href="#cb35-2426" aria-hidden="true" tabindex="-1"></a>In this section, we are going to make different graph representing the inheritance process. We will use barplots</span>
<span id="cb35-2427"><a href="#cb35-2427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2430"><a href="#cb35-2430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2431"><a href="#cb35-2431" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb35-2432"><a href="#cb35-2432" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb35-2433"><a href="#cb35-2433" aria-hidden="true" tabindex="-1"></a>totales_M_A_e1<span class="ot">=</span><span class="fu">nrow</span>(A_e1_M_def2)<span class="co">#get the total number of ASV in mothers</span></span>
<span id="cb35-2434"><a href="#cb35-2434" aria-hidden="true" tabindex="-1"></a>transferidos_A_e1<span class="ot">=</span><span class="fu">nrow</span>(especif_A1_endo)<span class="co">#get the number of shared ASVs between mothers and suckers</span></span>
<span id="cb35-2435"><a href="#cb35-2435" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_A_e1<span class="ot">=</span>(transferidos_A_e1 <span class="sc">/</span> totales_M_A_e1) <span class="sc">*</span><span class="dv">100</span> <span class="co">#calculate the proportion of transferred ASVs</span></span>
<span id="cb35-2436"><a href="#cb35-2436" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_A_e1<span class="ot">=</span>((totales_M_A_e1<span class="sc">-</span>transferidos_A_e1) <span class="sc">/</span> totales_M_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#calculate the proportion of ASVs lost by the mothers</span></span>
<span id="cb35-2437"><a href="#cb35-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2438"><a href="#cb35-2438" aria-hidden="true" tabindex="-1"></a>totales_I_A_e1<span class="ot">=</span><span class="fu">nrow</span>(A_e1_I_def2)<span class="co">#get the total number of ASVs in suckers</span></span>
<span id="cb35-2439"><a href="#cb35-2439" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_A_e1<span class="ot">=</span>(transferidos_A_e1 <span class="sc">/</span> totales_I_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#get the number of shared ASVs between mothers and suckers</span></span>
<span id="cb35-2440"><a href="#cb35-2440" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_A_e1<span class="ot">=</span>((totales_I_A_e1<span class="sc">-</span>transferidos_A_e1) <span class="sc">/</span> totales_I_A_e1) <span class="sc">*</span><span class="dv">100</span><span class="co">#calculate the proportion of ASVs acquired by the suckers</span></span>
<span id="cb35-2441"><a href="#cb35-2441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2442"><a href="#cb35-2442" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_A_e1,prop_perdidos_M_A_e1,</span>
<span id="cb35-2443"><a href="#cb35-2443" aria-hidden="true" tabindex="-1"></a>                              prop_transferidos_I_A_e1,prop_adquiridos_I_A_e1))<span class="co">#create a dataframe with all the values in order to plot them </span></span>
<span id="cb35-2444"><a href="#cb35-2444" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"A"</span></span>
<span id="cb35-2445"><a href="#cb35-2445" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb35-2446"><a href="#cb35-2446" aria-hidden="true" tabindex="-1"></a>barras_A_e1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb35-2447"><a href="#cb35-2447" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_A_e1)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb35-2448"><a href="#cb35-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2449"><a href="#cb35-2449" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb35-2450"><a href="#cb35-2450" aria-hidden="true" tabindex="-1"></a>totales_M_B_e1<span class="ot">=</span><span class="fu">nrow</span>(B_e1_M_def2)</span>
<span id="cb35-2451"><a href="#cb35-2451" aria-hidden="true" tabindex="-1"></a>transferidos_B_e1<span class="ot">=</span><span class="fu">nrow</span>(especif_B1_endo)</span>
<span id="cb35-2452"><a href="#cb35-2452" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_B_e1<span class="ot">=</span>(transferidos_B_e1 <span class="sc">/</span> totales_M_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2453"><a href="#cb35-2453" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_B_e1<span class="ot">=</span>((totales_M_B_e1<span class="sc">-</span>transferidos_B_e1) <span class="sc">/</span> totales_M_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2454"><a href="#cb35-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2455"><a href="#cb35-2455" aria-hidden="true" tabindex="-1"></a>totales_I_B_e1<span class="ot">=</span><span class="fu">nrow</span>(B_e1_I_def2)</span>
<span id="cb35-2456"><a href="#cb35-2456" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_B_e1<span class="ot">=</span>(transferidos_B_e1 <span class="sc">/</span> totales_I_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2457"><a href="#cb35-2457" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_B_e1<span class="ot">=</span>((totales_I_B_e1<span class="sc">-</span>transferidos_B_e1) <span class="sc">/</span> totales_I_B_e1) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2458"><a href="#cb35-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2459"><a href="#cb35-2459" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_B_e1,prop_perdidos_M_B_e1,</span>
<span id="cb35-2460"><a href="#cb35-2460" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_B_e1,prop_adquiridos_I_B_e1))</span>
<span id="cb35-2461"><a href="#cb35-2461" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"B"</span></span>
<span id="cb35-2462"><a href="#cb35-2462" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb35-2463"><a href="#cb35-2463" aria-hidden="true" tabindex="-1"></a>barras_B_e1<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb35-2464"><a href="#cb35-2464" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_B_e1)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb35-2465"><a href="#cb35-2465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2466"><a href="#cb35-2466" aria-hidden="true" tabindex="-1"></a>A_e1<span class="ot">=</span><span class="fu">ggplot</span>(barras_A_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2467"><a href="#cb35-2467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2468"><a href="#cb35-2468" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2469"><a href="#cb35-2469" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2470"><a href="#cb35-2470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"South plot (2022)"</span>)<span class="sc">+</span></span>
<span id="cb35-2471"><a href="#cb35-2471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2472"><a href="#cb35-2472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2473"><a href="#cb35-2473" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2474"><a href="#cb35-2474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2475"><a href="#cb35-2475" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2476"><a href="#cb35-2476" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2477"><a href="#cb35-2477" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2478"><a href="#cb35-2478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2479"><a href="#cb35-2479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2480"><a href="#cb35-2480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2481"><a href="#cb35-2481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2482"><a href="#cb35-2482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2483"><a href="#cb35-2483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2484"><a href="#cb35-2484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2485"><a href="#cb35-2485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2486"><a href="#cb35-2486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2487"><a href="#cb35-2487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2488"><a href="#cb35-2488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2489"><a href="#cb35-2489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2490"><a href="#cb35-2490" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2491"><a href="#cb35-2491" aria-hidden="true" tabindex="-1"></a>A_e1</span>
<span id="cb35-2492"><a href="#cb35-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2493"><a href="#cb35-2493" aria-hidden="true" tabindex="-1"></a>B_e1<span class="ot">=</span><span class="fu">ggplot</span>(barras_B_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2494"><a href="#cb35-2494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2495"><a href="#cb35-2495" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2496"><a href="#cb35-2496" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2497"><a href="#cb35-2497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"South plot (2023)"</span>)<span class="sc">+</span></span>
<span id="cb35-2498"><a href="#cb35-2498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2499"><a href="#cb35-2499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2500"><a href="#cb35-2500" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2501"><a href="#cb35-2501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2502"><a href="#cb35-2502" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2503"><a href="#cb35-2503" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2504"><a href="#cb35-2504" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2505"><a href="#cb35-2505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2506"><a href="#cb35-2506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2507"><a href="#cb35-2507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2508"><a href="#cb35-2508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2509"><a href="#cb35-2509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2510"><a href="#cb35-2510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2511"><a href="#cb35-2511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2512"><a href="#cb35-2512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2513"><a href="#cb35-2513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2514"><a href="#cb35-2514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2515"><a href="#cb35-2515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2516"><a href="#cb35-2516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2517"><a href="#cb35-2517" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2518"><a href="#cb35-2518" aria-hidden="true" tabindex="-1"></a>B_e1</span>
<span id="cb35-2519"><a href="#cb35-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2520"><a href="#cb35-2520" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2521"><a href="#cb35-2521" aria-hidden="true" tabindex="-1"></a>p_Plot1<span class="ot">=</span><span class="fu">grid.arrange</span>(A_e1,B_e1,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 1"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb35-2522"><a href="#cb35-2522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2523"><a href="#cb35-2523" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb35-2524"><a href="#cb35-2524" aria-hidden="true" tabindex="-1"></a><span class="co">#b.1) 2022</span></span>
<span id="cb35-2525"><a href="#cb35-2525" aria-hidden="true" tabindex="-1"></a>totales_M_A_e2<span class="ot">=</span><span class="fu">nrow</span>(A_e2_M_def2)</span>
<span id="cb35-2526"><a href="#cb35-2526" aria-hidden="true" tabindex="-1"></a>transferidos_A_e2<span class="ot">=</span><span class="fu">nrow</span>(especif_A2_endo)</span>
<span id="cb35-2527"><a href="#cb35-2527" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_A_e2<span class="ot">=</span>(transferidos_A_e2 <span class="sc">/</span> totales_M_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2528"><a href="#cb35-2528" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_A_e2<span class="ot">=</span>((totales_M_A_e2<span class="sc">-</span>transferidos_A_e2) <span class="sc">/</span> totales_M_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2529"><a href="#cb35-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2530"><a href="#cb35-2530" aria-hidden="true" tabindex="-1"></a>totales_I_A_e2<span class="ot">=</span><span class="fu">nrow</span>(A_e2_I_def2)</span>
<span id="cb35-2531"><a href="#cb35-2531" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_A_e2<span class="ot">=</span>(transferidos_A_e2 <span class="sc">/</span> totales_I_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2532"><a href="#cb35-2532" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_A_e2<span class="ot">=</span>((totales_I_A_e2<span class="sc">-</span>transferidos_A_e2) <span class="sc">/</span> totales_I_A_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2533"><a href="#cb35-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2534"><a href="#cb35-2534" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_A_e2,prop_perdidos_M_A_e2,</span>
<span id="cb35-2535"><a href="#cb35-2535" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_A_e2,prop_adquiridos_I_A_e2))</span>
<span id="cb35-2536"><a href="#cb35-2536" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"A"</span></span>
<span id="cb35-2537"><a href="#cb35-2537" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb35-2538"><a href="#cb35-2538" aria-hidden="true" tabindex="-1"></a>barras_A_e2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb35-2539"><a href="#cb35-2539" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_A_e2)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb35-2540"><a href="#cb35-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2541"><a href="#cb35-2541" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb35-2542"><a href="#cb35-2542" aria-hidden="true" tabindex="-1"></a>totales_M_B_e2<span class="ot">=</span><span class="fu">nrow</span>(B_e2_M_def2)</span>
<span id="cb35-2543"><a href="#cb35-2543" aria-hidden="true" tabindex="-1"></a>transferidos_B_e2<span class="ot">=</span><span class="fu">nrow</span>(especif_B2_endo)</span>
<span id="cb35-2544"><a href="#cb35-2544" aria-hidden="true" tabindex="-1"></a>prop_transferidos_M_B_e2<span class="ot">=</span>(transferidos_B_e2 <span class="sc">/</span> totales_M_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2545"><a href="#cb35-2545" aria-hidden="true" tabindex="-1"></a>prop_perdidos_M_B_e2<span class="ot">=</span>((totales_M_B_e2<span class="sc">-</span>transferidos_B_e2) <span class="sc">/</span> totales_M_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2546"><a href="#cb35-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2547"><a href="#cb35-2547" aria-hidden="true" tabindex="-1"></a>totales_I_B_e2<span class="ot">=</span><span class="fu">nrow</span>(B_e2_I_def2)</span>
<span id="cb35-2548"><a href="#cb35-2548" aria-hidden="true" tabindex="-1"></a>prop_transferidos_I_B_e2<span class="ot">=</span>(transferidos_B_e2 <span class="sc">/</span> totales_I_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2549"><a href="#cb35-2549" aria-hidden="true" tabindex="-1"></a>prop_adquiridos_I_B_e2<span class="ot">=</span>((totales_I_B_e2<span class="sc">-</span>transferidos_B_e2) <span class="sc">/</span> totales_I_B_e2) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb35-2550"><a href="#cb35-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2551"><a href="#cb35-2551" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(prop_transferidos_M_B_e2,prop_perdidos_M_B_e2,</span>
<span id="cb35-2552"><a href="#cb35-2552" aria-hidden="true" tabindex="-1"></a>                                prop_transferidos_I_B_e2,prop_adquiridos_I_B_e2))</span>
<span id="cb35-2553"><a href="#cb35-2553" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Year<span class="ot">=</span><span class="st">"B"</span></span>
<span id="cb35-2554"><a href="#cb35-2554" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Plant<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Mother"</span>, <span class="st">"Mother"</span>, <span class="st">"Sucker"</span>, <span class="st">"Sucker"</span>)</span>
<span id="cb35-2555"><a href="#cb35-2555" aria-hidden="true" tabindex="-1"></a>barras_B_e2<span class="sc">$</span>Condition<span class="ot">=</span><span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))</span>
<span id="cb35-2556"><a href="#cb35-2556" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_B_e2)[<span class="dv">1</span>]<span class="ot">=</span><span class="st">"Proportion"</span></span>
<span id="cb35-2557"><a href="#cb35-2557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2558"><a href="#cb35-2558" aria-hidden="true" tabindex="-1"></a>A_e2<span class="ot">=</span><span class="fu">ggplot</span>(barras_A_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2559"><a href="#cb35-2559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2560"><a href="#cb35-2560" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2561"><a href="#cb35-2561" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2562"><a href="#cb35-2562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"North plot (2022)"</span>)<span class="sc">+</span></span>
<span id="cb35-2563"><a href="#cb35-2563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2564"><a href="#cb35-2564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2565"><a href="#cb35-2565" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2566"><a href="#cb35-2566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2567"><a href="#cb35-2567" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2568"><a href="#cb35-2568" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2569"><a href="#cb35-2569" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2570"><a href="#cb35-2570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2571"><a href="#cb35-2571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2572"><a href="#cb35-2572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2573"><a href="#cb35-2573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2574"><a href="#cb35-2574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2575"><a href="#cb35-2575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2576"><a href="#cb35-2576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2577"><a href="#cb35-2577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2578"><a href="#cb35-2578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2579"><a href="#cb35-2579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2580"><a href="#cb35-2580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2581"><a href="#cb35-2581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2582"><a href="#cb35-2582" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2583"><a href="#cb35-2583" aria-hidden="true" tabindex="-1"></a>A_e2</span>
<span id="cb35-2584"><a href="#cb35-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2585"><a href="#cb35-2585" aria-hidden="true" tabindex="-1"></a>B_e2<span class="ot">=</span><span class="fu">ggplot</span>(barras_B_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Proportion, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2586"><a href="#cb35-2586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2587"><a href="#cb35-2587" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2588"><a href="#cb35-2588" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2589"><a href="#cb35-2589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Proportion of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"North plot (2023)"</span>)<span class="sc">+</span></span>
<span id="cb35-2590"><a href="#cb35-2590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2591"><a href="#cb35-2591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2592"><a href="#cb35-2592" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2593"><a href="#cb35-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2594"><a href="#cb35-2594" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2595"><a href="#cb35-2595" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2596"><a href="#cb35-2596" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2597"><a href="#cb35-2597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2598"><a href="#cb35-2598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2599"><a href="#cb35-2599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2600"><a href="#cb35-2600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2601"><a href="#cb35-2601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2602"><a href="#cb35-2602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2603"><a href="#cb35-2603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2604"><a href="#cb35-2604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2605"><a href="#cb35-2605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2606"><a href="#cb35-2606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2607"><a href="#cb35-2607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2608"><a href="#cb35-2608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2609"><a href="#cb35-2609" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2610"><a href="#cb35-2610" aria-hidden="true" tabindex="-1"></a>B_e1</span>
<span id="cb35-2611"><a href="#cb35-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2612"><a href="#cb35-2612" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2613"><a href="#cb35-2613" aria-hidden="true" tabindex="-1"></a>p_Plot2<span class="ot">=</span><span class="fu">grid.arrange</span>(A_e2,B_e2,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 2"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb35-2614"><a href="#cb35-2614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2615"><a href="#cb35-2615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2616"><a href="#cb35-2616" aria-hidden="true" tabindex="-1"></a>With this code a bar plot is created (see Figure 8)</span>
<span id="cb35-2617"><a href="#cb35-2617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2618"><a href="#cb35-2618" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure 8. Bar plot indicating the transferred ASV, ASVs lost by the mothers, and ASVs acquired from the environment by the suckers](images/Inheritance.jpg)</span>{fig-align="center"}</span>
<span id="cb35-2619"><a href="#cb35-2619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2620"><a href="#cb35-2620" aria-hidden="true" tabindex="-1"></a>We are going to obtain the same plots but instead of plotting the proportion of ASVs lost, acquired and transferred, the relative abundance of each of them will be visualized</span>
<span id="cb35-2621"><a href="#cb35-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2624"><a href="#cb35-2624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2625"><a href="#cb35-2625" aria-hidden="true" tabindex="-1"></a><span class="co">#a) South plot</span></span>
<span id="cb35-2626"><a href="#cb35-2626" aria-hidden="true" tabindex="-1"></a><span class="co">#a.1) 2022</span></span>
<span id="cb35-2627"><a href="#cb35-2627" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1<span class="ot">=</span><span class="fu">subset</span>(A_e1_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A1_endo<span class="sc">$</span>ASV_names))<span class="co">#these are the ASVs that mothers lost</span></span>
<span id="cb35-2628"><a href="#cb35-2628" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_A_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_A_e1))))<span class="co">#mean relative abundance of each of them</span></span>
<span id="cb35-2629"><a href="#cb35-2629" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e1_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_A_e1<span class="sc">$</span>Promedio)<span class="co">#sum the relative abundance of all the ASVs lost by the mothers</span></span>
<span id="cb35-2630"><a href="#cb35-2630" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1<span class="ot">=</span><span class="fu">subset</span>(A_e1_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A1_endo<span class="sc">$</span>ASV_names))<span class="co">#these are the ASVs that suckers retain from the environment</span></span>
<span id="cb35-2631"><a href="#cb35-2631" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_A_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_A_e1))))<span class="co">#mean</span></span>
<span id="cb35-2632"><a href="#cb35-2632" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e1_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_A_e1<span class="sc">$</span>Promedio)</span>
<span id="cb35-2633"><a href="#cb35-2633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2634"><a href="#cb35-2634" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">19</span>)))<span class="co">#mean relative abundance of transferred ASVs (in mothers samples)</span></span>
<span id="cb35-2635"><a href="#cb35-2635" aria-hidden="true" tabindex="-1"></a>especif_A1_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A1_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb35-2636"><a href="#cb35-2636" aria-hidden="true" tabindex="-1"></a>especif_A1_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">30</span>)))<span class="co">#mean relative abundance of acquired ASV from mothers (in suckers samples)</span></span>
<span id="cb35-2637"><a href="#cb35-2637" aria-hidden="true" tabindex="-1"></a>especif_A1_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A1_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb35-2638"><a href="#cb35-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2639"><a href="#cb35-2639" aria-hidden="true" tabindex="-1"></a>Abund_A1_endo<span class="ot">=</span><span class="fu">c</span>(especif_A1_endo_M_sum,perdidos_M_A_e1_sum,especif_A1_endo_I_sum,adquiridos_I_A_e1_sum)</span>
<span id="cb35-2640"><a href="#cb35-2640" aria-hidden="true" tabindex="-1"></a>barras_abund_A_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_A_e1,Abund_A1_endo))<span class="co">#create a new dataframe with all the data</span></span>
<span id="cb35-2641"><a href="#cb35-2641" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_A_e1)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb35-2642"><a href="#cb35-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2643"><a href="#cb35-2643" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_A_e1),perdidos_M_A_e1),<span class="st">"AbunRel_perdidos_Madre_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2644"><a href="#cb35-2644" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_A_e1),adquiridos_I_A_e1),<span class="st">"AbunRel_AdquiridosAmbiente_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2645"><a href="#cb35-2645" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A1_endo),especif_A1_endo),<span class="st">"AbunRel_TransferidosMadreHija_A_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2646"><a href="#cb35-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2647"><a href="#cb35-2647" aria-hidden="true" tabindex="-1"></a><span class="co">#a.2) 2023</span></span>
<span id="cb35-2648"><a href="#cb35-2648" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1<span class="ot">=</span><span class="fu">subset</span>(B_e1_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B1_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2649"><a href="#cb35-2649" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_B_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_B_e1))))</span>
<span id="cb35-2650"><a href="#cb35-2650" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e1_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_B_e1<span class="sc">$</span>Promedio)</span>
<span id="cb35-2651"><a href="#cb35-2651" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1<span class="ot">=</span><span class="fu">subset</span>(B_e1_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B1_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2652"><a href="#cb35-2652" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_B_e1, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_B_e1))))</span>
<span id="cb35-2653"><a href="#cb35-2653" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e1_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_B_e1<span class="sc">$</span>Promedio)</span>
<span id="cb35-2654"><a href="#cb35-2654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2655"><a href="#cb35-2655" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">19</span>)))</span>
<span id="cb35-2656"><a href="#cb35-2656" aria-hidden="true" tabindex="-1"></a>especif_B1_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B1_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb35-2657"><a href="#cb35-2657" aria-hidden="true" tabindex="-1"></a>especif_B1_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B1_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">27</span>)))</span>
<span id="cb35-2658"><a href="#cb35-2658" aria-hidden="true" tabindex="-1"></a>especif_B1_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B1_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb35-2659"><a href="#cb35-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2660"><a href="#cb35-2660" aria-hidden="true" tabindex="-1"></a>Abund_B1_endo<span class="ot">=</span><span class="fu">c</span>(especif_B1_endo_M_sum,perdidos_M_B_e1_sum,especif_B1_endo_I_sum,adquiridos_I_B_e1_sum)</span>
<span id="cb35-2661"><a href="#cb35-2661" aria-hidden="true" tabindex="-1"></a>barras_abund_B_e1<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_B_e1,Abund_B1_endo))</span>
<span id="cb35-2662"><a href="#cb35-2662" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_B_e1)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb35-2663"><a href="#cb35-2663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2664"><a href="#cb35-2664" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_B_e1),perdidos_M_B_e1),<span class="st">"AbunRel_perdidos_Madre_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2665"><a href="#cb35-2665" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_B_e1),adquiridos_I_B_e1),<span class="st">"AbunRel_AdquiridosAmbiente_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2666"><a href="#cb35-2666" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B1_endo),especif_B1_endo),<span class="st">"AbunRel_TransferidosMadreHija_B_e1.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2667"><a href="#cb35-2667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2668"><a href="#cb35-2668" aria-hidden="true" tabindex="-1"></a><span class="co">#b) North plot</span></span>
<span id="cb35-2669"><a href="#cb35-2669" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2022</span></span>
<span id="cb35-2670"><a href="#cb35-2670" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2<span class="ot">=</span><span class="fu">subset</span>(A_e2_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2671"><a href="#cb35-2671" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_A_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_A_e2))))</span>
<span id="cb35-2672"><a href="#cb35-2672" aria-hidden="true" tabindex="-1"></a>perdidos_M_A_e2_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_A_e2<span class="sc">$</span>Promedio)</span>
<span id="cb35-2673"><a href="#cb35-2673" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2<span class="ot">=</span><span class="fu">subset</span>(A_e2_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_A2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2674"><a href="#cb35-2674" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_A_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_A_e2))))</span>
<span id="cb35-2675"><a href="#cb35-2675" aria-hidden="true" tabindex="-1"></a>adquiridos_I_A_e2_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_A_e2<span class="sc">$</span>Promedio)</span>
<span id="cb35-2676"><a href="#cb35-2676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2677"><a href="#cb35-2677" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">20</span>)))</span>
<span id="cb35-2678"><a href="#cb35-2678" aria-hidden="true" tabindex="-1"></a>especif_A2_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A2_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb35-2679"><a href="#cb35-2679" aria-hidden="true" tabindex="-1"></a>especif_A2_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_A2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">28</span>)))</span>
<span id="cb35-2680"><a href="#cb35-2680" aria-hidden="true" tabindex="-1"></a>especif_A2_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_A2_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb35-2681"><a href="#cb35-2681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2682"><a href="#cb35-2682" aria-hidden="true" tabindex="-1"></a>Abund_A2_endo<span class="ot">=</span><span class="fu">c</span>(especif_A2_endo_M_sum,perdidos_M_A_e2_sum,especif_A2_endo_I_sum,adquiridos_I_A_e2_sum)</span>
<span id="cb35-2683"><a href="#cb35-2683" aria-hidden="true" tabindex="-1"></a>barras_abund_A_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_A_e2,Abund_A2_endo))</span>
<span id="cb35-2684"><a href="#cb35-2684" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_A_e2)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb35-2685"><a href="#cb35-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2686"><a href="#cb35-2686" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_A_e2),perdidos_M_A_e2),<span class="st">"AbunRel_perdidos_Madre_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2687"><a href="#cb35-2687" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_A_e2),adquiridos_I_A_e2),<span class="st">"AbunRel_AdquiridosAmbiente_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2688"><a href="#cb35-2688" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_A2_endo),especif_A2_endo),<span class="st">"AbunRel_TransferidosMadreHija_A_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2689"><a href="#cb35-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2690"><a href="#cb35-2690" aria-hidden="true" tabindex="-1"></a><span class="co">#b.2) 2023</span></span>
<span id="cb35-2691"><a href="#cb35-2691" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2<span class="ot">=</span><span class="fu">subset</span>(B_e2_M_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2692"><a href="#cb35-2692" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(perdidos_M_B_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(perdidos_M_B_e2))))</span>
<span id="cb35-2693"><a href="#cb35-2693" aria-hidden="true" tabindex="-1"></a>perdidos_M_B_e2_sum<span class="ot">=</span><span class="fu">sum</span>(perdidos_M_B_e2<span class="sc">$</span>Promedio)</span>
<span id="cb35-2694"><a href="#cb35-2694" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2<span class="ot">=</span><span class="fu">subset</span>(B_e2_I_def2, <span class="sc">!</span>(ASV_names <span class="sc">%in%</span> especif_B2_endo<span class="sc">$</span>ASV_names))</span>
<span id="cb35-2695"><a href="#cb35-2695" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2<span class="sc">$</span>Promedio<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(adquiridos_I_B_e2, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="fu">ncol</span>(adquiridos_I_B_e2))))</span>
<span id="cb35-2696"><a href="#cb35-2696" aria-hidden="true" tabindex="-1"></a>adquiridos_I_B_e2_sum<span class="ot">=</span><span class="fu">sum</span>(adquiridos_I_B_e2<span class="sc">$</span>Promedio)</span>
<span id="cb35-2697"><a href="#cb35-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2698"><a href="#cb35-2698" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="sc">$</span>Promedio_Madre<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">9</span><span class="sc">:</span><span class="dv">18</span>)))</span>
<span id="cb35-2699"><a href="#cb35-2699" aria-hidden="true" tabindex="-1"></a>especif_B2_endo_M_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B2_endo<span class="sc">$</span>Promedio_Madre)  </span>
<span id="cb35-2700"><a href="#cb35-2700" aria-hidden="true" tabindex="-1"></a>especif_B2_endo<span class="sc">$</span>Promedio_Hijas<span class="ot">=</span><span class="fu">rowMeans</span>(<span class="fu">subset</span>(especif_B2_endo, <span class="at">select =</span><span class="fu">c</span>(<span class="dv">19</span><span class="sc">:</span><span class="dv">26</span>)))</span>
<span id="cb35-2701"><a href="#cb35-2701" aria-hidden="true" tabindex="-1"></a>especif_B2_endo_I_sum<span class="ot">=</span><span class="fu">sum</span>(especif_B2_endo<span class="sc">$</span>Promedio_Hijas)</span>
<span id="cb35-2702"><a href="#cb35-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2703"><a href="#cb35-2703" aria-hidden="true" tabindex="-1"></a>Abund_B2_endo<span class="ot">=</span><span class="fu">c</span>(especif_B2_endo_M_sum,perdidos_M_B_e2_sum,especif_B2_endo_I_sum,adquiridos_I_B_e2_sum)</span>
<span id="cb35-2704"><a href="#cb35-2704" aria-hidden="true" tabindex="-1"></a>barras_abund_B_e2<span class="ot">=</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(barras_B_e2,Abund_B2_endo))</span>
<span id="cb35-2705"><a href="#cb35-2705" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(barras_abund_B_e2)[<span class="dv">5</span>]<span class="ot">=</span><span class="st">"Abundance"</span></span>
<span id="cb35-2706"><a href="#cb35-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2707"><a href="#cb35-2707" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(perdidos_M_B_e2),perdidos_M_B_e2),<span class="st">"AbunRel_perdidos_Madre_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2708"><a href="#cb35-2708" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(adquiridos_I_B_e2),adquiridos_I_B_e2),<span class="st">"AbunRel_AdquiridosAmbiente_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2709"><a href="#cb35-2709" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"X"</span><span class="ot">=</span><span class="fu">rownames</span>(especif_B2_endo),especif_B2_endo),<span class="st">"AbunRel_TransferidosMadreHija_B_e2.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,<span class="at">row.names =</span> F)</span>
<span id="cb35-2710"><a href="#cb35-2710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2711"><a href="#cb35-2711" aria-hidden="true" tabindex="-1"></a>A1_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_A_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2712"><a href="#cb35-2712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2713"><a href="#cb35-2713" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2714"><a href="#cb35-2714" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2715"><a href="#cb35-2715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 1 (2022)"</span>)<span class="sc">+</span></span>
<span id="cb35-2716"><a href="#cb35-2716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2717"><a href="#cb35-2717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2718"><a href="#cb35-2718" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2719"><a href="#cb35-2719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2720"><a href="#cb35-2720" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2721"><a href="#cb35-2721" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2722"><a href="#cb35-2722" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2723"><a href="#cb35-2723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2724"><a href="#cb35-2724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2725"><a href="#cb35-2725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2726"><a href="#cb35-2726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2727"><a href="#cb35-2727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2728"><a href="#cb35-2728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2729"><a href="#cb35-2729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2730"><a href="#cb35-2730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2731"><a href="#cb35-2731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2732"><a href="#cb35-2732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2733"><a href="#cb35-2733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2734"><a href="#cb35-2734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2735"><a href="#cb35-2735" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2736"><a href="#cb35-2736" aria-hidden="true" tabindex="-1"></a>A1_abun</span>
<span id="cb35-2737"><a href="#cb35-2737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2738"><a href="#cb35-2738" aria-hidden="true" tabindex="-1"></a>B1_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_B_e1, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2739"><a href="#cb35-2739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2740"><a href="#cb35-2740" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2741"><a href="#cb35-2741" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2742"><a href="#cb35-2742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 1 (2023)"</span>)<span class="sc">+</span></span>
<span id="cb35-2743"><a href="#cb35-2743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2744"><a href="#cb35-2744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2745"><a href="#cb35-2745" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2746"><a href="#cb35-2746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2747"><a href="#cb35-2747" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2748"><a href="#cb35-2748" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2749"><a href="#cb35-2749" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2750"><a href="#cb35-2750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2751"><a href="#cb35-2751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2752"><a href="#cb35-2752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2753"><a href="#cb35-2753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2754"><a href="#cb35-2754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2755"><a href="#cb35-2755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2756"><a href="#cb35-2756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2757"><a href="#cb35-2757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2758"><a href="#cb35-2758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2759"><a href="#cb35-2759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2760"><a href="#cb35-2760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2761"><a href="#cb35-2761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2762"><a href="#cb35-2762" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2763"><a href="#cb35-2763" aria-hidden="true" tabindex="-1"></a>B1_abun</span>
<span id="cb35-2764"><a href="#cb35-2764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2765"><a href="#cb35-2765" aria-hidden="true" tabindex="-1"></a>A2_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_A_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2766"><a href="#cb35-2766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2767"><a href="#cb35-2767" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2768"><a href="#cb35-2768" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2769"><a href="#cb35-2769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 2 (2022)"</span>)<span class="sc">+</span></span>
<span id="cb35-2770"><a href="#cb35-2770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2771"><a href="#cb35-2771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2772"><a href="#cb35-2772" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2773"><a href="#cb35-2773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2774"><a href="#cb35-2774" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2775"><a href="#cb35-2775" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2776"><a href="#cb35-2776" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2777"><a href="#cb35-2777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2778"><a href="#cb35-2778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2779"><a href="#cb35-2779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2780"><a href="#cb35-2780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2781"><a href="#cb35-2781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2782"><a href="#cb35-2782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2783"><a href="#cb35-2783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2784"><a href="#cb35-2784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2785"><a href="#cb35-2785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2786"><a href="#cb35-2786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2787"><a href="#cb35-2787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2788"><a href="#cb35-2788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2789"><a href="#cb35-2789" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2790"><a href="#cb35-2790" aria-hidden="true" tabindex="-1"></a>A2_abun</span>
<span id="cb35-2791"><a href="#cb35-2791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2792"><a href="#cb35-2792" aria-hidden="true" tabindex="-1"></a>B2_abun<span class="ot">=</span><span class="fu">ggplot</span>(barras_abund_B_e2, <span class="fu">aes</span>(<span class="at">x=</span>Plant, <span class="at">y=</span>Abundance, <span class="at">fill=</span>Condition, <span class="at">order=</span>Condition)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>)<span class="sc">+</span></span>
<span id="cb35-2793"><a href="#cb35-2793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"magenta"</span>, <span class="st">"deepskyblue"</span>, <span class="st">"magenta"</span>,<span class="st">"green"</span>),</span>
<span id="cb35-2794"><a href="#cb35-2794" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Transmitted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>),</span>
<span id="cb35-2795"><a href="#cb35-2795" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Transmimtted"</span>,<span class="st">"Lost"</span>, <span class="st">"Transmitted"</span>, <span class="st">"Acquired"</span>))<span class="sc">+</span></span>
<span id="cb35-2796"><a href="#cb35-2796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Relative abundance of ASV (%)"</span>, <span class="at">x=</span><span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Condition"</span>,<span class="at">title=</span><span class="st">"Plot 2 (2023)"</span>)<span class="sc">+</span></span>
<span id="cb35-2797"><a href="#cb35-2797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb35-2798"><a href="#cb35-2798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>),</span>
<span id="cb35-2799"><a href="#cb35-2799" aria-hidden="true" tabindex="-1"></a>                   <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Mother"</span>,<span class="st">"Sucker"</span>))<span class="sc">+</span></span>
<span id="cb35-2800"><a href="#cb35-2800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb35-2801"><a href="#cb35-2801" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>),</span>
<span id="cb35-2802"><a href="#cb35-2802" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"0"</span>,<span class="st">"10"</span>, <span class="st">"20"</span>,<span class="st">"30"</span>,<span class="st">"40"</span>,<span class="st">"50"</span>,<span class="st">"60"</span>,<span class="st">"70"</span>,<span class="st">"80"</span>,<span class="st">"90"</span>,<span class="st">"100"</span>),</span>
<span id="cb35-2803"><a href="#cb35-2803" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">101</span>))<span class="sc">+</span></span>
<span id="cb35-2804"><a href="#cb35-2804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb35-2805"><a href="#cb35-2805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb35-2806"><a href="#cb35-2806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb35-2807"><a href="#cb35-2807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2808"><a href="#cb35-2808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb35-2809"><a href="#cb35-2809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>, <span class="at">size=</span><span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2810"><a href="#cb35-2810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))<span class="sc">+</span></span>
<span id="cb35-2811"><a href="#cb35-2811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.9</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb35-2812"><a href="#cb35-2812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>))<span class="sc">+</span></span>
<span id="cb35-2813"><a href="#cb35-2813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>, <span class="at">face=</span><span class="st">"bold"</span>))<span class="sc">+</span></span>
<span id="cb35-2814"><a href="#cb35-2814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title.align=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb35-2815"><a href="#cb35-2815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text.align =</span> <span class="dv">0</span>)</span>
<span id="cb35-2816"><a href="#cb35-2816" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2817"><a href="#cb35-2817" aria-hidden="true" tabindex="-1"></a>B2_abun</span>
<span id="cb35-2818"><a href="#cb35-2818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2819"><a href="#cb35-2819" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2820"><a href="#cb35-2820" aria-hidden="true" tabindex="-1"></a>p_abund_p1<span class="ot">=</span><span class="fu">grid.arrange</span>(A1_abun,B1_abun,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 1"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb35-2821"><a href="#cb35-2821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2822"><a href="#cb35-2822" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb35-2823"><a href="#cb35-2823" aria-hidden="true" tabindex="-1"></a>p_abund_p2<span class="ot">=</span><span class="fu">grid.arrange</span>(A2_abun,B2_abun,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">top=</span><span class="fu">textGrob</span>(<span class="st">"Plot 2"</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>)))</span>
<span id="cb35-2824"><a href="#cb35-2824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2825"><a href="#cb35-2825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2826"><a href="#cb35-2826" aria-hidden="true" tabindex="-1"></a><span class="fu"># 8. Differentially abundant taxa</span></span>
<span id="cb35-2827"><a href="#cb35-2827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2828"><a href="#cb35-2828" aria-hidden="true" tabindex="-1"></a>It is interesting to decipher which taxa show statistically significant differences between two groups of samples (i.e., differences in the abundance between mother and suckers plants). For that purpose, we will apply <span class="co">[</span><span class="ot">ANCOM-BC approach</span><span class="co">](https://www.nature.com/articles/s41467-020-17041-7 "ANCOM-BC describing paper")</span>, especially designed for compositional data. Furthermore, we will use the function *ancomloop* of the package *micro4all* in order to compare all groups of samples among them (ANCOM-BC just compares the first group of samples in the dataset with all other groups)</span>
<span id="cb35-2829"><a href="#cb35-2829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2830"><a href="#cb35-2830" aria-hidden="true" tabindex="-1"></a>We will apply this statistical test at both phylum and genus levels.</span>
<span id="cb35-2831"><a href="#cb35-2831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2832"><a href="#cb35-2832" aria-hidden="true" tabindex="-1"></a>::: collout-important</span>
<span id="cb35-2833"><a href="#cb35-2833" aria-hidden="true" tabindex="-1"></a>ANCOM-BC makes a data transformation and applies logarithms, so in this case, we shouldn't use the normalized abundance. We should use raw phyloseq objects (in which the ASV counts is expressed in absolute abundance)</span>
<span id="cb35-2834"><a href="#cb35-2834" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-2835"><a href="#cb35-2835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2836"><a href="#cb35-2836" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8.1 Phylum</span></span>
<span id="cb35-2837"><a href="#cb35-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2840"><a href="#cb35-2840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2841"><a href="#cb35-2841" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-2842"><a href="#cb35-2842" aria-hidden="true" tabindex="-1"></a>ANCOM_phylum_rizo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> rizo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>,</span>
<span id="cb35-2843"><a href="#cb35-2843" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Phylum"</span>)</span>
<span id="cb35-2844"><a href="#cb35-2844" aria-hidden="true" tabindex="-1"></a><span class="do">###options:</span></span>
<span id="cb35-2845"><a href="#cb35-2845" aria-hidden="true" tabindex="-1"></a><span class="co">#grouping: indicate your grouping variable</span></span>
<span id="cb35-2846"><a href="#cb35-2846" aria-hidden="true" tabindex="-1"></a><span class="co">#n_cl: the number of cores</span></span>
<span id="cb35-2847"><a href="#cb35-2847" aria-hidden="true" tabindex="-1"></a><span class="co">#global: apply the global test (for more information, read this paper: https://www.nature.com/articles/s41467-020-17041-7 and documentation of the function ancombc)</span></span>
<span id="cb35-2848"><a href="#cb35-2848" aria-hidden="true" tabindex="-1"></a><span class="co">#struc_zero: remove "structural zeros" (not real zeros but zeros resulting from a wrong sampling procedure)</span></span>
<span id="cb35-2849"><a href="#cb35-2849" aria-hidden="true" tabindex="-1"></a><span class="co">#out.unclassified: apply or not the test to unclassified taxa</span></span>
<span id="cb35-2850"><a href="#cb35-2850" aria-hidden="true" tabindex="-1"></a><span class="co">#tax.level: indicate the taxonomical level that you want to analyze</span></span>
<span id="cb35-2851"><a href="#cb35-2851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2852"><a href="#cb35-2852" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">1</span>]]),ANCOM_phylum_rizo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F) <span class="co">#save the first element of the list, which corresponds to the results obtained from the comparison of the first group of samples with the other groups</span></span>
<span id="cb35-2853"><a href="#cb35-2853" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">2</span>]]),ANCOM_phylum_rizo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2854"><a href="#cb35-2854" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">3</span>]]),ANCOM_phylum_rizo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2855"><a href="#cb35-2855" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">4</span>]]),ANCOM_phylum_rizo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2856"><a href="#cb35-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">5</span>]]),ANCOM_phylum_rizo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2857"><a href="#cb35-2857" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">6</span>]]),ANCOM_phylum_rizo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2858"><a href="#cb35-2858" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">7</span>]]),ANCOM_phylum_rizo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2859"><a href="#cb35-2859" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_rizo[[<span class="dv">8</span>]]),ANCOM_phylum_rizo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_Rizo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2860"><a href="#cb35-2860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2861"><a href="#cb35-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-2862"><a href="#cb35-2862" aria-hidden="true" tabindex="-1"></a>ANCOM_phylum_endo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> endo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb35-2863"><a href="#cb35-2863" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Phylum"</span>)</span>
<span id="cb35-2864"><a href="#cb35-2864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2865"><a href="#cb35-2865" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">1</span>]]),ANCOM_phylum_endo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2866"><a href="#cb35-2866" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">2</span>]]),ANCOM_phylum_endo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2867"><a href="#cb35-2867" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">3</span>]]),ANCOM_phylum_endo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2868"><a href="#cb35-2868" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">4</span>]]),ANCOM_phylum_endo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2869"><a href="#cb35-2869" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">5</span>]]),ANCOM_phylum_endo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2870"><a href="#cb35-2870" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">6</span>]]),ANCOM_phylum_endo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2871"><a href="#cb35-2871" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">7</span>]]),ANCOM_phylum_endo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2872"><a href="#cb35-2872" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_phylum_endo[[<span class="dv">8</span>]]),ANCOM_phylum_endo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Phylum_endo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2873"><a href="#cb35-2873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2874"><a href="#cb35-2874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2875"><a href="#cb35-2875" aria-hidden="true" tabindex="-1"></a>In this work, we analyzed exhaustively the results in Excel. Pay attention to the column entitled "diff_abbn", which shows the phyla that were differentially abundant.</span>
<span id="cb35-2876"><a href="#cb35-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2877"><a href="#cb35-2877" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8.2 Genus</span></span>
<span id="cb35-2878"><a href="#cb35-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2881"><a href="#cb35-2881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2882"><a href="#cb35-2882" aria-hidden="true" tabindex="-1"></a><span class="co">#a) RHIZOSPHERE</span></span>
<span id="cb35-2883"><a href="#cb35-2883" aria-hidden="true" tabindex="-1"></a>ANCOM_genus_rizo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> rizo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb35-2884"><a href="#cb35-2884" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Genus"</span>)</span>
<span id="cb35-2885"><a href="#cb35-2885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2886"><a href="#cb35-2886" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">1</span>]]),ANCOM_genus_rizo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2887"><a href="#cb35-2887" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">2</span>]]),ANCOM_genus_rizo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2888"><a href="#cb35-2888" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">3</span>]]),ANCOM_genus_rizo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2889"><a href="#cb35-2889" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">4</span>]]),ANCOM_genus_rizo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2890"><a href="#cb35-2890" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">5</span>]]),ANCOM_genus_rizo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2891"><a href="#cb35-2891" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">6</span>]]),ANCOM_genus_rizo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2892"><a href="#cb35-2892" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">7</span>]]),ANCOM_genus_rizo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2893"><a href="#cb35-2893" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_rizo[[<span class="dv">8</span>]]),ANCOM_genus_rizo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Rizo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2894"><a href="#cb35-2894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2895"><a href="#cb35-2895" aria-hidden="true" tabindex="-1"></a><span class="co">#b) ENDOSPHERE</span></span>
<span id="cb35-2896"><a href="#cb35-2896" aria-hidden="true" tabindex="-1"></a>endo<span class="ot">=</span><span class="fu">subset_samples</span>(phy_total, Compartment<span class="sc">==</span><span class="st">"Endosphere"</span>)</span>
<span id="cb35-2897"><a href="#cb35-2897" aria-hidden="true" tabindex="-1"></a>endo<span class="ot">=</span><span class="fu">prune_taxa</span>(<span class="fu">taxa_sums</span>(endo)<span class="sc">&gt;</span><span class="fl">0.0</span>, endo)</span>
<span id="cb35-2898"><a href="#cb35-2898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2899"><a href="#cb35-2899" aria-hidden="true" tabindex="-1"></a>ANCOM_genus_endo<span class="ot">=</span><span class="fu">ancomloop</span>(<span class="at">input_object_phyloseq =</span> endo, <span class="at">grouping =</span> <span class="st">"Fusion"</span>, </span>
<span id="cb35-2900"><a href="#cb35-2900" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ancom.options =</span> <span class="fu">list</span>(<span class="at">global=</span><span class="cn">FALSE</span>, <span class="at">struc_zero=</span><span class="cn">TRUE</span>, <span class="at">n_cl=</span><span class="dv">8</span>),<span class="at">out.unclassified =</span> <span class="cn">TRUE</span>, <span class="at">tax.level=</span><span class="st">"Genus"</span>)</span>
<span id="cb35-2901"><a href="#cb35-2901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2902"><a href="#cb35-2902" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">1</span>]]),ANCOM_genus_endo[[<span class="dv">1</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2903"><a href="#cb35-2903" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">2</span>]]),ANCOM_genus_endo[[<span class="dv">2</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2904"><a href="#cb35-2904" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">3</span>]]),ANCOM_genus_endo[[<span class="dv">3</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2905"><a href="#cb35-2905" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">4</span>]]),ANCOM_genus_endo[[<span class="dv">4</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2022_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2906"><a href="#cb35-2906" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">5</span>]]),ANCOM_genus_endo[[<span class="dv">5</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot1_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2907"><a href="#cb35-2907" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">6</span>]]),ANCOM_genus_endo[[<span class="dv">6</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot1_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2908"><a href="#cb35-2908" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">7</span>]]),ANCOM_genus_endo[[<span class="dv">7</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot2_I.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2909"><a href="#cb35-2909" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">"_"</span><span class="ot">=</span><span class="fu">rownames</span>(ANCOM_genus_endo[[<span class="dv">8</span>]]),ANCOM_genus_endo[[<span class="dv">8</span>]]),<span class="at">file=</span><span class="st">"ANCOM_Genus_Endo_2023_Plot2_M.txt"</span>,<span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb35-2910"><a href="#cb35-2910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-2911"><a href="#cb35-2911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2912"><a href="#cb35-2912" aria-hidden="true" tabindex="-1"></a>In this work, we analyzed exhaustively the results in Excel. Pay attention to the column entitled "diff_abbn", which shows the genera that were differentially abundant.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>